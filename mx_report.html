<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Triple Crown MX - 2024 Report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="mx_report_files/libs/clipboard/clipboard.min.js"></script>
<script src="mx_report_files/libs/quarto-html/quarto.js"></script>
<script src="mx_report_files/libs/quarto-html/popper.min.js"></script>
<script src="mx_report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="mx_report_files/libs/quarto-html/anchor.min.js"></script>
<link href="mx_report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="mx_report_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="mx_report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="mx_report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="mx_report_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#abstract" id="toc-abstract" class="nav-link active" data-scroll-target="#abstract">1 Abstract</a></li>
  <li><a href="#background-information" id="toc-background-information" class="nav-link" data-scroll-target="#background-information">2 Background information</a></li>
  <li><a href="#data-scraping-and-tidying" id="toc-data-scraping-and-tidying" class="nav-link" data-scroll-target="#data-scraping-and-tidying">3 Data scraping and tidying</a></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis">4 Analysis</a>
  <ul class="collapse">
  <li><a href="#demographic-summary" id="toc-demographic-summary" class="nav-link" data-scroll-target="#demographic-summary">4.1 Demographic summary</a></li>
  <li><a href="#transition-matrices" id="toc-transition-matrices" class="nav-link" data-scroll-target="#transition-matrices">4.2 Transition matrices</a></li>
  <li><a href="#rider-fatique" id="toc-rider-fatique" class="nav-link" data-scroll-target="#rider-fatique">4.3 Rider fatique</a></li>
  <li><a href="#rider-rivalries" id="toc-rider-rivalries" class="nav-link" data-scroll-target="#rider-rivalries">4.4 Rider rivalries</a></li>
  <li><a href="#points-race" id="toc-points-race" class="nav-link" data-scroll-target="#points-race">4.5 Points race</a></li>
  <li><a href="#rider-profiles" id="toc-rider-profiles" class="nav-link" data-scroll-target="#rider-profiles">4.6 Rider profiles</a></li>
  </ul></li>
  <li><a href="#extensions" id="toc-extensions" class="nav-link" data-scroll-target="#extensions">5 Extensions</a></li>
  <li><a href="#notes" id="toc-notes" class="nav-link" data-scroll-target="#notes">6 Notes</a></li>
  <li><a href="#acknowledgements" id="toc-acknowledgements" class="nav-link" data-scroll-target="#acknowledgements">7 Acknowledgements</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Triple Crown MX - 2024 Report</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="abstract" class="level1">
<h1>1 Abstract</h1>
<p>The Triple Crown Series is Canada’s premiere off-road motorcycle racing series. Data including the places and lap times of riders are freely available online, provided by <a href="https://www.tracksidesoftware.com/">Trackside</a>. However, there exists no published exploration or analysis on the series. This report aims to take these first steps.</p>
</section>
<section id="background-information" class="level1">
<h1>2 Background information</h1>
<p>The Triple Crown Series is named in reference to the three main events in the sport of off-road motorcycle racing. There is motocross (outdoors, usually featuring longer courses), supercross (usually compact, shorter courses), and arenacross (supercross but restricted to an arena or stadium). Riders take part in rounds of these three types of races throughout the year, accumulating points in attempt to win the championship. In 2024, only motocross events took place.</p>
<p>There are three main classes for the Triple Crown Series. There is one class for women, WMX. There are two classes for the men, 250 Pro/Am and 450 Pro. The 250 class of riders are a mixture of amateur and professional riders, racing 250cc dirt bikes. The 450 class of riders are professional riders, racing 450cc dirt bikes.</p>
</section>
<section id="data-scraping-and-tidying" class="level1">
<h1>3 Data scraping and tidying</h1>
<p>Importing relevant packages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># data cleaning</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest) <span class="co"># data scraping</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr) <span class="co"># string operations</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># date/time operations</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt) <span class="co"># tables</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co"># visuals</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(expm) <span class="co"># matrix operations</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate) <span class="co"># visual animations</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gifski) <span class="co"># visual animations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Importing rider information spreadsheet:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>riders <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"/Users/hudsonholman/Documents/Projects/Triple Crown Motocross/racer_info.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(riders)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 252
Columns: 6
$ number   &lt;chr&gt; "15", "23", "808", "109", "84", "18", "1", "17", "377", "8", …
$ name     &lt;chr&gt; "Jess Pettis", "Josiah Natzke", "Preston Kilroy", "Aaron Tant…
$ class    &lt;chr&gt; "450", "450", "450", "450", "450", "450", "450", "450", "450"…
$ year     &lt;int&gt; 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2…
$ state    &lt;chr&gt; "Quebec", "New Zealand", "Wyoming", "Quebec", "Ontario", "Bri…
$ manufact &lt;chr&gt; "KTM", "KTM", "Yamaha", "Kawasaki", "Kawasaki", "KTM", "Honda…</code></pre>
</div>
</div>
<p>The individual moto results table does not display any information about points scored. The following is a self-created tibble that will eventually get added. This will allow for analysis about points scored throughout a season.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>points <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">finish =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>, </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">points =</span> <span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">22</span>,<span class="dv">20</span>,<span class="dv">18</span>,<span class="dv">16</span>,<span class="dv">15</span>,<span class="dv">14</span>,<span class="dv">13</span>,<span class="dv">12</span>,<span class="dv">11</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">10</span>,<span class="dv">9</span>,<span class="dv">8</span>,<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>points <span class="sc">|&gt;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">20</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">finish =</span> <span class="st">"Finish"</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">points =</span> <span class="st">"Points"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="esxjebttcs" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#esxjebttcs table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#esxjebttcs thead, #esxjebttcs tbody, #esxjebttcs tfoot, #esxjebttcs tr, #esxjebttcs td, #esxjebttcs th {
  border-style: none;
}

#esxjebttcs p {
  margin: 0;
  padding: 0;
}

#esxjebttcs .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#esxjebttcs .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#esxjebttcs .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#esxjebttcs .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#esxjebttcs .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#esxjebttcs .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#esxjebttcs .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#esxjebttcs .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#esxjebttcs .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#esxjebttcs .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#esxjebttcs .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#esxjebttcs .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#esxjebttcs .gt_spanner_row {
  border-bottom-style: hidden;
}

#esxjebttcs .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#esxjebttcs .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#esxjebttcs .gt_from_md > :first-child {
  margin-top: 0;
}

#esxjebttcs .gt_from_md > :last-child {
  margin-bottom: 0;
}

#esxjebttcs .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#esxjebttcs .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#esxjebttcs .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#esxjebttcs .gt_row_group_first td {
  border-top-width: 2px;
}

#esxjebttcs .gt_row_group_first th {
  border-top-width: 2px;
}

#esxjebttcs .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#esxjebttcs .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#esxjebttcs .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#esxjebttcs .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#esxjebttcs .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#esxjebttcs .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#esxjebttcs .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#esxjebttcs .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#esxjebttcs .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#esxjebttcs .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#esxjebttcs .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#esxjebttcs .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#esxjebttcs .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#esxjebttcs .gt_left {
  text-align: left;
}

#esxjebttcs .gt_center {
  text-align: center;
}

#esxjebttcs .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#esxjebttcs .gt_font_normal {
  font-weight: normal;
}

#esxjebttcs .gt_font_bold {
  font-weight: bold;
}

#esxjebttcs .gt_font_italic {
  font-style: italic;
}

#esxjebttcs .gt_super {
  font-size: 65%;
}

#esxjebttcs .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#esxjebttcs .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#esxjebttcs .gt_indent_1 {
  text-indent: 5px;
}

#esxjebttcs .gt_indent_2 {
  text-indent: 10px;
}

#esxjebttcs .gt_indent_3 {
  text-indent: 15px;
}

#esxjebttcs .gt_indent_4 {
  text-indent: 20px;
}

#esxjebttcs .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Finish">Finish</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Points">Points</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="finish" class="gt_row gt_right">1</td>
<td headers="points" class="gt_row gt_right">25</td></tr>
    <tr><td headers="finish" class="gt_row gt_right">2</td>
<td headers="points" class="gt_row gt_right">22</td></tr>
    <tr><td headers="finish" class="gt_row gt_right">3</td>
<td headers="points" class="gt_row gt_right">20</td></tr>
    <tr><td headers="finish" class="gt_row gt_right">4</td>
<td headers="points" class="gt_row gt_right">18</td></tr>
    <tr><td headers="finish" class="gt_row gt_right">5</td>
<td headers="points" class="gt_row gt_right">16</td></tr>
    <tr><td headers="finish" class="gt_row gt_right">6</td>
<td headers="points" class="gt_row gt_right">15</td></tr>
    <tr><td headers="finish" class="gt_row gt_right">7</td>
<td headers="points" class="gt_row gt_right">14</td></tr>
    <tr><td headers="finish" class="gt_row gt_right">8</td>
<td headers="points" class="gt_row gt_right">13</td></tr>
    <tr><td headers="finish" class="gt_row gt_right">9</td>
<td headers="points" class="gt_row gt_right">12</td></tr>
    <tr><td headers="finish" class="gt_row gt_right">10</td>
<td headers="points" class="gt_row gt_right">11</td></tr>
    <tr><td headers="finish" class="gt_row gt_right">11</td>
<td headers="points" class="gt_row gt_right">10</td></tr>
    <tr><td headers="finish" class="gt_row gt_right">12</td>
<td headers="points" class="gt_row gt_right">9</td></tr>
    <tr><td headers="finish" class="gt_row gt_right">13</td>
<td headers="points" class="gt_row gt_right">8</td></tr>
    <tr><td headers="finish" class="gt_row gt_right">14</td>
<td headers="points" class="gt_row gt_right">7</td></tr>
    <tr><td headers="finish" class="gt_row gt_right">15</td>
<td headers="points" class="gt_row gt_right">6</td></tr>
    <tr><td headers="finish" class="gt_row gt_right">16</td>
<td headers="points" class="gt_row gt_right">5</td></tr>
    <tr><td headers="finish" class="gt_row gt_right">17</td>
<td headers="points" class="gt_row gt_right">4</td></tr>
    <tr><td headers="finish" class="gt_row gt_right">18</td>
<td headers="points" class="gt_row gt_right">3</td></tr>
    <tr><td headers="finish" class="gt_row gt_right">19</td>
<td headers="points" class="gt_row gt_right">2</td></tr>
    <tr><td headers="finish" class="gt_row gt_right">20</td>
<td headers="points" class="gt_row gt_right">1</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>There are some functions that were created to allow for easier analysis.</p>
<ol type="1">
<li>Convert the lap times (string) to seconds (numeric). For example, a lap time of 1:13.21 gets converted to 73.021.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>convert_to_seconds <span class="ot">&lt;-</span> <span class="cf">function</span>(time_string) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if the input is a valid string and not empty</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(time_string) <span class="sc">|</span> time_string <span class="sc">==</span> <span class="st">""</span>) {</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If the time_string has a colon</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">":"</span>, time_string)) {</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract minutes and seconds</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    mins <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(time_string, <span class="dv">1</span>, <span class="fu">regexpr</span>(<span class="st">":"</span>, time_string) <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    secs <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(time_string, <span class="fu">regexpr</span>(<span class="st">":"</span>, time_string) <span class="sc">+</span> <span class="dv">1</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">nchar</span>(time_string)))</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(mins <span class="sc">*</span> <span class="dv">60</span> <span class="sc">+</span> secs)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If the time_string does not have a colon</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Direct conversion for seconds</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    numeric_val <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(time_string)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(numeric_val)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Once the data from a moto has been scraped, the data needs to be organized in such a way that allows for analysis. This involves tidying the data for each individual rider of each moto so that each column contains a variable and each row contains an observation. Eventually, they are get merged for a particular moto.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>clean_table <span class="ot">&lt;-</span> <span class="cf">function</span>(tib, num) {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Cleaning the lap times</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> tib <span class="sc">|&gt;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(number <span class="sc">==</span> num)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> temp <span class="sc">|&gt;</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"time"</span>), </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_to =</span> <span class="st">"lap"</span>, </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_to =</span> <span class="st">"time"</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">lap =</span> <span class="fu">parse_number</span>(lap))</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  temp_times <span class="ot">&lt;-</span> temp <span class="sc">|&gt;</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(place, number, lap, time) <span class="sc">|&gt;</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">finish =</span> place)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Cleaning the behind times</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> tib <span class="sc">|&gt;</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(number <span class="sc">==</span> num)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> temp <span class="sc">|&gt;</span> </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"behind"</span>), </span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_to =</span> <span class="st">"lap"</span>, </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_to =</span> <span class="st">"behind"</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">lap =</span> <span class="fu">parse_number</span>(lap))</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  temp_behind <span class="ot">&lt;-</span> temp <span class="sc">|&gt;</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(lap, behind)</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Cleaning the lap places</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> tib <span class="sc">|&gt;</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(number <span class="sc">==</span> num)</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> temp <span class="sc">|&gt;</span> </span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"place"</span>), </span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_to =</span> <span class="st">"lap"</span>, </span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_to =</span> <span class="st">"place"</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">lap =</span> <span class="fu">parse_number</span>(lap))</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>  temp_place <span class="ot">&lt;-</span> temp <span class="sc">|&gt;</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(lap, place) <span class="sc">|&gt;</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(lap))</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join all lap times, behind times, and lap places into one table</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>  temp_final <span class="ot">&lt;-</span> temp_times <span class="sc">|&gt;</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(temp_behind)</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>  temp_final <span class="ot">&lt;-</span> temp_final <span class="sc">|&gt;</span></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(temp_place)</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(temp_final)</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we have everything we need to create the scraping function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mx_scraping <span class="ot">&lt;-</span> <span class="cf">function</span>(url, racers, laps, year, round, </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                        moto, track, date, raceid, class) {</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  webpage <span class="ot">&lt;-</span> url</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read in the table from Trackside website</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  webpage <span class="ot">&lt;-</span> <span class="fu">read_html</span>(webpage)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  lap_times <span class="ot">&lt;-</span> webpage <span class="sc">|&gt;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_node</span>(<span class="st">"table"</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_table</span>(<span class="at">fill =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>()</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Selecting appropriate rows and columns</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  lap_times_reduced <span class="ot">&lt;-</span> lap_times <span class="sc">|&gt;</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">16</span><span class="sc">:</span>(<span class="dv">16</span><span class="sc">+</span>racers<span class="dv">-1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">num_range</span>(<span class="st">"X"</span>, <span class="dv">1</span><span class="sc">:</span>(laps<span class="sc">+</span><span class="dv">1</span>)))</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  lap <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"L"</span>, <span class="dv">1</span><span class="sc">:</span>laps)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  lap2 <span class="ot">&lt;-</span> <span class="fu">append</span>(<span class="st">"name"</span>, lap)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  lap_times_reduced <span class="ot">&lt;-</span> lap_times_reduced <span class="sc">|&gt;</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">setNames</span>(lap2)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Data cleaning</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  lap_times_reduced <span class="ot">&lt;-</span> lap_times_reduced <span class="sc">|&gt;</span> </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">separate_wider_delim</span>(</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>      name,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">delim =</span> <span class="st">" - "</span>,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"place"</span>, <span class="st">"name"</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extracting the rider number and addressing special cases denoted in the notes section</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  lap_times_reduced <span class="ot">&lt;-</span> lap_times_reduced <span class="sc">|&gt;</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">number =</span> <span class="fu">str_extract</span>(name, <span class="st">"#</span><span class="sc">\\</span><span class="st">d+[a-zA-Z]?$"</span>),</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">number =</span> <span class="fu">str_remove</span>(number, <span class="st">"#"</span>),</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">number =</span> <span class="fu">if_else</span>(number <span class="sc">==</span> <span class="st">"715"</span> <span class="sc">&amp;</span> class <span class="sc">==</span> <span class="st">"450"</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>                            <span class="sc">&amp;</span> year <span class="sc">==</span> <span class="dv">2024</span> <span class="sc">&amp;</span> round <span class="sc">==</span> <span class="dv">6</span>,</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"815"</span>, number),</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">number =</span> <span class="fu">if_else</span>(number <span class="sc">==</span> <span class="st">"120"</span> <span class="sc">&amp;</span> class <span class="sc">==</span> <span class="st">"250"</span> </span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>                            <span class="sc">&amp;</span> year <span class="sc">==</span> <span class="dv">2024</span> <span class="sc">&amp;</span> round <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">7</span>),</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"220"</span>, number),</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">number =</span> <span class="fu">if_else</span>(number <span class="sc">==</span> <span class="st">"120X"</span> <span class="sc">&amp;</span> class <span class="sc">==</span> <span class="st">"250"</span> </span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>                            <span class="sc">&amp;</span> year <span class="sc">==</span> <span class="dv">2024</span> <span class="sc">&amp;</span> round <span class="sc">==</span> <span class="dv">8</span>,</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"220"</span>, number),</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">number =</span> <span class="fu">if_else</span>(number <span class="sc">==</span> <span class="st">"120"</span> <span class="sc">&amp;</span> class <span class="sc">==</span> <span class="st">"250"</span> </span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>                            <span class="sc">&amp;</span> year <span class="sc">==</span> <span class="dv">2024</span> <span class="sc">&amp;</span> round <span class="sc">==</span> <span class="dv">6</span> </span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>                            <span class="sc">&amp;</span> <span class="fu">str_detect</span>(name, <span class="st">"TREMBLAY"</span>), </span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"220"</span>, number),</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>           <span class="at">number =</span> <span class="fu">if_else</span>(number <span class="sc">==</span> <span class="st">"120X"</span> <span class="sc">&amp;</span> class <span class="sc">==</span> <span class="st">"250"</span> </span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>                            <span class="sc">&amp;</span> year <span class="sc">==</span> <span class="dv">2024</span> <span class="sc">&amp;</span> round <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>),</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"120"</span>, number),</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>           <span class="at">number =</span> <span class="fu">if_else</span>(number <span class="sc">==</span> <span class="st">"87"</span> <span class="sc">&amp;</span> class <span class="sc">==</span> <span class="st">"250"</span> </span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>                            <span class="sc">&amp;</span> year <span class="sc">==</span> <span class="dv">2024</span> <span class="sc">&amp;</span> round <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>),</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"287"</span>, number),</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>           <span class="at">number =</span> <span class="fu">if_else</span>(number <span class="sc">==</span> <span class="st">"312g"</span> <span class="sc">&amp;</span> class <span class="sc">==</span> <span class="st">"250"</span> </span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>                            <span class="sc">&amp;</span> year <span class="sc">==</span> <span class="dv">2024</span>,</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"312"</span>, number),</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">number =</span> <span class="fu">if_else</span>(number <span class="sc">==</span> <span class="st">"53"</span> <span class="sc">&amp;</span> class <span class="sc">==</span> <span class="st">"250"</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>                            <span class="sc">&amp;</span> year <span class="sc">==</span> <span class="dv">2024</span> <span class="sc">&amp;</span> round <span class="sc">==</span> <span class="dv">3</span>,</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"153"</span>, number),</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>           <span class="at">number =</span> <span class="fu">if_else</span>(number <span class="sc">==</span> <span class="st">"98"</span> <span class="sc">&amp;</span> class <span class="sc">==</span> <span class="st">"WMX"</span> </span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>                            <span class="sc">&amp;</span> year <span class="sc">==</span> <span class="dv">2024</span> <span class="sc">&amp;</span> round <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">7</span>),</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"9"</span>, number),</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>           <span class="at">number =</span> <span class="fu">if_else</span>(number <span class="sc">==</span> <span class="st">"98x"</span> <span class="sc">&amp;</span> class <span class="sc">==</span> <span class="st">"WMX"</span> </span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>                            <span class="sc">&amp;</span> year <span class="sc">==</span> <span class="dv">2024</span> <span class="sc">&amp;</span> round <span class="sc">==</span> <span class="dv">7</span>,</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"98"</span>, number),</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>           <span class="at">number =</span> <span class="fu">if_else</span>(number <span class="sc">==</span> <span class="st">"1e"</span> <span class="sc">&amp;</span> class <span class="sc">==</span> <span class="st">"WMX"</span> </span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>                            <span class="sc">&amp;</span> year <span class="sc">==</span> <span class="dv">2024</span>,</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"469"</span>, number),</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>           <span class="at">number =</span> <span class="fu">ifelse</span>(number <span class="sc">==</span> <span class="st">"14"</span> <span class="sc">&amp;</span> class <span class="sc">==</span> <span class="st">"WMX"</span></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>                           <span class="sc">&amp;</span> year <span class="sc">==</span> <span class="dv">2024</span> <span class="sc">&amp;</span> round <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"114"</span>, number),</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>           <span class="at">place =</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(lap_times_reduced))) <span class="sc">|&gt;</span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>name)</span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Placing the lap time, behind time, and lap time in their own columns</span></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>  lap_times_reduced2 <span class="ot">&lt;-</span> lap_times_reduced</span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (col <span class="cf">in</span> lap) {</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>    lap_times_reduced2 <span class="ot">&lt;-</span> lap_times_reduced2 <span class="sc">|&gt;</span></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>      <span class="fu">separate_wider_delim</span>(</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>        col,</span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">delim =</span> <span class="st">"</span><span class="sc">\r\n\t\t\t\t\t</span><span class="st">"</span>,</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">names =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(col, <span class="st">"_time"</span>), <span class="fu">paste0</span>(col, <span class="st">"_behind"</span>), </span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste0</span>(col, <span class="st">"_place"</span>)),</span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">too_few =</span> <span class="st">"align_start"</span></span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Converting lap places to numeric</span></span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>  lap3 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"L"</span>, <span class="dv">1</span><span class="sc">:</span>laps, <span class="st">"_place"</span>)</span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>  lap_times_reduced2 <span class="ot">&lt;-</span> lap_times_reduced2 <span class="sc">|&gt;</span></span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(lap3, <span class="sc">~</span> <span class="fu">str_extract</span>(.x, <span class="st">"</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">.?</span><span class="sc">\\</span><span class="st">d*"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">as.numeric</span>(), <span class="at">.names =</span> <span class="st">"{col}"</span>))</span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Converting lap times and behind times from strings to numeric seconds</span></span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>  lap4 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"L"</span>, <span class="dv">1</span><span class="sc">:</span>laps, <span class="st">"_time"</span>)</span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>  lap5 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"L"</span>, <span class="dv">1</span><span class="sc">:</span>laps, <span class="st">"_behind"</span>)</span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>  final_lap_times <span class="ot">&lt;-</span> lap_times_reduced2</span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> lap4) {</span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>    final_lap_times <span class="ot">&lt;-</span> final_lap_times <span class="sc">|&gt;</span> </span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(i) <span class="sc">:</span><span class="er">=</span> <span class="fu">str_trim</span>(<span class="sc">!!</span><span class="fu">sym</span>(i)),</span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>             <span class="sc">!!</span><span class="fu">sym</span>(i) <span class="sc">:</span><span class="er">=</span> <span class="fu">sapply</span>(<span class="sc">!!</span><span class="fu">sym</span>(i), convert_to_seconds))</span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> lap5) {</span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>    final_lap_times <span class="ot">&lt;-</span> final_lap_times <span class="sc">|&gt;</span> </span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(i) <span class="sc">:</span><span class="er">=</span> <span class="fu">str_trim</span>(<span class="sc">!!</span><span class="fu">sym</span>(i)),</span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>             <span class="sc">!!</span><span class="fu">sym</span>(i) <span class="sc">:</span><span class="er">=</span> <span class="fu">sapply</span>(<span class="sc">!!</span><span class="fu">sym</span>(i), convert_to_seconds))</span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create initial tibble</span></span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a>  round_moto <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">finish =</span> <span class="fu">numeric</span>(),</span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">number =</span> <span class="fu">character</span>(),</span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">lap =</span> <span class="fu">numeric</span>(),</span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> <span class="fu">numeric</span>(),</span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">behind =</span> <span class="fu">numeric</span>(),</span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">place =</span> <span class="fu">numeric</span>()</span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bind individual rider tibbles together</span></span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> final_lap_times<span class="sc">$</span>number) {</span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>    adding <span class="ot">&lt;-</span> <span class="fu">clean_table</span>(final_lap_times, i)</span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a>    round_moto <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(round_moto, adding)</span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a>  round_moto <span class="ot">&lt;-</span> round_moto <span class="sc">|&gt;</span></span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">year =</span> year,</span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a>           <span class="at">round =</span> round,</span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a>           <span class="at">moto =</span> moto,</span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a>           <span class="at">track =</span> track,</span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a>           <span class="at">date =</span> <span class="fu">parse_date</span>(date, <span class="st">"%m/%d/%Y"</span>),</span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a>           <span class="at">race_id =</span> raceid,</span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a>           <span class="at">class =</span> class)</span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join in the rider and points information</span></span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a>  round_moto <span class="ot">&lt;-</span> round_moto <span class="sc">|&gt;</span></span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(riders) <span class="sc">|&gt;</span></span>
<span id="cb7-132"><a href="#cb7-132" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(points)</span>
<span id="cb7-133"><a href="#cb7-133" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-134"><a href="#cb7-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(round_moto)</span>
<span id="cb7-135"><a href="#cb7-135" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>From here, we can apply this function for every moto of each class.</p>
<p>450 class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>rd11_2024_450 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=33&amp;e=14641&amp;rn=1&amp;rt=M"</span>, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">30</span>, <span class="dv">17</span>, <span class="dv">2024</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="st">"Wild Rose MX"</span>, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"06/02/2024"</span>, <span class="st">"450_2024_11"</span>, <span class="st">"450"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>rd12_2024_450 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=33&amp;e=14641&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">30</span>, <span class="dv">16</span>, <span class="dv">2024</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="st">"Wild Rose MX"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"06/02/2024"</span>, <span class="st">"450_2024_12"</span>, <span class="st">"450"</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>rd21_2024_450 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=33&amp;e=14683&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">30</span>, <span class="dv">16</span>, <span class="dv">2024</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="st">"Lethbridge MX"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"06/09/2024"</span>, <span class="st">"450_2024_21"</span>, <span class="st">"450"</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>rd22_2024_450 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=33&amp;e=14683&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">28</span>, <span class="dv">7</span>, <span class="dv">2024</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="st">"Lethbridge MX"</span>,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"06/09/2024"</span>, <span class="st">"450_2024_22"</span>, <span class="st">"450"</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>rd31_2024_450 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=33&amp;e=14767&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">30</span>, <span class="dv">17</span>, <span class="dv">2024</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="st">"Prairie Hill MX"</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"06/16/2024"</span>, <span class="st">"450_2024_31"</span>, <span class="st">"450"</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>rd32_2024_450 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=33&amp;e=14767&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">29</span>, <span class="dv">17</span>, <span class="dv">2024</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="st">"Prairie Hill MX"</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"06/16/2024"</span>, <span class="st">"450_2024_32"</span>, <span class="st">"450"</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>rd41_2024_450 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=33&amp;e=14774&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">29</span>, <span class="dv">18</span>, <span class="dv">2024</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="st">"Gopher Dunes"</span>,</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/07/2024"</span>, <span class="st">"450_2024_41"</span>, <span class="st">"450"</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>rd42_2024_450 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=33&amp;e=14774&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">26</span>, <span class="dv">18</span>, <span class="dv">2024</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="st">"Gopher Dunes"</span>,</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/07/2024"</span>, <span class="st">"450_2024_42"</span>, <span class="st">"450"</span>)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>rd51_2024_450 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=33&amp;e=14781&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">30</span>, <span class="dv">17</span>, <span class="dv">2024</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="st">"Sand Del Lee MX101"</span>,</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/14/2024"</span>, <span class="st">"450_2024_51"</span>, <span class="st">"450"</span>)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>rd52_2024_450 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=33&amp;e=14781&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">27</span>, <span class="dv">17</span>, <span class="dv">2024</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="st">"Sand Del Lee MX101"</span>,</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/14/2024"</span>, <span class="st">"450_2024_52"</span>, <span class="st">"450"</span>)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>rd61_2024_450 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=33&amp;e=14788&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">28</span>, <span class="dv">16</span>, <span class="dv">2024</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="st">"Riverglade MX"</span>,</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/19/2024"</span>, <span class="st">"450_2024_61"</span>, <span class="st">"450"</span>)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>rd62_2024_450 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=33&amp;e=14788&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">27</span>, <span class="dv">16</span>, <span class="dv">2024</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="st">"Riverglade MX"</span>,</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/19/2024"</span>, <span class="st">"450_2024_62"</span>, <span class="st">"450"</span>)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>rd71_2024_450 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=33&amp;e=14795&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">30</span>, <span class="dv">15</span>, <span class="dv">2024</span>, <span class="dv">7</span>, <span class="dv">1</span>, <span class="st">"MX Deschambault"</span>,</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/26/2024"</span>, <span class="st">"450_2024_71"</span>, <span class="st">"450"</span>)</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>rd72_2024_450 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=33&amp;e=14795&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">29</span>, <span class="dv">15</span>, <span class="dv">2024</span>, <span class="dv">7</span>, <span class="dv">2</span>, <span class="st">"MX Deschambault"</span>,</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/26/2024"</span>, <span class="st">"450_2024_72"</span>, <span class="st">"450"</span>)</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>rd81_2024_450 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=33&amp;e=14802&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">30</span>, <span class="dv">18</span>, <span class="dv">2024</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="st">"Walton Raceway"</span>,</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"08/09/2024"</span>, <span class="st">"450_2024_81"</span>, <span class="st">"450"</span>)</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>rd82_2024_450 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=33&amp;e=14802&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">29</span>, <span class="dv">17</span>, <span class="dv">2024</span>, <span class="dv">8</span>, <span class="dv">2</span>, <span class="st">"Walton Raceway"</span>,</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"08/09/2024"</span>, <span class="st">"450_2024_82"</span>, <span class="st">"450"</span>)</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>all_2024_450 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(rd11_2024_450, rd12_2024_450,</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>                          rd21_2024_450, rd22_2024_450,</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>                          rd31_2024_450, rd32_2024_450,</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>                          rd41_2024_450, rd42_2024_450,</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>                          rd51_2024_450, rd52_2024_450,</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>                          rd61_2024_450, rd62_2024_450,</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>                          rd71_2024_450, rd72_2024_450,</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>                          rd81_2024_450, rd82_2024_450)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>250 class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>rd11_2024_250 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=32&amp;e=14641&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">40</span>, <span class="dv">13</span>, <span class="dv">2024</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="st">"Wild Rose MX"</span>, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"06/02/2024"</span>, <span class="st">"250_2024_11"</span>, <span class="st">"250"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>rd12_2024_250 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=32&amp;e=14641&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">38</span>, <span class="dv">14</span>, <span class="dv">2024</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="st">"Wild Rose MX"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"06/02/2024"</span>, <span class="st">"250_2024_12"</span>, <span class="st">"250"</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>rd21_2024_250 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=32&amp;e=14683&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">39</span>, <span class="dv">13</span>, <span class="dv">2024</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="st">"Lethbridge MX"</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"06/09/2024"</span>, <span class="st">"250_2024_21"</span>, <span class="st">"250"</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>rd22_2024_250 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=32&amp;e=14683&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">36</span>, <span class="dv">13</span>, <span class="dv">2024</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="st">"Lethbridge MX"</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"06/09/2024"</span>, <span class="st">"250_2024_22"</span>, <span class="st">"250"</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>rd31_2024_250 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=32&amp;e=14767&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">38</span>, <span class="dv">14</span>, <span class="dv">2024</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="st">"Prairie Hill MX"</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"06/16/2024"</span>, <span class="st">"250_2024_31"</span>, <span class="st">"250"</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>rd32_2024_250 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=32&amp;e=14767&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">37</span>, <span class="dv">14</span>, <span class="dv">2024</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="st">"Prairie Hill MX"</span>,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"06/16/2024"</span>, <span class="st">"250_2024_32"</span>, <span class="st">"250"</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>rd41_2024_250 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=32&amp;e=14774&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">40</span>, <span class="dv">16</span>, <span class="dv">2024</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="st">"Gopher Dunes"</span>,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/07/2024"</span>, <span class="st">"250_2024_41"</span>, <span class="st">"250"</span>)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>rd42_2024_250 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=32&amp;e=14774&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">40</span>, <span class="dv">16</span>, <span class="dv">2024</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="st">"Gopher Dunes"</span>,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/07/2024"</span>, <span class="st">"250_2024_42"</span>, <span class="st">"250"</span>)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>rd51_2024_250 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=32&amp;e=14781&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">40</span>, <span class="dv">14</span>, <span class="dv">2024</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="st">"Sand Del Lee MX101"</span>,</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/14/2024"</span>, <span class="st">"250_2024_51"</span>, <span class="st">"250"</span>)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>rd52_2024_250 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=32&amp;e=14781&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">38</span>, <span class="dv">15</span>, <span class="dv">2024</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="st">"Sand Del Lee MX101"</span>,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/14/2024"</span>, <span class="st">"250_2024_52"</span>, <span class="st">"250"</span>)</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>rd61_2024_250 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=32&amp;e=14788&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">40</span>, <span class="dv">14</span>, <span class="dv">2024</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="st">"Riverglade MX"</span>,</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/19/2024"</span>, <span class="st">"250_2024_61"</span>, <span class="st">"250"</span>)</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>rd62_2024_250 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=32&amp;e=14788&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">38</span>, <span class="dv">14</span>, <span class="dv">2024</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="st">"Riverglade MX"</span>,</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/19/2024"</span>, <span class="st">"250_2024_62"</span>, <span class="st">"250"</span>)</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>rd71_2024_250 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=32&amp;e=14795&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">40</span>, <span class="dv">13</span>, <span class="dv">2024</span>, <span class="dv">7</span>, <span class="dv">1</span>, <span class="st">"MX Deschambault"</span>,</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/26/2024"</span>, <span class="st">"250_2024_71"</span>, <span class="st">"250"</span>)</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>rd72_2024_250 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=32&amp;e=14795&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">37</span>, <span class="dv">13</span>, <span class="dv">2024</span>, <span class="dv">7</span>, <span class="dv">2</span>, <span class="st">"MX Deschambault"</span>,</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/26/2024"</span>, <span class="st">"250_2024_72"</span>, <span class="st">"250"</span>)</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>rd81_2024_250 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=32&amp;e=14802&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">39</span>, <span class="dv">15</span>, <span class="dv">2024</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="st">"Walton Raceway"</span>,</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"08/09/2024"</span>, <span class="st">"250_2024_81"</span>, <span class="st">"250"</span>)</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>rd82_2024_250 <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=32&amp;e=14802&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">39</span>, <span class="dv">15</span>, <span class="dv">2024</span>, <span class="dv">8</span>, <span class="dv">2</span>, <span class="st">"Walton Raceway"</span>,</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"08/09/2024"</span>, <span class="st">"250_2024_82"</span>, <span class="st">"250"</span>)</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>all_2024_250 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(rd11_2024_250, rd12_2024_250,</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>                          rd21_2024_250, rd22_2024_250,</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>                          rd31_2024_250, rd32_2024_250,</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>                          rd41_2024_250, rd42_2024_250,</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>                          rd51_2024_250, rd52_2024_250,</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>                          rd61_2024_250, rd62_2024_250,</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>                          rd71_2024_250, rd72_2024_250,</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>                          rd81_2024_250, rd82_2024_250)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>WMX class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>rd11_2024_wmx <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=54&amp;e=14641&amp;rn=1&amp;rt=M"</span>, </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">22</span>, <span class="dv">7</span>, <span class="dv">2024</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="st">"Wild Rose MX"</span>, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"06/02/2024"</span>, <span class="st">"wmx_2024_11"</span>, <span class="st">"WMX"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>rd12_2024_wmx <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=54&amp;e=14641&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">22</span>, <span class="dv">7</span>, <span class="dv">2024</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="st">"Wild Rose MX"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"06/02/2024"</span>, <span class="st">"wmx_2024_12"</span>, <span class="st">"WMX"</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>rd21_2024_wmx <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=54&amp;e=14683&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">14</span>, <span class="dv">7</span>, <span class="dv">2024</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="st">"Lethbridge MX"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"06/09/2024"</span>, <span class="st">"wmx_2024_21"</span>, <span class="st">"WMX"</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>rd22_2024_wmx <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=54&amp;e=14683&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">14</span>, <span class="dv">7</span>, <span class="dv">2024</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="st">"Lethbridge MX"</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"06/09/2024"</span>, <span class="st">"wmx_2024_22"</span>, <span class="st">"WMX"</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>rd31_2024_wmx <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=54&amp;e=14767&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">14</span>, <span class="dv">5</span>, <span class="dv">2024</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="st">"Prairie Hill MX"</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"06/16/2024"</span>, <span class="st">"wmx_2024_31"</span>, <span class="st">"WMX"</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>rd32_2024_wmx <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=54&amp;e=14767&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">14</span>, <span class="dv">5</span>, <span class="dv">2024</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="st">"Prairie Hill MX"</span>,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"06/16/2024"</span>, <span class="st">"wmx_2024_32"</span>, <span class="st">"WMX"</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Source for Gopher Dunes results - https://cmrc.tracksideresults.com/class.asp?c=58&amp;e=14774</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>rd4_2024_wmx <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">finish =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">21</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">21</span>),</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>                       <span class="at">number =</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"469"</span>,<span class="st">"3w"</span>,<span class="st">"14"</span>,<span class="st">"8"</span>,<span class="st">"7W"</span>,<span class="st">"94"</span>,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"22X"</span>,<span class="st">"6E"</span>,<span class="st">"92"</span>,<span class="st">"110"</span>,<span class="st">"159"</span>,<span class="st">"122"</span>,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"609"</span>, <span class="st">"75"</span>,<span class="st">"440"</span>,<span class="st">"10"</span>, <span class="st">"425"</span>,<span class="st">"121"</span>,</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"9"</span>, <span class="st">"22"</span>, <span class="st">"1"</span>,<span class="st">"469"</span>,<span class="st">"3w"</span>,<span class="st">"14"</span>,<span class="st">"8"</span>,</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"7W"</span>,<span class="st">"22X"</span>,<span class="st">"94"</span>,<span class="st">"6E"</span>,<span class="st">"10"</span>,<span class="st">"92"</span>,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"122"</span>,<span class="st">"609"</span>, <span class="st">"440"</span>,<span class="st">"75"</span>,<span class="st">"121"</span>,<span class="st">"425"</span>,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"9"</span>,<span class="st">"22"</span>,<span class="st">"110"</span>,<span class="st">"159"</span>),</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>                       <span class="at">lap =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">42</span>),</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>                       <span class="at">time =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">42</span>),</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>                       <span class="at">behind =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">42</span>),</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>                       <span class="at">place =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">21</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">21</span>),</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>                       <span class="at">year =</span> <span class="fu">rep</span>(<span class="dv">2024</span>, <span class="dv">42</span>),</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>                       <span class="at">round =</span> <span class="fu">rep</span>(<span class="dv">4</span>, <span class="dv">42</span>),</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>                       <span class="at">moto =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">42</span>),</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>                       <span class="at">track =</span> <span class="fu">rep</span>(<span class="st">"Gopher Dunes"</span>, <span class="dv">42</span>),</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>                       <span class="at">date =</span> <span class="fu">rep</span>(<span class="st">"07/07/2024"</span>, <span class="dv">42</span>),</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>                       <span class="at">race_id =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"wmx_2024_41"</span>, <span class="dv">21</span>), <span class="fu">rep</span>(<span class="st">"wmx_2024_42"</span>, <span class="dv">21</span>)),</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>                       <span class="at">class =</span> <span class="fu">rep</span>(<span class="st">"WMX"</span>, <span class="dv">42</span>))</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>rd4_2024_wmx <span class="ot">&lt;-</span> rd4_2024_wmx <span class="sc">|&gt;</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">parse_date</span>(date, <span class="st">"%m/%d/%Y"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(riders) <span class="sc">|&gt;</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(points)</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>rd51_2024_wmx <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=58&amp;e=14781&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">25</span>, <span class="dv">7</span>, <span class="dv">2024</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="st">"Sand Del Lee MX101"</span>,</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/14/2024"</span>, <span class="st">"wmx_2024_51"</span>, <span class="st">"WMX"</span>)</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>rd52_2024_wmx <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=58&amp;e=14781&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">24</span>, <span class="dv">7</span>, <span class="dv">2024</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="st">"Sand Del Lee MX101"</span>,</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/14/2024"</span>, <span class="st">"wmx_2024_52"</span>, <span class="st">"WMX"</span>)</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>rd61_2024_wmx <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=58&amp;e=14788&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">15</span>, <span class="dv">7</span>, <span class="dv">2024</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="st">"Riverglade MX"</span>,</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/19/2024"</span>, <span class="st">"wmx_2024_61"</span>, <span class="st">"WMX"</span>)</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>rd62_2024_wmx <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=58&amp;e=14788&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">15</span>, <span class="dv">7</span>, <span class="dv">2024</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="st">"Riverglade MX"</span>,</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/19/2024"</span>, <span class="st">"wmx_2024_62"</span>, <span class="st">"WMX"</span>)</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>rd71_2024_wmx <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=58&amp;e=14795&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">30</span>, <span class="dv">6</span>, <span class="dv">2024</span>, <span class="dv">7</span>, <span class="dv">1</span>, <span class="st">"MX Deschambault"</span>,</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/26/2024"</span>, <span class="st">"wmx_2024_71"</span>, <span class="st">"WMX"</span>)</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>rd72_2024_wmx <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=58&amp;e=14795&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">29</span>, <span class="dv">6</span>, <span class="dv">2024</span>, <span class="dv">7</span>, <span class="dv">2</span>, <span class="st">"MX Deschambault"</span>,</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"07/26/2024"</span>, <span class="st">"wmx_2024_72"</span>, <span class="st">"WMX"</span>)</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>rd81_2024_wmx <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=83&amp;e=14802&amp;rn=1&amp;rt=M"</span>,</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">17</span>, <span class="dv">8</span>, <span class="dv">2024</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="st">"Walton Raceway"</span>,</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"08/09/2024"</span>, <span class="st">"wmx_2024_81"</span>, <span class="st">"WMX"</span>)</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>rd82_2024_wmx <span class="ot">&lt;-</span> <span class="fu">mx_scraping</span>(<span class="st">"https://cmrc.tracksideresults.com/laptimes.asp?s=&amp;c=83&amp;e=14802&amp;rn=2&amp;rt=M"</span>,</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">16</span>, <span class="dv">8</span>, <span class="dv">2024</span>, <span class="dv">8</span>, <span class="dv">2</span>, <span class="st">"Walton Raceway"</span>,</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"08/09/2024"</span>, <span class="st">"wmx_2024_82"</span>, <span class="st">"WMX"</span>)</span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>all_2024_wmx <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(rd11_2024_wmx, rd12_2024_wmx,</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>                          rd21_2024_wmx, rd22_2024_wmx,</span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>                          rd31_2024_wmx, rd32_2024_wmx,</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>                          rd4_2024_wmx,</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a>                          rd51_2024_wmx, rd52_2024_wmx,</span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>                          rd61_2024_wmx, rd62_2024_wmx,</span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>                          rd71_2024_wmx, rd72_2024_wmx,</span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>                          rd81_2024_wmx, rd82_2024_wmx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Merge all three classes and then writing to a csv to save.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>all_2024 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(all_2024_450, all_2024_250, all_2024_wmx)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(all_2024,<span class="st">"/Users/hudsonholman/Documents/Projects/Triple Crown Motocross/all_2024.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Make sure that there are no numbers with missing rider information (this should be empty).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>all_2024 <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(name)) <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(number)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 1
# ℹ 1 variable: number &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="analysis" class="level1">
<h1>4 Analysis</h1>
<section id="demographic-summary" class="level2">
<h2 class="anchored" data-anchor-id="demographic-summary">4.1 Demographic summary</h2>
<p>Initializing bike manufacturer colours:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>all_2024 <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(manufact)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>colours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Gas Gas"</span> <span class="ot">=</span> <span class="st">"#a92519"</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Honda"</span> <span class="ot">=</span> <span class="st">"#ca2d25"</span>, </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Husqvarna"</span> <span class="ot">=</span> <span class="st">"#081d53"</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Kawasaki"</span> <span class="ot">=</span> <span class="st">"#78ef49"</span>, </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">"KTM"</span> <span class="ot">=</span> <span class="st">"#e66d2c"</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Suzuki"</span> <span class="ot">=</span> <span class="st">"#11308e"</span>, </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Yamaha"</span> <span class="ot">=</span> <span class="st">"#2a4d98"</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Triumph"</span> <span class="ot">=</span> <span class="st">"#f7f751"</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>             <span class="co">#"Yamaha/Gas Gas" = "#54406E",</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>             <span class="co">#"Yamaha/Triumph" = "#B3B567"</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>             )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>all_2024 <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(class, name, manufact) <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(class, manufact) <span class="sc">|&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count =</span> <span class="fu">if_else</span>(manufact <span class="sc">==</span> <span class="st">"Yamaha"</span> <span class="sc">&amp;</span> class <span class="sc">==</span><span class="st">"250"</span>, count <span class="sc">+</span> <span class="fl">0.5</span>, count),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">count =</span> <span class="fu">if_else</span>(manufact <span class="sc">==</span> <span class="st">"Gas Gas"</span> <span class="sc">&amp;</span> class <span class="sc">==</span><span class="st">"250"</span>, count <span class="sc">+</span> <span class="fl">0.5</span>, count),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">count =</span> <span class="fu">if_else</span>(manufact <span class="sc">==</span> <span class="st">"Yamaha"</span> <span class="sc">&amp;</span> class <span class="sc">==</span><span class="st">"WMX"</span>, count <span class="sc">+</span> <span class="fl">0.5</span>, count)) <span class="sc">|&gt;</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">class =</span> <span class="st">"WMX"</span>, <span class="at">manufact =</span> <span class="st">"Triumph"</span>, <span class="at">count =</span> <span class="fl">0.5</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span> manufact <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Yamaha/Gas Gas"</span>, <span class="st">"Yamaha/Triumph"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> manufact, <span class="at">y =</span> count, <span class="at">fill =</span> manufact)) <span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>class) <span class="sc">+</span> </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> colours, <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of bike manufacturers"</span>, </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"By class"</span>, </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Manufacturer"</span>,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Riders"</span>) <span class="sc">+</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note: Christopher Blackmer of the 250 class split time between Yamaha and Gas Gas. Brooke Johnson of the WMX class split time between Yamaha and Triumph. Each rider will contribute 0.5 to each manufacturer’s count.</p>
<p>Distributions of home provinces/states:</p>
<p>450 class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>all_2024 <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"450"</span>) <span class="sc">|&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(name, state) <span class="sc">|&gt;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state) <span class="sc">|&gt;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">state =</span> <span class="st">"Province/State"</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">n =</span> <span class="st">"Number of Riders"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="saajhwnvki" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#saajhwnvki table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#saajhwnvki thead, #saajhwnvki tbody, #saajhwnvki tfoot, #saajhwnvki tr, #saajhwnvki td, #saajhwnvki th {
  border-style: none;
}

#saajhwnvki p {
  margin: 0;
  padding: 0;
}

#saajhwnvki .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#saajhwnvki .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#saajhwnvki .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#saajhwnvki .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#saajhwnvki .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#saajhwnvki .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#saajhwnvki .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#saajhwnvki .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#saajhwnvki .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#saajhwnvki .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#saajhwnvki .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#saajhwnvki .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#saajhwnvki .gt_spanner_row {
  border-bottom-style: hidden;
}

#saajhwnvki .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#saajhwnvki .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#saajhwnvki .gt_from_md > :first-child {
  margin-top: 0;
}

#saajhwnvki .gt_from_md > :last-child {
  margin-bottom: 0;
}

#saajhwnvki .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#saajhwnvki .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#saajhwnvki .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#saajhwnvki .gt_row_group_first td {
  border-top-width: 2px;
}

#saajhwnvki .gt_row_group_first th {
  border-top-width: 2px;
}

#saajhwnvki .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#saajhwnvki .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#saajhwnvki .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#saajhwnvki .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#saajhwnvki .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#saajhwnvki .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#saajhwnvki .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#saajhwnvki .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#saajhwnvki .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#saajhwnvki .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#saajhwnvki .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#saajhwnvki .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#saajhwnvki .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#saajhwnvki .gt_left {
  text-align: left;
}

#saajhwnvki .gt_center {
  text-align: center;
}

#saajhwnvki .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#saajhwnvki .gt_font_normal {
  font-weight: normal;
}

#saajhwnvki .gt_font_bold {
  font-weight: bold;
}

#saajhwnvki .gt_font_italic {
  font-style: italic;
}

#saajhwnvki .gt_super {
  font-size: 65%;
}

#saajhwnvki .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#saajhwnvki .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#saajhwnvki .gt_indent_1 {
  text-indent: 5px;
}

#saajhwnvki .gt_indent_2 {
  text-indent: 10px;
}

#saajhwnvki .gt_indent_3 {
  text-indent: 15px;
}

#saajhwnvki .gt_indent_4 {
  text-indent: 20px;
}

#saajhwnvki .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Province/State">Province/State</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Number of Riders">Number of Riders</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="state" class="gt_row gt_left">Ontario</td>
<td headers="n" class="gt_row gt_right">12</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Quebec</td>
<td headers="n" class="gt_row gt_right">10</td></tr>
    <tr><td headers="state" class="gt_row gt_left">British Columbia</td>
<td headers="n" class="gt_row gt_right">9</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Alberta</td>
<td headers="n" class="gt_row gt_right">6</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Michigan</td>
<td headers="n" class="gt_row gt_right">4</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Washington</td>
<td headers="n" class="gt_row gt_right">4</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Connecticut</td>
<td headers="n" class="gt_row gt_right">3</td></tr>
    <tr><td headers="state" class="gt_row gt_left">New York</td>
<td headers="n" class="gt_row gt_right">3</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Nova Scotia</td>
<td headers="n" class="gt_row gt_right">3</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Wisconsin</td>
<td headers="n" class="gt_row gt_right">3</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Florida</td>
<td headers="n" class="gt_row gt_right">2</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Georgia</td>
<td headers="n" class="gt_row gt_right">2</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Manitoba</td>
<td headers="n" class="gt_row gt_right">2</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Massachusetts</td>
<td headers="n" class="gt_row gt_right">2</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Nevada</td>
<td headers="n" class="gt_row gt_right">2</td></tr>
    <tr><td headers="state" class="gt_row gt_left">New Brunswick</td>
<td headers="n" class="gt_row gt_right">2</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Pennsylvania</td>
<td headers="n" class="gt_row gt_right">2</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Wyoming</td>
<td headers="n" class="gt_row gt_right">2</td></tr>
    <tr><td headers="state" class="gt_row gt_left">California</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Denmark</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">France</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Illinois</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Iowa</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">New Zealand</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">North Dakota</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Saskatchewan</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Texas</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Utah</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>250 class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>all_2024 <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"250"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(name, state) <span class="sc">|&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state) <span class="sc">|&gt;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">state =</span> <span class="st">"Province/State"</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">n =</span> <span class="st">"Number of Riders"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="nbxnbkjljt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#nbxnbkjljt table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#nbxnbkjljt thead, #nbxnbkjljt tbody, #nbxnbkjljt tfoot, #nbxnbkjljt tr, #nbxnbkjljt td, #nbxnbkjljt th {
  border-style: none;
}

#nbxnbkjljt p {
  margin: 0;
  padding: 0;
}

#nbxnbkjljt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nbxnbkjljt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#nbxnbkjljt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nbxnbkjljt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nbxnbkjljt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nbxnbkjljt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nbxnbkjljt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nbxnbkjljt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nbxnbkjljt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nbxnbkjljt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nbxnbkjljt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nbxnbkjljt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nbxnbkjljt .gt_spanner_row {
  border-bottom-style: hidden;
}

#nbxnbkjljt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#nbxnbkjljt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nbxnbkjljt .gt_from_md > :first-child {
  margin-top: 0;
}

#nbxnbkjljt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nbxnbkjljt .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nbxnbkjljt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#nbxnbkjljt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nbxnbkjljt .gt_row_group_first td {
  border-top-width: 2px;
}

#nbxnbkjljt .gt_row_group_first th {
  border-top-width: 2px;
}

#nbxnbkjljt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nbxnbkjljt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nbxnbkjljt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nbxnbkjljt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nbxnbkjljt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nbxnbkjljt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nbxnbkjljt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#nbxnbkjljt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nbxnbkjljt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nbxnbkjljt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nbxnbkjljt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nbxnbkjljt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nbxnbkjljt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nbxnbkjljt .gt_left {
  text-align: left;
}

#nbxnbkjljt .gt_center {
  text-align: center;
}

#nbxnbkjljt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nbxnbkjljt .gt_font_normal {
  font-weight: normal;
}

#nbxnbkjljt .gt_font_bold {
  font-weight: bold;
}

#nbxnbkjljt .gt_font_italic {
  font-style: italic;
}

#nbxnbkjljt .gt_super {
  font-size: 65%;
}

#nbxnbkjljt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#nbxnbkjljt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nbxnbkjljt .gt_indent_1 {
  text-indent: 5px;
}

#nbxnbkjljt .gt_indent_2 {
  text-indent: 10px;
}

#nbxnbkjljt .gt_indent_3 {
  text-indent: 15px;
}

#nbxnbkjljt .gt_indent_4 {
  text-indent: 20px;
}

#nbxnbkjljt .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Province/State">Province/State</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Number of Riders">Number of Riders</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="state" class="gt_row gt_left">Ontario</td>
<td headers="n" class="gt_row gt_right">20</td></tr>
    <tr><td headers="state" class="gt_row gt_left">British Columbia</td>
<td headers="n" class="gt_row gt_right">13</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Quebec</td>
<td headers="n" class="gt_row gt_right">10</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Alberta</td>
<td headers="n" class="gt_row gt_right">8</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Manitoba</td>
<td headers="n" class="gt_row gt_right">8</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Washington</td>
<td headers="n" class="gt_row gt_right">5</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Saskatchewan</td>
<td headers="n" class="gt_row gt_right">4</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Connecticut</td>
<td headers="n" class="gt_row gt_right">3</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Pennsylvania</td>
<td headers="n" class="gt_row gt_right">3</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Wisconsin</td>
<td headers="n" class="gt_row gt_right">3</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Florida</td>
<td headers="n" class="gt_row gt_right">2</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Illinois</td>
<td headers="n" class="gt_row gt_right">2</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Massachusetts</td>
<td headers="n" class="gt_row gt_right">2</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Michigan</td>
<td headers="n" class="gt_row gt_right">2</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Nova Scotia</td>
<td headers="n" class="gt_row gt_right">2</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Australia</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">California</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Georgia</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Idaho</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Iowa</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Minnesota</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">New Brunswick</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">New Hampshire</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">New Mexico</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">New York</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">North Carolina</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">South Carolina</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Tennessee</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">United Kingdom</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>WMX class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>all_2024 <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"WMX"</span>) <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(name, state) <span class="sc">|&gt;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state) <span class="sc">|&gt;</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">state =</span> <span class="st">"Province/State"</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">n =</span> <span class="st">"Number of Riders"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="xzrzuopapc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xzrzuopapc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xzrzuopapc thead, #xzrzuopapc tbody, #xzrzuopapc tfoot, #xzrzuopapc tr, #xzrzuopapc td, #xzrzuopapc th {
  border-style: none;
}

#xzrzuopapc p {
  margin: 0;
  padding: 0;
}

#xzrzuopapc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xzrzuopapc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xzrzuopapc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xzrzuopapc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xzrzuopapc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xzrzuopapc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xzrzuopapc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xzrzuopapc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xzrzuopapc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xzrzuopapc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xzrzuopapc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xzrzuopapc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xzrzuopapc .gt_spanner_row {
  border-bottom-style: hidden;
}

#xzrzuopapc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xzrzuopapc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xzrzuopapc .gt_from_md > :first-child {
  margin-top: 0;
}

#xzrzuopapc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xzrzuopapc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xzrzuopapc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xzrzuopapc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xzrzuopapc .gt_row_group_first td {
  border-top-width: 2px;
}

#xzrzuopapc .gt_row_group_first th {
  border-top-width: 2px;
}

#xzrzuopapc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xzrzuopapc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xzrzuopapc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xzrzuopapc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xzrzuopapc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xzrzuopapc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xzrzuopapc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xzrzuopapc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xzrzuopapc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xzrzuopapc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xzrzuopapc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xzrzuopapc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xzrzuopapc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xzrzuopapc .gt_left {
  text-align: left;
}

#xzrzuopapc .gt_center {
  text-align: center;
}

#xzrzuopapc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xzrzuopapc .gt_font_normal {
  font-weight: normal;
}

#xzrzuopapc .gt_font_bold {
  font-weight: bold;
}

#xzrzuopapc .gt_font_italic {
  font-style: italic;
}

#xzrzuopapc .gt_super {
  font-size: 65%;
}

#xzrzuopapc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xzrzuopapc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xzrzuopapc .gt_indent_1 {
  text-indent: 5px;
}

#xzrzuopapc .gt_indent_2 {
  text-indent: 10px;
}

#xzrzuopapc .gt_indent_3 {
  text-indent: 15px;
}

#xzrzuopapc .gt_indent_4 {
  text-indent: 20px;
}

#xzrzuopapc .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Province/State">Province/State</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Number of Riders">Number of Riders</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="state" class="gt_row gt_left">Ontario</td>
<td headers="n" class="gt_row gt_right">14</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Quebec</td>
<td headers="n" class="gt_row gt_right">13</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Alberta</td>
<td headers="n" class="gt_row gt_right">8</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Manitoba</td>
<td headers="n" class="gt_row gt_right">7</td></tr>
    <tr><td headers="state" class="gt_row gt_left">British Columbia</td>
<td headers="n" class="gt_row gt_right">4</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Nova Scotia</td>
<td headers="n" class="gt_row gt_right">4</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Saskatchewan</td>
<td headers="n" class="gt_row gt_right">3</td></tr>
    <tr><td headers="state" class="gt_row gt_left">unknown</td>
<td headers="n" class="gt_row gt_right">3</td></tr>
    <tr><td headers="state" class="gt_row gt_left">California</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Connecticut</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Idaho</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Massachusetts</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Michigan</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">New Brunswick</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">North Carolina</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Pennsylvania</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="state" class="gt_row gt_left">Wisconsin</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="transition-matrices" class="level2">
<h2 class="anchored" data-anchor-id="transition-matrices">4.2 Transition matrices</h2>
<p><strong>Q1</strong>: What is the likelihood to go from one position to any other position on any given lap?</p>
<p>Let’s start with the 450 class.</p>
<p>Formatting the empirical data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>all_2024_450_add <span class="ot">&lt;-</span> all_2024 <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"450"</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(place) <span class="sc">|&gt;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race_id_name =</span> <span class="fu">paste</span>(race_id, name, <span class="at">sep =</span> <span class="st">"_"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">place_next =</span> <span class="fu">lead</span>(place, <span class="at">n =</span> 1L,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">order_by =</span> race_id_name)) <span class="sc">|&gt;</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race_id_name) <span class="sc">|&gt;</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">place_next =</span> <span class="fu">c</span>(place_next[<span class="sc">-</span><span class="fu">n</span>()], <span class="cn">NA</span>)) <span class="sc">|&gt;</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">place_next =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(place_next), finish, place_next))</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>all_2024_450_place_summary <span class="ot">&lt;-</span> all_2024_450_add <span class="sc">|&gt;</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place, place_next) <span class="sc">|&gt;</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place, place_next) <span class="sc">|&gt;</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>all_2024_450_place_summary_2 <span class="ot">&lt;-</span> all_2024_450_place_summary <span class="sc">|&gt;</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place) <span class="sc">|&gt;</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>all_2024_450_place_summary_3 <span class="ot">&lt;-</span> all_2024_450_place_summary <span class="sc">|&gt;</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(all_2024_450_place_summary_2) <span class="sc">|&gt;</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span>total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Creating the transition matrix:</p>
<ol type="1">
<li>Individual place positions - We have a 30 x 30 matrix since 450 motos in 2024 included a maximum of 30 riders.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">=</span> <span class="dv">30</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">=</span> <span class="dv">30</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>cats <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>matrix450_1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> rows, <span class="at">ncol =</span> cols)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rows) {</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>cols) {</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    matrix_row <span class="ot">&lt;-</span> all_2024_450_place_summary_3 <span class="sc">|&gt;</span> </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(place <span class="sc">==</span> i <span class="sc">&amp;</span> place_next <span class="sc">==</span> j)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(matrix_row) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> all_2024_450_place_summary_3 <span class="sc">|&gt;</span> </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(place <span class="sc">==</span> i <span class="sc">&amp;</span> place_next <span class="sc">==</span> j) <span class="sc">|&gt;</span> <span class="fu">pull</span>(prob)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    matrix450_1[i, j] <span class="ot">&lt;-</span> matrix_value</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(matrix450_1) <span class="ot">&lt;-</span> cats</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(matrix450_1) <span class="ot">&lt;-</span> cats</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(matrix450_1, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      1    2    3    4    5    6    7    8    9   10   11   12   13   14   15
1  0.95 0.03 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
2  0.04 0.91 0.04 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
3  0.00 0.05 0.85 0.07 0.01 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
4  0.00 0.01 0.11 0.79 0.06 0.02 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
5  0.00 0.00 0.00 0.12 0.78 0.05 0.01 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00
6  0.00 0.00 0.00 0.01 0.11 0.78 0.06 0.02 0.01 0.00 0.00 0.00 0.00 0.00 0.00
7  0.00 0.00 0.00 0.01 0.02 0.08 0.79 0.07 0.01 0.00 0.00 0.00 0.00 0.00 0.01
8  0.00 0.00 0.00 0.00 0.00 0.04 0.09 0.76 0.08 0.01 0.00 0.00 0.00 0.00 0.00
9  0.00 0.00 0.00 0.00 0.00 0.00 0.03 0.11 0.74 0.08 0.02 0.02 0.00 0.00 0.00
10 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.11 0.78 0.06 0.02 0.01 0.00 0.00
11 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.03 0.09 0.72 0.09 0.02 0.01 0.01
12 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.02 0.16 0.69 0.09 0.02 0.00
13 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.15 0.67 0.09 0.02
14 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.00 0.01 0.02 0.17 0.65 0.10
15 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.01 0.02 0.16 0.62
16 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.04 0.17
17 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.04
18 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.02
19 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01
20 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
21 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
22 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
23 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
24 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
25 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
26 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
27 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
28 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
29 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
30 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
     16   17   18   19   20   21   22   23   24   25   26   27   28   29   30
1  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
2  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
3  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
4  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
5  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
6  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
7  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
8  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
9  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
10 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
11 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
12 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
13 0.01 0.02 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
14 0.03 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
15 0.11 0.03 0.00 0.00 0.00 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
16 0.65 0.09 0.01 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.00 0.00 0.00
17 0.12 0.66 0.12 0.01 0.00 0.00 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
18 0.04 0.15 0.57 0.14 0.02 0.01 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.00
19 0.01 0.02 0.21 0.61 0.10 0.02 0.00 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00
20 0.00 0.00 0.05 0.18 0.60 0.10 0.02 0.01 0.00 0.00 0.01 0.00 0.00 0.00 0.00
21 0.01 0.00 0.01 0.03 0.19 0.59 0.09 0.03 0.02 0.00 0.00 0.00 0.00 0.01 0.00
22 0.00 0.00 0.01 0.01 0.06 0.17 0.58 0.10 0.03 0.01 0.02 0.00 0.00 0.00 0.00
23 0.00 0.00 0.00 0.01 0.01 0.06 0.21 0.56 0.08 0.01 0.01 0.01 0.02 0.00 0.00
24 0.00 0.00 0.00 0.00 0.01 0.02 0.03 0.22 0.55 0.10 0.04 0.03 0.00 0.00 0.00
25 0.00 0.00 0.00 0.00 0.00 0.00 0.02 0.03 0.20 0.63 0.07 0.03 0.00 0.02 0.00
26 0.00 0.00 0.00 0.00 0.00 0.00 0.02 0.03 0.05 0.19 0.60 0.07 0.03 0.01 0.01
27 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.01 0.04 0.04 0.18 0.57 0.12 0.03 0.01
28 0.00 0.01 0.00 0.00 0.00 0.01 0.00 0.01 0.02 0.01 0.09 0.22 0.58 0.06 0.01
29 0.00 0.00 0.00 0.00 0.00 0.02 0.01 0.00 0.00 0.01 0.03 0.09 0.20 0.60 0.03
30 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.03 0.00 0.11 0.17 0.69</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Grouped place positions - The 30 x 30 matrix can be overwhelming. So, let’s group the place positions and apply the same method. Here are the group we will use: 1-5, 6-10, 11-15, 16-20, 21-25, 26-30. This will require some reformatting of the empirical data.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>all_2024_450_place_summary_cat <span class="ot">&lt;-</span> all_2024_450_add <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place, place_next) <span class="sc">|&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">place_cat =</span> <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">"1-5"</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">10</span>, <span class="st">"6-10"</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">15</span>, <span class="st">"11-15"</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">20</span>, <span class="st">"16-20"</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">25</span>, </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"21-25"</span>,<span class="st">"26-30"</span>))))),</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">place_next_cat =</span> <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">"1-5"</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">10</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"6-10"</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">15</span>, </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"11-15"</span>,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">20</span>, </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"16-20"</span>,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">25</span>, </span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"21-25"</span>, <span class="st">"26-30"</span>)))))) <span class="sc">|&gt;</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place_cat, place_next_cat) <span class="sc">|&gt;</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place_cat, place_next_cat) <span class="sc">|&gt;</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>all_2024_450_place_summary_cat_2 <span class="ot">&lt;-</span> all_2024_450_place_summary_cat <span class="sc">|&gt;</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place_cat) <span class="sc">|&gt;</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>all_2024_450_place_summary_cat_3 <span class="ot">&lt;-</span> all_2024_450_place_summary_cat <span class="sc">|&gt;</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(all_2024_450_place_summary_cat_2) <span class="sc">|&gt;</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span>total)</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>rows2 <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>cols2 <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>cats2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-5"</span>, <span class="st">"6-10"</span>, <span class="st">"11-15"</span>, <span class="st">"16-20"</span>, <span class="st">"21-25"</span>, <span class="st">"26-30"</span>)</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>matrix450_2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> rows2, <span class="at">ncol =</span> cols2)</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rows2) {</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>cols2) {</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>    matrix_row <span class="ot">&lt;-</span> all_2024_450_place_summary_cat_3 <span class="sc">|&gt;</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(place_cat <span class="sc">==</span> cats2[i] <span class="sc">&amp;</span> place_next_cat <span class="sc">==</span> cats2[j])</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(matrix_row) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> all_2024_450_place_summary_cat_3 <span class="sc">|&gt;</span> </span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(place_cat <span class="sc">==</span> cats2[i] <span class="sc">&amp;</span> place_next_cat <span class="sc">==</span> cats2[j]) <span class="sc">|&gt;</span> <span class="fu">pull</span>(prob)</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>    matrix450_2[i, j] <span class="ot">&lt;-</span> matrix_value</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(matrix450_2) <span class="ot">&lt;-</span> cats2</span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(matrix450_2) <span class="ot">&lt;-</span> cats2</span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(matrix450_2, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1-5  6-10 11-15 16-20 21-25 26-30
1-5   0.970 0.026 0.002 0.001 0.000 0.002
6-10  0.031 0.938 0.028 0.002 0.002 0.001
11-15 0.000 0.037 0.905 0.049 0.006 0.004
16-20 0.000 0.000 0.065 0.876 0.045 0.013
21-25 0.000 0.000 0.001 0.076 0.869 0.054
26-30 0.000 0.000 0.000 0.002 0.134 0.865</code></pre>
</div>
</div>
<p>Let’s apply the same analysis to the 250 class. The only difference will be that 250 motos can include a maximum of 40 riders so the groups will be 1-5, 6-10, 11-15, 16-20, 21-25, 26-30, 31-35, 36-40.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>all_2024_250_add <span class="ot">&lt;-</span> all_2024 <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"250"</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(place) <span class="sc">|&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race_id_name =</span> <span class="fu">paste</span>(race_id, name, <span class="at">sep =</span> <span class="st">"_"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">place_next =</span> <span class="fu">lead</span>(place, <span class="at">n =</span> 1L,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">order_by =</span> race_id_name)) <span class="sc">|&gt;</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race_id_name) <span class="sc">|&gt;</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">place_next =</span> <span class="fu">c</span>(place_next[<span class="sc">-</span><span class="fu">n</span>()], <span class="cn">NA</span>)) <span class="sc">|&gt;</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">place_next =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(place_next), finish, place_next))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>all_2024_250_place_summary <span class="ot">&lt;-</span> all_2024_250_add <span class="sc">|&gt;</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place, place_next) <span class="sc">|&gt;</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place, place_next) <span class="sc">|&gt;</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>all_2024_250_place_summary_2 <span class="ot">&lt;-</span> all_2024_250_place_summary <span class="sc">|&gt;</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place) <span class="sc">|&gt;</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>all_2024_250_place_summary_3 <span class="ot">&lt;-</span> all_2024_250_place_summary <span class="sc">|&gt;</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(all_2024_250_place_summary_2) <span class="sc">|&gt;</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span>total)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>rows3 <span class="ot">=</span> <span class="dv">40</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>cols3 <span class="ot">=</span> <span class="dv">40</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>cats3 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">40</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>matrix250_1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> rows3, <span class="at">ncol =</span> cols3)</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rows3) {</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>cols3) {</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>    matrix_row <span class="ot">&lt;-</span> all_2024_250_place_summary_3 <span class="sc">|&gt;</span> </span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(place <span class="sc">==</span> i <span class="sc">&amp;</span> place_next <span class="sc">==</span> j)</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(matrix_row) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> all_2024_250_place_summary_3 <span class="sc">|&gt;</span> </span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(place <span class="sc">==</span> i <span class="sc">&amp;</span> place_next <span class="sc">==</span> j) <span class="sc">|&gt;</span> <span class="fu">pull</span>(prob)</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>    matrix250_1[i, j] <span class="ot">&lt;-</span> matrix_value</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(matrix250_1) <span class="ot">&lt;-</span> cats3</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(matrix250_1) <span class="ot">&lt;-</span> cats3</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(matrix250_1, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      1    2    3    4    5    6    7    8    9   10   11   12   13   14   15
1  0.96 0.03 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
2  0.04 0.89 0.04 0.01 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
3  0.00 0.06 0.88 0.04 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
4  0.00 0.01 0.07 0.80 0.07 0.02 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
5  0.00 0.00 0.01 0.13 0.72 0.09 0.04 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00
6  0.00 0.00 0.00 0.02 0.14 0.71 0.08 0.03 0.00 0.00 0.01 0.00 0.00 0.00 0.00
7  0.00 0.00 0.00 0.00 0.04 0.16 0.66 0.08 0.01 0.02 0.00 0.00 0.00 0.00 0.00
8  0.00 0.00 0.00 0.00 0.00 0.01 0.16 0.69 0.07 0.02 0.02 0.00 0.01 0.00 0.00
9  0.00 0.00 0.00 0.00 0.00 0.00 0.04 0.12 0.69 0.09 0.01 0.01 0.00 0.00 0.01
10 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.03 0.17 0.61 0.12 0.04 0.00 0.00 0.00
11 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.03 0.02 0.17 0.58 0.14 0.03 0.01 0.00
12 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.03 0.05 0.17 0.58 0.12 0.01 0.01
13 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.05 0.15 0.60 0.09 0.05
14 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.02 0.03 0.17 0.63 0.07
15 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.03 0.04 0.18 0.57
16 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.05 0.19
17 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.06
18 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.02
19 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
20 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
21 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
22 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
23 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
24 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
25 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
26 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
27 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
28 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
29 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
30 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
31 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.00
32 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
33 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
34 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
35 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
36 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
37 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
38 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
39 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
40 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
     16   17   18   19   20   21   22   23   24   25   26   27   28   29   30
1  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
2  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
3  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
4  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
5  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
6  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
7  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
8  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
9  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
10 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
11 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
12 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
13 0.01 0.02 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
14 0.01 0.01 0.00 0.00 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
15 0.12 0.03 0.01 0.01 0.00 0.00 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
16 0.55 0.13 0.03 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
17 0.23 0.56 0.09 0.00 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
18 0.02 0.20 0.58 0.10 0.03 0.00 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
19 0.02 0.03 0.19 0.57 0.09 0.03 0.00 0.02 0.00 0.00 0.00 0.00 0.00 0.01 0.00
20 0.01 0.01 0.06 0.19 0.56 0.12 0.01 0.01 0.00 0.01 0.00 0.00 0.00 0.00 0.00
21 0.00 0.00 0.00 0.08 0.15 0.57 0.11 0.03 0.01 0.00 0.00 0.00 0.00 0.00 0.00
22 0.01 0.00 0.00 0.02 0.09 0.16 0.52 0.11 0.02 0.01 0.02 0.00 0.00 0.00 0.01
23 0.00 0.00 0.01 0.00 0.02 0.08 0.17 0.48 0.13 0.02 0.02 0.01 0.00 0.00 0.00
24 0.00 0.00 0.00 0.01 0.01 0.01 0.10 0.21 0.45 0.12 0.00 0.02 0.01 0.00 0.01
25 0.00 0.00 0.00 0.00 0.00 0.00 0.03 0.07 0.24 0.47 0.10 0.02 0.02 0.00 0.01
26 0.00 0.00 0.00 0.00 0.00 0.01 0.01 0.02 0.07 0.22 0.51 0.08 0.02 0.01 0.02
27 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.02 0.10 0.16 0.51 0.09 0.04 0.01
28 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.00 0.02 0.13 0.15 0.50 0.08 0.03
29 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.02 0.00 0.02 0.10 0.16 0.48 0.12
30 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.05 0.13 0.20 0.41
31 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.01 0.01 0.01 0.01 0.02 0.11 0.22
32 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.00 0.00 0.00 0.00 0.01 0.03 0.02 0.10
33 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.00 0.00 0.01 0.00 0.01 0.03
34 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.01 0.02
35 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.00 0.01 0.01
36 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01
37 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.01 0.00 0.00
38 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.00 0.00 0.00
39 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.02 0.00
40 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
     31   32   33   34   35   36   37   38   39   40
1  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
2  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
3  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
4  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
5  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
6  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
7  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
8  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
9  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
10 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
11 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
12 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
13 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
14 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
15 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
16 0.00 0.00 0.00 0.00 0.00 0.01 0.00 0.00 0.00 0.00
17 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
18 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
19 0.00 0.00 0.00 0.00 0.01 0.00 0.00 0.00 0.00 0.00
20 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
21 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
22 0.00 0.00 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00
23 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
24 0.00 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.00
25 0.00 0.00 0.00 0.01 0.00 0.00 0.00 0.00 0.00 0.00
26 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
27 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
28 0.01 0.01 0.01 0.00 0.01 0.00 0.00 0.00 0.00 0.00
29 0.03 0.00 0.01 0.00 0.00 0.01 0.01 0.00 0.00 0.00
30 0.09 0.04 0.03 0.01 0.01 0.00 0.00 0.00 0.00 0.00
31 0.45 0.10 0.03 0.02 0.01 0.01 0.01 0.01 0.00 0.00
32 0.21 0.44 0.11 0.04 0.02 0.03 0.00 0.00 0.01 0.00
33 0.12 0.21 0.46 0.09 0.03 0.01 0.02 0.01 0.01 0.00
34 0.04 0.11 0.19 0.45 0.09 0.06 0.02 0.01 0.00 0.01
35 0.01 0.04 0.09 0.24 0.44 0.06 0.05 0.01 0.01 0.02
36 0.01 0.04 0.03 0.10 0.19 0.40 0.16 0.03 0.02 0.00
37 0.00 0.01 0.02 0.05 0.10 0.31 0.40 0.07 0.01 0.02
38 0.01 0.00 0.01 0.05 0.05 0.11 0.19 0.52 0.04 0.01
39 0.00 0.00 0.02 0.00 0.07 0.02 0.07 0.30 0.48 0.02
40 0.00 0.00 0.00 0.00 0.00 0.05 0.00 0.27 0.18 0.50</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>all_2024_250_place_summary_cat <span class="ot">&lt;-</span> all_2024_250_add <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place, place_next) <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">place_cat =</span> <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">"1-5"</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">10</span>, <span class="st">"6-10"</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">15</span>, <span class="st">"11-15"</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">20</span>, <span class="st">"16-20"</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">25</span>, <span class="st">"21-25"</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">26</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">30</span>, <span class="st">"26-30"</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">31</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">35</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"31-35"</span>, <span class="st">"36-40"</span>))))))),</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">place_next_cat =</span> <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">"1-5"</span>,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">10</span>, </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"6-10"</span>,</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">15</span>, </span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"11-15"</span>,</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">20</span>, </span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"16-20"</span>,</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">25</span>,</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"21-25"</span>,                                                           <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">26</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">30</span>,                                      <span class="st">"26-30"</span>,</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">31</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">35</span>, </span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"31-35"</span>,<span class="st">"36-40"</span>)))))))) <span class="sc">|&gt;</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place_cat, place_next_cat) <span class="sc">|&gt;</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place_cat, place_next_cat) <span class="sc">|&gt;</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>all_2024_250_place_summary_cat_2 <span class="ot">&lt;-</span> all_2024_250_place_summary_cat <span class="sc">|&gt;</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place_cat) <span class="sc">|&gt;</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>all_2024_250_place_summary_cat_3 <span class="ot">&lt;-</span> all_2024_250_place_summary_cat <span class="sc">|&gt;</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(all_2024_250_place_summary_cat_2) <span class="sc">|&gt;</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span>total)</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>rows4 <span class="ot">=</span> <span class="dv">8</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>cols4 <span class="ot">=</span> <span class="dv">8</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>cats4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-5"</span>, <span class="st">"6-10"</span>, <span class="st">"11-15"</span>, <span class="st">"16-20"</span>, <span class="st">"21-25"</span>, <span class="st">"26-30"</span>, <span class="st">"31-35"</span>, <span class="st">"36-40"</span>)</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>matrix250_2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> rows4, <span class="at">ncol =</span> cols4)</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rows4) {</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>cols4) {</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>    matrix_row <span class="ot">&lt;-</span> all_2024_250_place_summary_cat_3 <span class="sc">|&gt;</span> </span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(place_cat <span class="sc">==</span> cats4[i] <span class="sc">&amp;</span> place_next_cat <span class="sc">==</span> cats4[j])</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(matrix_row) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> all_2024_250_place_summary_cat_3 <span class="sc">|&gt;</span> </span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(place_cat <span class="sc">==</span> cats4[i] <span class="sc">&amp;</span> place_next_cat <span class="sc">==</span> cats4[j]) <span class="sc">|&gt;</span> <span class="fu">pull</span>(prob)</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>    matrix250_2[i, j] <span class="ot">&lt;-</span> matrix_value</span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(matrix250_2) <span class="ot">&lt;-</span> cats4</span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(matrix250_2) <span class="ot">&lt;-</span> cats4</span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(matrix250_2, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1-5  6-10 11-15 16-20 21-25 26-30 31-35 36-40
1-5   0.957 0.037 0.001 0.000 0.000 0.000 0.002 0.004
6-10  0.043 0.894 0.053 0.001 0.000 0.000 0.006 0.003
11-15 0.000 0.068 0.867 0.052 0.006 0.000 0.003 0.004
16-20 0.000 0.002 0.076 0.855 0.048 0.007 0.005 0.007
21-25 0.000 0.000 0.002 0.088 0.826 0.060 0.014 0.010
26-30 0.001 0.000 0.000 0.005 0.117 0.806 0.061 0.010
31-35 0.000 0.000 0.001 0.000 0.005 0.132 0.801 0.061
36-40 0.000 0.000 0.000 0.000 0.000 0.015 0.219 0.766</code></pre>
</div>
</div>
<p>Let’s apply the same analysis to the WMX class. The only difference will be that WMX motos in 2024 included a maximum of 30 riders so the groups will be 1-5, 6-10, 11-15, 16-20, 21-25, 26-30.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>all_2024_wmx_add <span class="ot">&lt;-</span> all_2024 <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"WMX"</span> <span class="sc">&amp;</span> <span class="sc">!</span> round <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(place) <span class="sc">|&gt;</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race_id_name =</span> <span class="fu">paste</span>(race_id, name, <span class="at">sep =</span> <span class="st">"_"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">place_next =</span> <span class="fu">lead</span>(place, <span class="at">n =</span> 1L,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">order_by =</span> race_id_name)) <span class="sc">|&gt;</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race_id_name) <span class="sc">|&gt;</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">place_next =</span> <span class="fu">c</span>(place_next[<span class="sc">-</span><span class="fu">n</span>()], <span class="cn">NA</span>)) <span class="sc">|&gt;</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">place_next =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(place_next), finish, place_next))</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>all_2024_wmx_place_summary <span class="ot">&lt;-</span> all_2024_wmx_add <span class="sc">|&gt;</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place, place_next) <span class="sc">|&gt;</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place, place_next) <span class="sc">|&gt;</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>all_2024_wmx_place_summary_2 <span class="ot">&lt;-</span> all_2024_wmx_place_summary <span class="sc">|&gt;</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place) <span class="sc">|&gt;</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>all_2024_wmx_place_summary_3 <span class="ot">&lt;-</span> all_2024_wmx_place_summary <span class="sc">|&gt;</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(all_2024_wmx_place_summary_2) <span class="sc">|&gt;</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span>total)</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>rows5 <span class="ot">=</span> <span class="dv">30</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>cols5 <span class="ot">=</span> <span class="dv">30</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>cats5 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>matrixwmx_1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> rows5, <span class="at">ncol =</span> cols5)</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rows5) {</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>cols5) {</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>    matrix_row <span class="ot">&lt;-</span> all_2024_wmx_place_summary_3 <span class="sc">|&gt;</span> </span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(place <span class="sc">==</span> i <span class="sc">&amp;</span> place_next <span class="sc">==</span> j)</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(matrix_row) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> all_2024_wmx_place_summary_3 <span class="sc">|&gt;</span> </span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(place <span class="sc">==</span> i <span class="sc">&amp;</span> place_next <span class="sc">==</span> j) <span class="sc">|&gt;</span> <span class="fu">pull</span>(prob)</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>    matrixwmx_1[i, j] <span class="ot">&lt;-</span> matrix_value</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(matrixwmx_1) <span class="ot">&lt;-</span> cats5</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(matrixwmx_1) <span class="ot">&lt;-</span> cats5</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(matrixwmx_1, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16
1  1 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
2  0 0.94 0.05 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
3  0 0.04 0.87 0.05 0.02 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
4  0 0.02 0.06 0.79 0.09 0.01 0.01 0.00 0.01 0.00 0.00 0.01 0.00 0.00 0.00 0.00
5  0 0.00 0.01 0.11 0.80 0.07 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.00 0.00 0.00
6  0 0.00 0.00 0.03 0.09 0.72 0.12 0.01 0.01 0.00 0.01 0.00 0.00 0.01 0.00 0.00
7  0 0.00 0.00 0.01 0.01 0.16 0.68 0.11 0.01 0.00 0.00 0.00 0.00 0.01 0.00 0.00
8  0 0.00 0.00 0.00 0.00 0.02 0.14 0.71 0.10 0.02 0.00 0.01 0.00 0.00 0.00 0.00
9  0 0.00 0.00 0.00 0.00 0.00 0.03 0.11 0.71 0.09 0.04 0.00 0.01 0.00 0.00 0.00
10 0 0.00 0.00 0.00 0.00 0.00 0.00 0.05 0.08 0.71 0.10 0.02 0.02 0.01 0.00 0.00
11 0 0.00 0.00 0.00 0.00 0.00 0.01 0.01 0.06 0.11 0.64 0.09 0.04 0.02 0.00 0.00
12 0 0.00 0.00 0.00 0.00 0.00 0.01 0.00 0.02 0.06 0.14 0.60 0.11 0.02 0.01 0.02
13 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.00 0.06 0.20 0.60 0.11 0.00 0.02
14 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.01 0.01 0.05 0.11 0.65 0.11 0.02
15 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.05 0.17 0.67 0.07
16 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.02 0.02 0.04 0.06 0.63
17 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.10 0.14
18 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.03
19 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.03
20 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.03 0.00
21 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.03 0.00 0.03 0.00
22 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
23 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.11 0.00 0.00 0.00
24 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00
25 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
26 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
27 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
28 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.10 0.00
29 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
30 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
     17   18   19   20   21   22   23   24   25   26   27   28   29 30
1  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
2  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
3  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
4  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
5  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
6  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
7  0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
8  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
9  0.00 0.00 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
10 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
11 0.00 0.00 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
12 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
13 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
14 0.00 0.02 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
15 0.00 0.02 0.00 0.02 0.00 0.02 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
16 0.10 0.04 0.00 0.02 0.02 0.00 0.02 0.02 0.00 0.00 0.00 0.00 0.00  0
17 0.60 0.12 0.05 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
18 0.22 0.53 0.08 0.08 0.03 0.00 0.03 0.00 0.00 0.00 0.00 0.00 0.00  0
19 0.00 0.11 0.61 0.14 0.03 0.03 0.00 0.03 0.00 0.00 0.00 0.00 0.03  0
20 0.06 0.06 0.11 0.50 0.14 0.06 0.06 0.00 0.00 0.00 0.00 0.00 0.00  0
21 0.00 0.03 0.03 0.12 0.62 0.12 0.00 0.00 0.03 0.00 0.00 0.00 0.00  0
22 0.00 0.00 0.03 0.10 0.13 0.65 0.03 0.03 0.00 0.00 0.00 0.03 0.00  0
23 0.00 0.00 0.00 0.06 0.06 0.11 0.56 0.11 0.00 0.00 0.00 0.00 0.00  0
24 0.06 0.00 0.00 0.00 0.00 0.06 0.12 0.53 0.06 0.06 0.06 0.00 0.00  0
25 0.00 0.00 0.07 0.00 0.00 0.00 0.07 0.13 0.67 0.07 0.00 0.00 0.00  0
26 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.30 0.40 0.30 0.00 0.00  0
27 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.20 0.60 0.20 0.00  0
28 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.20 0.00 0.50 0.20  0
29 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.10 0.00 0.00 0.00 0.20 0.70  0
30 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>all_2024_wmx_place_summary_cat <span class="ot">&lt;-</span> all_2024_wmx_add <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place, place_next) <span class="sc">|&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">place_cat =</span> <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">"1-5"</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">10</span>, <span class="st">"6-10"</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">15</span>, <span class="st">"11-15"</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">20</span>, <span class="st">"16-20"</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">25</span>, </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"21-25"</span>,<span class="st">"26-30"</span>))))),</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">place_next_cat =</span> <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">"1-5"</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">10</span>, </span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"6-10"</span>,</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">15</span>, </span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"11-15"</span>,</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">20</span>, </span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"16-20"</span>,</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">25</span>, </span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"21-25"</span>, <span class="st">"26-30"</span>)))))) <span class="sc">|&gt;</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place_cat, place_next_cat) <span class="sc">|&gt;</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place_cat, place_next_cat) <span class="sc">|&gt;</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>all_2024_wmx_place_summary_cat_2 <span class="ot">&lt;-</span> all_2024_wmx_place_summary_cat <span class="sc">|&gt;</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place_cat) <span class="sc">|&gt;</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>all_2024_wmx_place_summary_cat_3 <span class="ot">&lt;-</span> all_2024_wmx_place_summary_cat <span class="sc">|&gt;</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(all_2024_wmx_place_summary_cat_2) <span class="sc">|&gt;</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span>total)</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>rows6 <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>cols6 <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>cats6 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-5"</span>, <span class="st">"6-10"</span>, <span class="st">"11-15"</span>, <span class="st">"16-20"</span>, <span class="st">"21-25"</span>, <span class="st">"26-30"</span>)</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>matrixwmx_2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> rows6, <span class="at">ncol =</span> cols6)</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rows6) {</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>cols6) {</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>    matrix_row <span class="ot">&lt;-</span> all_2024_wmx_place_summary_cat_3 <span class="sc">|&gt;</span> </span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(place_cat <span class="sc">==</span> cats6[i] <span class="sc">&amp;</span> place_next_cat <span class="sc">==</span> cats6[j])</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(matrix_row) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> all_2024_wmx_place_summary_cat_3 <span class="sc">|&gt;</span> </span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(place_cat <span class="sc">==</span> cats6[i] <span class="sc">&amp;</span> place_next_cat <span class="sc">==</span> cats6[j]) <span class="sc">|&gt;</span> <span class="fu">pull</span>(prob)</span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>    matrixwmx_2[i, j] <span class="ot">&lt;-</span> matrix_value</span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(matrixwmx_2) <span class="ot">&lt;-</span> cats6</span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(matrixwmx_2) <span class="ot">&lt;-</span> cats6</span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(matrixwmx_2,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1-5  6-10 11-15 16-20 21-25 26-30
1-5   0.972 0.023 0.004 0.000 0.000 0.000
6-10  0.028 0.919 0.049 0.004 0.000 0.000
11-15 0.000 0.067 0.893 0.037 0.002 0.000
16-20 0.000 0.000 0.060 0.849 0.085 0.005
21-25 0.000 0.000 0.043 0.113 0.809 0.035
26-30 0.000 0.000 0.023 0.000 0.091 0.886</code></pre>
</div>
</div>
<p>So, what is the probability of going from 6-10 to 1-5 on any given lap?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(matrix450_2[<span class="dv">2</span>,<span class="dv">1</span>], <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.031</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(matrix250_2[<span class="dv">2</span>,<span class="dv">1</span>], <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.043</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(matrixwmx_2[<span class="dv">2</span>,<span class="dv">1</span>], <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.028</code></pre>
</div>
</div>
<p>It appears that is easiest to move into the top 5 in the 250 class with a probability of 4.3%. It is hardest in the WMX class, where there is a 2.8% chance.</p>
<p>Here is a visual way to represent these transition matrices:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>tm_450 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(matrix450_2))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tm_450, <span class="fu">aes</span>(Var1, Var2, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#da3a32"</span>) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Freq,<span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"State Probabilities - 450 Heatmap"</span>, <span class="at">x =</span> <span class="st">"From "</span>, </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"To"</span>, <span class="at">fill =</span> <span class="st">"Probability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>tm_250 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(matrix250_2))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tm_250, <span class="fu">aes</span>(Var1, Var2, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#da3a32"</span>) <span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Freq,<span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"State Probabilities - 250 Heatmap"</span>, <span class="at">x =</span> <span class="st">"From "</span>, </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"To"</span>, <span class="at">fill =</span> <span class="st">"Probability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>tm_wmx <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(matrixwmx_2))</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tm_wmx, <span class="fu">aes</span>(Var1, Var2, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#da3a32"</span>) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Freq,<span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"State Probabilities - WMX Heatmap"</span>, <span class="at">x =</span> <span class="st">"From "</span>, </span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"To"</span>, <span class="at">fill =</span> <span class="st">"Probability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Q2</strong>: What is the probability of going from one place group to another over the course of n laps?</p>
<p>We can let n be any positive integer. As an example, we will consider the probabilities over the course of 5 laps.</p>
<p>450 class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(matrix450_2 <span class="sc">%^%</span> n, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1-5 6-10 11-15 16-20 21-25 26-30
1-5   0.86 0.11  0.01  0.00  0.00  0.01
6-10  0.13 0.74  0.10  0.02  0.01  0.00
11-15 0.01 0.13  0.64  0.16  0.04  0.02
16-20 0.00 0.02  0.21  0.56  0.15  0.06
21-25 0.00 0.00  0.04  0.23  0.57  0.16
26-30 0.00 0.00  0.01  0.07  0.39  0.53</code></pre>
</div>
</div>
<p>250 class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(matrix250_2 <span class="sc">%^%</span> n, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1-5 6-10 11-15 16-20 21-25 26-30 31-35 36-40
1-5   0.81 0.14  0.02  0.00  0.00  0.00  0.01  0.01
6-10  0.16 0.61  0.16  0.02  0.00  0.01  0.02  0.01
11-15 0.02 0.21  0.54  0.15  0.03  0.01  0.02  0.01
16-20 0.00 0.04  0.22  0.51  0.13  0.04  0.03  0.02
21-25 0.00 0.01  0.05  0.23  0.45  0.16  0.07  0.03
26-30 0.00 0.00  0.01  0.07  0.28  0.43  0.16  0.05
31-35 0.00 0.00  0.00  0.02  0.10  0.31  0.44  0.13
36-40 0.00 0.00  0.00  0.00  0.04  0.18  0.45  0.33</code></pre>
</div>
</div>
<p>WMX class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(matrixwmx_2 <span class="sc">%^%</span> n, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1-5 6-10 11-15 16-20 21-25 26-30
1-5   0.87 0.10  0.03  0.00  0.00  0.00
6-10  0.11 0.68  0.17  0.03  0.00  0.00
11-15 0.01 0.23  0.61  0.12  0.03  0.00
16-20 0.00 0.03  0.21  0.52  0.21  0.03
21-25 0.00 0.02  0.17  0.29  0.42  0.10
26-30 0.00 0.01  0.10  0.07  0.24  0.57</code></pre>
</div>
</div>
<p><strong>Q3</strong>: Do these state change probabilities themselves change over the course of a moto?</p>
<p>To narrow this problem, we will consider how the probability of staying in the same position group changes throughout a moto.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>all_2024_450_place_summary_cat_w_laps <span class="ot">&lt;-</span> all_2024_450_add <span class="sc">|&gt;</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place, place_next, lap) <span class="sc">|&gt;</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">place_cat =</span> <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">"1-5"</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">10</span>, <span class="st">"6-10"</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">15</span>, <span class="st">"11-15"</span>,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">20</span>, <span class="st">"16-20"</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">25</span>, </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"21-25"</span>,<span class="st">"26-30"</span>))))),</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">place_next_cat =</span> <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">"1-5"</span>,</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">10</span>, </span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"6-10"</span>,</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">15</span>, </span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"11-15"</span>,</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">20</span>, </span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"16-20"</span>,</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">25</span>, </span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"21-25"</span>, <span class="st">"26-30"</span>)))))) <span class="sc">|&gt;</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(lap, place_cat, place_next_cat) <span class="sc">|&gt;</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(lap, place_cat, place_next_cat) <span class="sc">|&gt;</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>all_2024_450_place_summary_cat_w_laps_2 <span class="ot">&lt;-</span> all_2024_450_place_summary_cat_w_laps <span class="sc">|&gt;</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(lap, place_cat) <span class="sc">|&gt;</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>all_2024_450_place_summary_cat_w_laps_3 <span class="ot">&lt;-</span> all_2024_450_place_summary_cat_w_laps <span class="sc">|&gt;</span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(all_2024_450_place_summary_cat_w_laps_2) <span class="sc">|&gt;</span></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span>total)</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>all_2024_450_place_summary_cat_w_laps_3<span class="sc">$</span>place_cat <span class="ot">=</span> </span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(all_2024_450_place_summary_cat_w_laps_3<span class="sc">$</span>place_cat,</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"1-5"</span>,<span class="st">"6-10"</span>,<span class="st">"11-15"</span>,<span class="st">"16-20"</span>,<span class="st">"21-25"</span>,<span class="st">"26-30"</span>))</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>all_2024_450_place_summary_cat_w_laps_3<span class="sc">$</span>place_next_cat <span class="ot">=</span> </span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(all_2024_450_place_summary_cat_w_laps_3<span class="sc">$</span>place_next_cat,</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"1-5"</span>,<span class="st">"6-10"</span>,<span class="st">"11-15"</span>,<span class="st">"16-20"</span>,<span class="st">"21-25"</span>,<span class="st">"26-30"</span>))</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a><span class="co"># all_2024_450_place_summary_cat_w_laps_3 |&gt;</span></span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = lap, y = prob)) +</span></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_grid(place_cat~place_next_cat)</span></span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>all_2024_450_place_summary_cat_w_laps_3 <span class="sc">|&gt;</span></span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(place_cat <span class="sc">==</span> place_next_cat) <span class="sc">|&gt;</span></span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lap, <span class="at">y =</span> prob, <span class="at">color =</span> place_cat)) <span class="sc">+</span></span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Lap"</span>, <span class="at">y =</span> <span class="st">"Probability of no change"</span>, <span class="at">color =</span> <span class="st">"Position"</span>,</span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"450 Class"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>all_2024_250_place_summary_cat_w_laps <span class="ot">&lt;-</span> all_2024_250_add <span class="sc">|&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place, place_next, lap) <span class="sc">|&gt;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">place_cat =</span> <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">"1-5"</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">10</span>, <span class="st">"6-10"</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">15</span>, <span class="st">"11-15"</span>,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">20</span>, <span class="st">"16-20"</span>,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">25</span>, <span class="st">"21-25"</span>,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">26</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">30</span>, <span class="st">"26-30"</span>,</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">31</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">35</span>,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"31-35"</span>, <span class="st">"36-40"</span>))))))),</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">place_next_cat =</span> <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">"1-5"</span>,</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">10</span>, </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"6-10"</span>,</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">15</span>, </span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"11-15"</span>,</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">20</span>, </span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"16-20"</span>,</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">25</span>,</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"21-25"</span>,</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">26</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">30</span>,</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"26-30"</span>,                                                           <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">31</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">35</span>,</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"31-35"</span>,<span class="st">"36-40"</span>)))))))) <span class="sc">|&gt;</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(lap, place_cat, place_next_cat) <span class="sc">|&gt;</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(lap, place_cat, place_next_cat) <span class="sc">|&gt;</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>all_2024_250_place_summary_cat_w_laps_2 <span class="ot">&lt;-</span> all_2024_250_place_summary_cat_w_laps <span class="sc">|&gt;</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(lap, place_cat) <span class="sc">|&gt;</span></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>all_2024_250_place_summary_cat_w_laps_3 <span class="ot">&lt;-</span> all_2024_250_place_summary_cat_w_laps <span class="sc">|&gt;</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(all_2024_250_place_summary_cat_w_laps_2) <span class="sc">|&gt;</span></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span>total)</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>all_2024_250_place_summary_cat_w_laps_3<span class="sc">$</span>place_cat <span class="ot">=</span> </span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(all_2024_250_place_summary_cat_w_laps_3<span class="sc">$</span>place_cat,</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"1-5"</span>,<span class="st">"6-10"</span>,<span class="st">"11-15"</span>,<span class="st">"16-20"</span>,</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"21-25"</span>,<span class="st">"26-30"</span>,<span class="st">"31-35"</span>,<span class="st">"36-40"</span>))</span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>all_2024_250_place_summary_cat_w_laps_3<span class="sc">$</span>place_next_cat <span class="ot">=</span> </span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(all_2024_250_place_summary_cat_w_laps_3<span class="sc">$</span>place_next_cat,</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"1-5"</span>,<span class="st">"6-10"</span>,<span class="st">"11-15"</span>,<span class="st">"16-20"</span>,</span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"21-25"</span>,<span class="st">"26-30"</span>,<span class="st">"31-35"</span>,<span class="st">"36-40"</span>))</span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a><span class="co"># all_2024_250_place_summary_cat_w_laps_3 |&gt;</span></span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = lap, y = prob)) +</span></span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_grid(place_cat~place_next_cat)</span></span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>all_2024_250_place_summary_cat_w_laps_3 <span class="sc">|&gt;</span></span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(place_cat <span class="sc">==</span> place_next_cat) <span class="sc">|&gt;</span></span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lap, <span class="at">y =</span> prob, <span class="at">color =</span> place_cat)) <span class="sc">+</span></span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Lap"</span>, <span class="at">y =</span> <span class="st">"Probability of no change"</span>, <span class="at">color =</span> <span class="st">"Position"</span>,</span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"250 Class"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>WMX class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>all_2024_wmx_place_summary_cat_w_laps <span class="ot">&lt;-</span> all_2024_wmx_add <span class="sc">|&gt;</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place, place_next, lap) <span class="sc">|&gt;</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">place_cat =</span> <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">"1-5"</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">10</span>, <span class="st">"6-10"</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">15</span>, <span class="st">"11-15"</span>,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">20</span>, <span class="st">"16-20"</span>,</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">25</span>, </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"21-25"</span>,<span class="st">"26-30"</span>))))),</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">place_next_cat =</span> <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">"1-5"</span>,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">10</span>, </span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"6-10"</span>,</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">15</span>, </span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"11-15"</span>,</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">20</span>, </span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"16-20"</span>,</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(place_next <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> place_next <span class="sc">&lt;=</span> <span class="dv">25</span>, </span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"21-25"</span>, <span class="st">"26-30"</span>)))))) <span class="sc">|&gt;</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(lap, place_cat, place_next_cat) <span class="sc">|&gt;</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(lap, place_cat, place_next_cat) <span class="sc">|&gt;</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>all_2024_wmx_place_summary_cat_w_laps_2 <span class="ot">&lt;-</span> all_2024_wmx_place_summary_cat_w_laps <span class="sc">|&gt;</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(lap, place_cat) <span class="sc">|&gt;</span></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>all_2024_wmx_place_summary_cat_w_laps_3 <span class="ot">&lt;-</span> all_2024_wmx_place_summary_cat_w_laps <span class="sc">|&gt;</span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(all_2024_wmx_place_summary_cat_w_laps_2) <span class="sc">|&gt;</span></span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span>total)</span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>all_2024_wmx_place_summary_cat_w_laps_3<span class="sc">$</span>place_cat <span class="ot">=</span> </span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(all_2024_wmx_place_summary_cat_w_laps_3<span class="sc">$</span>place_cat,</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"1-5"</span>,<span class="st">"6-10"</span>,<span class="st">"11-15"</span>,<span class="st">"16-20"</span>,<span class="st">"21-25"</span>,<span class="st">"26-30"</span>))</span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>all_2024_wmx_place_summary_cat_w_laps_3<span class="sc">$</span>place_next_cat <span class="ot">=</span> </span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(all_2024_wmx_place_summary_cat_w_laps_3<span class="sc">$</span>place_next_cat,</span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"1-5"</span>,<span class="st">"6-10"</span>,<span class="st">"11-15"</span>,<span class="st">"16-20"</span>,<span class="st">"21-25"</span>,<span class="st">"26-30"</span>))</span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a><span class="co"># all_2024_wmx_place_summary_cat_w_laps_3 |&gt;</span></span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = lap, y = prob)) +</span></span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_grid(place_cat~place_next_cat)</span></span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a>all_2024_wmx_place_summary_cat_w_laps_3 <span class="sc">|&gt;</span></span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(place_cat <span class="sc">==</span> place_next_cat) <span class="sc">|&gt;</span></span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lap, <span class="at">y =</span> prob, <span class="at">color =</span> place_cat)) <span class="sc">+</span></span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb49-49"><a href="#cb49-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Lap"</span>, <span class="at">y =</span> <span class="st">"Probability of no change"</span>, <span class="at">color =</span> <span class="st">"Position"</span>,</span>
<span id="cb49-50"><a href="#cb49-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"WMX Class"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A big takeaway from these visuals is that is becomes less probable of changing positions the longer the race goes on. This makes sense as gaps begin to open up.</p>
<p><strong>Q4</strong>: What is the probability of completing the first lap in one place and finishing the race in any given place?</p>
<p>450 class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>all_2024_450_start_finish <span class="ot">&lt;-</span> all_2024 <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"450"</span> <span class="sc">&amp;</span> lap <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place, finish)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>all_2024_450_start_finish_sum <span class="ot">&lt;-</span> all_2024_450_start_finish <span class="sc">|&gt;</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place, finish) <span class="sc">|&gt;</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>all_2024_450_start_finish_sum_2 <span class="ot">&lt;-</span> all_2024_450_start_finish_sum <span class="sc">|&gt;</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place) <span class="sc">|&gt;</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>all_2024_450_start_finish_sum_3 <span class="ot">&lt;-</span> all_2024_450_start_finish_sum <span class="sc">|&gt;</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(all_2024_450_start_finish_sum_2) <span class="sc">|&gt;</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span>total)</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">=</span> <span class="dv">30</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">=</span> <span class="dv">30</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>cats <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>matrix450_3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> rows, <span class="at">ncol =</span> cols)</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rows) {</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>cols) {</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>    matrix_row <span class="ot">&lt;-</span> all_2024_450_start_finish_sum_3 <span class="sc">|&gt;</span> </span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(place <span class="sc">==</span> i <span class="sc">&amp;</span> finish <span class="sc">==</span> j)</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(matrix_row) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> all_2024_450_start_finish_sum_3 <span class="sc">|&gt;</span> </span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(place <span class="sc">==</span> i <span class="sc">&amp;</span> finish <span class="sc">==</span> j) <span class="sc">|&gt;</span> <span class="fu">pull</span>(prob)</span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>    matrix450_3[i, j] <span class="ot">&lt;-</span> matrix_value</span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(matrix450_3) <span class="ot">&lt;-</span> cats</span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(matrix450_3) <span class="ot">&lt;-</span> cats</span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(matrix450_3, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      1    2    3    4    5    6    7    8    9   10   11   12   13   14   15
1  0.50 0.31 0.06 0.00 0.06 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00
2  0.31 0.25 0.31 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
3  0.12 0.31 0.06 0.00 0.06 0.06 0.06 0.06 0.00 0.00 0.06 0.00 0.00 0.06 0.00
4  0.06 0.12 0.12 0.19 0.19 0.00 0.12 0.12 0.00 0.00 0.00 0.06 0.00 0.00 0.00
5  0.00 0.00 0.25 0.06 0.00 0.19 0.06 0.06 0.06 0.12 0.00 0.00 0.06 0.00 0.06
6  0.00 0.00 0.00 0.19 0.06 0.38 0.00 0.12 0.06 0.00 0.00 0.00 0.06 0.00 0.00
7  0.00 0.00 0.00 0.12 0.19 0.19 0.19 0.00 0.00 0.12 0.00 0.06 0.00 0.00 0.06
8  0.00 0.00 0.06 0.06 0.06 0.06 0.25 0.06 0.25 0.06 0.00 0.00 0.00 0.00 0.00
9  0.00 0.00 0.06 0.06 0.06 0.06 0.06 0.12 0.12 0.19 0.06 0.06 0.00 0.00 0.06
10 0.00 0.00 0.00 0.06 0.06 0.00 0.06 0.06 0.06 0.12 0.12 0.06 0.00 0.06 0.00
11 0.00 0.00 0.00 0.12 0.00 0.00 0.00 0.06 0.19 0.00 0.12 0.00 0.00 0.00 0.31
12 0.00 0.00 0.00 0.00 0.06 0.00 0.06 0.12 0.12 0.06 0.12 0.00 0.12 0.06 0.00
13 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.06 0.00 0.06 0.00 0.12 0.12 0.12 0.00
14 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.06 0.06 0.00 0.12 0.12 0.19 0.12 0.06
15 0.00 0.00 0.00 0.00 0.12 0.00 0.00 0.00 0.00 0.00 0.12 0.00 0.00 0.06 0.12
16 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.19 0.06 0.12 0.06
17 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.12 0.00 0.12 0.12 0.00 0.06
18 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.06 0.06 0.06 0.06 0.00 0.00 0.06 0.00
19 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.06 0.06 0.06
20 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.06 0.00
21 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.06 0.00 0.00
22 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.12
23 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
24 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00
25 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
26 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.06 0.00
27 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.07 0.00 0.00
28 0.00 0.00 0.00 0.00 0.00 0.08 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
29 0.00 0.00 0.00 0.00 0.00 0.00 0.09 0.00 0.00 0.00 0.09 0.00 0.00 0.09 0.00
30 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
     16   17   18   19   20   21   22   23   24   25   26   27   28   29   30
1  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
2  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00
3  0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00
4  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
5  0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
6  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.06 0.00 0.00
7  0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
8  0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00
9  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06
10 0.00 0.12 0.00 0.00 0.06 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00
11 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.06 0.00 0.06 0.00 0.00 0.00
12 0.06 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.06 0.00 0.00
13 0.12 0.00 0.06 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.12 0.00 0.00 0.00
14 0.00 0.00 0.00 0.12 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
15 0.00 0.06 0.12 0.12 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.12
16 0.31 0.06 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00
17 0.06 0.06 0.00 0.00 0.00 0.12 0.00 0.12 0.06 0.00 0.12 0.00 0.00 0.00 0.00
18 0.06 0.12 0.12 0.06 0.06 0.12 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00
19 0.12 0.12 0.00 0.06 0.00 0.06 0.12 0.00 0.00 0.06 0.00 0.06 0.00 0.06 0.06
20 0.06 0.06 0.12 0.06 0.12 0.00 0.06 0.06 0.00 0.19 0.00 0.00 0.12 0.00 0.00
21 0.00 0.00 0.06 0.12 0.00 0.12 0.12 0.12 0.00 0.12 0.00 0.06 0.06 0.06 0.00
22 0.06 0.00 0.06 0.06 0.19 0.06 0.06 0.06 0.06 0.00 0.06 0.00 0.00 0.06 0.06
23 0.06 0.00 0.00 0.12 0.00 0.19 0.00 0.12 0.06 0.12 0.12 0.06 0.06 0.00 0.00
24 0.00 0.00 0.12 0.00 0.12 0.06 0.12 0.12 0.00 0.06 0.19 0.00 0.06 0.06 0.00
25 0.06 0.12 0.06 0.12 0.00 0.00 0.06 0.00 0.38 0.00 0.12 0.06 0.00 0.00 0.00
26 0.00 0.00 0.06 0.00 0.06 0.00 0.12 0.19 0.06 0.12 0.00 0.06 0.00 0.19 0.00
27 0.00 0.00 0.07 0.00 0.13 0.00 0.07 0.07 0.20 0.20 0.00 0.13 0.00 0.07 0.00
28 0.00 0.15 0.08 0.00 0.08 0.08 0.15 0.00 0.15 0.00 0.08 0.08 0.00 0.08 0.00
29 0.00 0.00 0.09 0.00 0.00 0.00 0.09 0.00 0.00 0.00 0.09 0.09 0.09 0.18 0.09
30 0.00 0.00 0.00 0.00 0.14 0.00 0.00 0.14 0.14 0.00 0.14 0.14 0.14 0.00 0.14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>all_2024_450_start_finish_cat <span class="ot">&lt;-</span> all_2024 <span class="sc">|&gt;</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"450"</span> <span class="sc">&amp;</span> lap <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place, finish) <span class="sc">|&gt;</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">place_cat =</span> <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">"1-5"</span>,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">10</span>, <span class="st">"6-10"</span>,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">15</span>, <span class="st">"11-15"</span>,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">20</span>, <span class="st">"16-20"</span>,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">25</span>, </span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"21-25"</span>,<span class="st">"26-30"</span>))))),</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">finish_cat =</span> <span class="fu">ifelse</span>(finish <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> finish <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">"1-5"</span>,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(finish <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> finish <span class="sc">&lt;=</span> <span class="dv">10</span>, <span class="st">"6-10"</span>,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(finish <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> finish <span class="sc">&lt;=</span> <span class="dv">15</span>, <span class="st">"11-15"</span>,</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(finish <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> finish <span class="sc">&lt;=</span> <span class="dv">20</span>, <span class="st">"16-20"</span>,</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(finish <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> finish <span class="sc">&lt;=</span> <span class="dv">25</span>, <span class="st">"21-25"</span>, </span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"26-30"</span>)))))) <span class="sc">|&gt;</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place_cat, finish_cat) <span class="sc">|&gt;</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place_cat, finish_cat) <span class="sc">|&gt;</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>all_2024_450_start_finish_cat_2 <span class="ot">&lt;-</span> all_2024_450_start_finish_cat <span class="sc">|&gt;</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place_cat) <span class="sc">|&gt;</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>all_2024_450_start_finish_cat_3 <span class="ot">&lt;-</span> all_2024_450_start_finish_cat <span class="sc">|&gt;</span></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(all_2024_450_start_finish_cat_2) <span class="sc">|&gt;</span></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span>total)</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>rows2 <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>cols2 <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>cats2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-5"</span>, <span class="st">"6-10"</span>, <span class="st">"11-15"</span>, <span class="st">"16-20"</span>, <span class="st">"21-25"</span>, <span class="st">"26-30"</span>)</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>matrix450_4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> rows2, <span class="at">ncol =</span> cols2)</span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rows2) {</span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>cols2) {</span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>    matrix_row <span class="ot">&lt;-</span> all_2024_450_start_finish_cat_3 <span class="sc">|&gt;</span></span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(place_cat <span class="sc">==</span> cats2[i] <span class="sc">&amp;</span> finish_cat <span class="sc">==</span> cats2[j])</span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(matrix_row) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> all_2024_450_start_finish_cat_3 <span class="sc">|&gt;</span> </span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(place_cat <span class="sc">==</span> cats2[i] <span class="sc">&amp;</span> finish_cat <span class="sc">==</span> cats2[j]) <span class="sc">|&gt;</span> <span class="fu">pull</span>(prob)</span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a>    matrix450_4[i, j] <span class="ot">&lt;-</span> matrix_value</span>
<span id="cb52-46"><a href="#cb52-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-47"><a href="#cb52-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-48"><a href="#cb52-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-49"><a href="#cb52-49" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(matrix450_4) <span class="ot">&lt;-</span> cats2</span>
<span id="cb52-50"><a href="#cb52-50" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(matrix450_4) <span class="ot">&lt;-</span> cats2</span>
<span id="cb52-51"><a href="#cb52-51" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(matrix450_4, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1-5  6-10 11-15 16-20 21-25 26-30
1-5   0.688 0.200 0.062 0.025 0.000 0.025
6-10  0.212 0.525 0.125 0.050 0.025 0.062
11-15 0.075 0.188 0.412 0.175 0.038 0.112
16-20 0.013 0.062 0.262 0.338 0.225 0.100
21-25 0.013 0.000 0.075 0.275 0.412 0.225
26-30 0.000 0.032 0.081 0.177 0.387 0.323</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>sf_450 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(matrix450_3))</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sf_450, <span class="fu">aes</span>(Var1, Var2, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#da3a32"</span>) <span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_text(aes(label = round(Freq,2))) +</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"450 Heatmap"</span>, <span class="at">x =</span> <span class="st">"Start "</span>, <span class="at">y =</span> <span class="st">"Finish"</span>,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Probability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>250 class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>all_2024_250_start_finish <span class="ot">&lt;-</span> all_2024 <span class="sc">|&gt;</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"250"</span> <span class="sc">&amp;</span> lap <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place, finish)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>all_2024_250_start_finish_sum <span class="ot">&lt;-</span> all_2024_250_start_finish <span class="sc">|&gt;</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place, finish) <span class="sc">|&gt;</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>all_2024_250_start_finish_sum_2 <span class="ot">&lt;-</span> all_2024_250_start_finish_sum <span class="sc">|&gt;</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place) <span class="sc">|&gt;</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>all_2024_250_start_finish_sum_3 <span class="ot">&lt;-</span> all_2024_250_start_finish_sum <span class="sc">|&gt;</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(all_2024_250_start_finish_sum_2) <span class="sc">|&gt;</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span>total)</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">=</span> <span class="dv">40</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">=</span> <span class="dv">40</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>cats <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">40</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>matrix250_3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> rows, <span class="at">ncol =</span> cols)</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rows) {</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>cols) {</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>    matrix_row <span class="ot">&lt;-</span> all_2024_250_start_finish_sum_3 <span class="sc">|&gt;</span> </span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(place <span class="sc">==</span> i <span class="sc">&amp;</span> finish <span class="sc">==</span> j)</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(matrix_row) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> all_2024_250_start_finish_sum_3 <span class="sc">|&gt;</span> </span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(place <span class="sc">==</span> i <span class="sc">&amp;</span> finish <span class="sc">==</span> j) <span class="sc">|&gt;</span> <span class="fu">pull</span>(prob)</span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>    matrix250_3[i, j] <span class="ot">&lt;-</span> matrix_value</span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(matrix250_3) <span class="ot">&lt;-</span> cats</span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(matrix250_3) <span class="ot">&lt;-</span> cats</span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(matrix250_3, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      1    2    3    4    5    6    7    8    9   10   11   12   13   14   15
1  0.56 0.25 0.06 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
2  0.25 0.25 0.12 0.12 0.00 0.00 0.06 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00
3  0.06 0.19 0.38 0.06 0.00 0.06 0.12 0.06 0.00 0.00 0.00 0.06 0.00 0.00 0.00
4  0.00 0.12 0.12 0.12 0.25 0.06 0.00 0.06 0.00 0.19 0.00 0.00 0.00 0.00 0.00
5  0.00 0.06 0.00 0.06 0.06 0.19 0.00 0.06 0.06 0.00 0.06 0.06 0.19 0.00 0.06
6  0.00 0.00 0.19 0.06 0.19 0.19 0.00 0.06 0.12 0.06 0.00 0.06 0.00 0.00 0.00
7  0.00 0.06 0.00 0.06 0.19 0.12 0.06 0.12 0.06 0.06 0.06 0.00 0.00 0.00 0.00
8  0.06 0.00 0.00 0.06 0.06 0.00 0.00 0.00 0.06 0.06 0.06 0.12 0.00 0.25 0.06
9  0.00 0.00 0.00 0.19 0.06 0.00 0.06 0.19 0.06 0.06 0.06 0.00 0.00 0.06 0.06
10 0.00 0.00 0.06 0.06 0.06 0.00 0.06 0.12 0.12 0.06 0.00 0.06 0.12 0.12 0.00
11 0.00 0.00 0.00 0.00 0.06 0.00 0.19 0.06 0.06 0.00 0.00 0.00 0.12 0.06 0.12
12 0.00 0.00 0.00 0.06 0.00 0.12 0.00 0.06 0.00 0.06 0.12 0.00 0.25 0.00 0.06
13 0.00 0.00 0.00 0.00 0.00 0.06 0.06 0.06 0.12 0.00 0.00 0.06 0.00 0.06 0.12
14 0.00 0.06 0.00 0.12 0.00 0.00 0.00 0.06 0.00 0.00 0.19 0.25 0.00 0.06 0.00
15 0.00 0.00 0.06 0.00 0.00 0.00 0.06 0.00 0.12 0.06 0.06 0.12 0.12 0.00 0.19
16 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.19 0.00 0.00 0.12 0.00
17 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.12 0.12 0.00 0.06 0.00 0.06
18 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.12 0.00 0.06 0.00 0.06 0.00
19 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.12
20 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00
21 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.06 0.06 0.06 0.00 0.06 0.00
22 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
23 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00
24 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06
25 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00
26 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
27 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
28 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
29 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
30 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00
31 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
32 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00
33 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00
34 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06
35 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
36 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
37 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
38 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
39 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.11 0.00 0.00 0.00
40 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
     16   17   18   19   20   21   22   23   24   25   26   27   28   29   30
1  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
2  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
3  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
4  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00
5  0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
6  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
7  0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
8  0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00
9  0.12 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
10 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
11 0.00 0.00 0.00 0.00 0.00 0.06 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
12 0.00 0.00 0.12 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
13 0.12 0.00 0.06 0.00 0.00 0.12 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00
14 0.00 0.06 0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
15 0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.06 0.00 0.00 0.00 0.00 0.00
16 0.00 0.06 0.06 0.00 0.06 0.00 0.06 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00
17 0.19 0.06 0.00 0.12 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.06 0.00 0.00 0.00
18 0.06 0.06 0.12 0.00 0.06 0.00 0.06 0.00 0.00 0.06 0.06 0.00 0.00 0.12 0.06
19 0.12 0.12 0.00 0.06 0.00 0.06 0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.06 0.06
20 0.00 0.00 0.06 0.00 0.00 0.12 0.12 0.06 0.06 0.00 0.06 0.06 0.00 0.00 0.06
21 0.12 0.00 0.06 0.12 0.00 0.06 0.06 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00
22 0.00 0.12 0.00 0.00 0.19 0.00 0.00 0.06 0.00 0.00 0.06 0.00 0.00 0.12 0.00
23 0.06 0.19 0.06 0.19 0.00 0.00 0.00 0.06 0.06 0.12 0.00 0.06 0.00 0.06 0.00
24 0.00 0.00 0.06 0.06 0.19 0.00 0.00 0.06 0.00 0.06 0.00 0.12 0.06 0.06 0.00
25 0.00 0.06 0.12 0.06 0.00 0.12 0.00 0.00 0.12 0.06 0.06 0.00 0.00 0.06 0.00
26 0.06 0.00 0.06 0.06 0.00 0.12 0.00 0.06 0.00 0.12 0.00 0.12 0.12 0.06 0.06
27 0.00 0.00 0.00 0.06 0.06 0.06 0.06 0.00 0.06 0.19 0.19 0.06 0.06 0.00 0.00
28 0.06 0.00 0.00 0.00 0.19 0.06 0.06 0.06 0.06 0.12 0.06 0.00 0.00 0.06 0.06
29 0.00 0.06 0.00 0.00 0.06 0.00 0.00 0.06 0.00 0.06 0.00 0.12 0.00 0.00 0.12
30 0.00 0.00 0.00 0.00 0.12 0.06 0.06 0.00 0.25 0.00 0.00 0.00 0.00 0.00 0.06
31 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.06 0.00 0.00 0.12 0.00 0.12 0.00 0.06
32 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.06 0.06 0.00 0.06 0.06 0.00 0.12 0.00
33 0.06 0.00 0.00 0.06 0.00 0.00 0.12 0.00 0.06 0.00 0.06 0.00 0.12 0.06 0.00
34 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.06 0.06 0.06 0.06 0.06 0.12 0.00 0.06
35 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.06 0.00 0.19 0.06 0.06
36 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.06 0.00 0.06 0.00 0.00 0.19
37 0.00 0.00 0.07 0.00 0.00 0.00 0.07 0.07 0.00 0.00 0.00 0.07 0.07 0.00 0.00
38 0.00 0.00 0.00 0.08 0.00 0.00 0.15 0.08 0.00 0.00 0.00 0.00 0.08 0.08 0.08
39 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.11 0.00 0.00 0.11 0.00 0.00 0.11
40 0.00 0.00 0.00 0.00 0.00 0.00 0.17 0.00 0.00 0.00 0.00 0.00 0.17 0.17 0.00
     31   32   33   34   35   36   37   38   39   40
1  0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00
2  0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.06 0.00 0.00
3  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
4  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
5  0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00
6  0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00
7  0.00 0.00 0.00 0.00 0.06 0.06 0.00 0.00 0.00 0.00
8  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.06
9  0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00
10 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00
11 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.06 0.00 0.06
12 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.12 0.00
13 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00
14 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00
15 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
16 0.00 0.00 0.06 0.00 0.00 0.00 0.12 0.12 0.00 0.00
17 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00
18 0.00 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
19 0.00 0.00 0.06 0.00 0.00 0.06 0.12 0.00 0.00 0.00
20 0.00 0.00 0.00 0.00 0.06 0.12 0.00 0.00 0.06 0.00
21 0.00 0.06 0.00 0.06 0.06 0.00 0.00 0.00 0.00 0.00
22 0.00 0.06 0.19 0.00 0.12 0.00 0.00 0.00 0.00 0.00
23 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
24 0.06 0.00 0.00 0.06 0.00 0.06 0.06 0.00 0.00 0.00
25 0.00 0.00 0.06 0.06 0.06 0.00 0.00 0.00 0.06 0.00
26 0.00 0.00 0.06 0.00 0.06 0.00 0.00 0.00 0.00 0.00
27 0.06 0.00 0.00 0.00 0.00 0.06 0.00 0.06 0.00 0.00
28 0.06 0.00 0.00 0.00 0.06 0.00 0.00 0.00 0.00 0.00
29 0.12 0.06 0.00 0.06 0.06 0.00 0.12 0.00 0.00 0.00
30 0.06 0.12 0.00 0.06 0.06 0.00 0.00 0.00 0.06 0.00
31 0.00 0.19 0.06 0.06 0.06 0.06 0.00 0.00 0.06 0.00
32 0.06 0.00 0.00 0.12 0.00 0.12 0.12 0.00 0.00 0.06
33 0.06 0.12 0.06 0.00 0.00 0.00 0.00 0.12 0.00 0.00
34 0.06 0.06 0.00 0.06 0.00 0.06 0.12 0.00 0.00 0.00
35 0.12 0.00 0.00 0.06 0.00 0.12 0.12 0.06 0.00 0.00
36 0.12 0.12 0.12 0.06 0.00 0.06 0.00 0.06 0.00 0.00
37 0.00 0.07 0.20 0.13 0.07 0.07 0.07 0.07 0.00 0.00
38 0.00 0.00 0.08 0.00 0.08 0.00 0.00 0.15 0.08 0.08
39 0.22 0.11 0.00 0.00 0.00 0.00 0.00 0.00 0.22 0.00
40 0.00 0.00 0.00 0.17 0.00 0.00 0.00 0.00 0.00 0.33</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>all_2024_250_start_finish_cat <span class="ot">&lt;-</span> all_2024 <span class="sc">|&gt;</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"250"</span> <span class="sc">&amp;</span> lap <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place, finish) <span class="sc">|&gt;</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">place_cat =</span> <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">"1-5"</span>,</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">10</span>, <span class="st">"6-10"</span>,</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">15</span>, <span class="st">"11-15"</span>,</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">20</span>, <span class="st">"16-20"</span>,</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">25</span>, <span class="st">"21-25"</span>,</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">26</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">30</span>, <span class="st">"26-30"</span>,</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">31</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">35</span>, <span class="st">"31-35"</span>, </span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"36-40"</span>))))))),</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">finish_cat =</span> <span class="fu">ifelse</span>(finish <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> finish <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">"1-5"</span>,</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(finish <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> finish <span class="sc">&lt;=</span> <span class="dv">10</span>, <span class="st">"6-10"</span>,</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(finish <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> finish <span class="sc">&lt;=</span> <span class="dv">15</span>, <span class="st">"11-15"</span>,</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(finish <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> finish <span class="sc">&lt;=</span> <span class="dv">20</span>, <span class="st">"16-20"</span>,</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(finish <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> finish <span class="sc">&lt;=</span> <span class="dv">25</span>, <span class="st">"21-25"</span>, </span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(finish <span class="sc">&gt;=</span> <span class="dv">26</span> <span class="sc">&amp;</span> finish <span class="sc">&lt;=</span> <span class="dv">30</span>, <span class="st">"26-30"</span>,</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(finish <span class="sc">&gt;=</span> <span class="dv">31</span> <span class="sc">&amp;</span> finish <span class="sc">&lt;=</span> <span class="dv">35</span>, <span class="st">"31-35"</span>, </span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"36-40"</span>)))))))) <span class="sc">|&gt;</span></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place_cat, finish_cat) <span class="sc">|&gt;</span></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place_cat, finish_cat) <span class="sc">|&gt;</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>all_2024_250_start_finish_cat_2 <span class="ot">&lt;-</span> all_2024_250_start_finish_cat <span class="sc">|&gt;</span></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place_cat) <span class="sc">|&gt;</span></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>all_2024_250_start_finish_cat_3 <span class="ot">&lt;-</span> all_2024_250_start_finish_cat <span class="sc">|&gt;</span></span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(all_2024_250_start_finish_cat_2) <span class="sc">|&gt;</span></span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span>total)</span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a>rows2 <span class="ot">=</span> <span class="dv">8</span></span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a>cols2 <span class="ot">=</span> <span class="dv">8</span></span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a>cats2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-5"</span>, <span class="st">"6-10"</span>, <span class="st">"11-15"</span>, <span class="st">"16-20"</span>, </span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a>           <span class="st">"21-25"</span>, <span class="st">"26-30"</span>, <span class="st">"31-35"</span>, <span class="st">"36-40"</span>)</span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a>matrix250_4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> rows2, <span class="at">ncol =</span> cols2)</span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rows2) {</span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>cols2) {</span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a>    matrix_row <span class="ot">&lt;-</span> all_2024_250_start_finish_cat_3 <span class="sc">|&gt;</span></span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(place_cat <span class="sc">==</span> cats2[i] <span class="sc">&amp;</span> finish_cat <span class="sc">==</span> cats2[j])</span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(matrix_row) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb57-47"><a href="#cb57-47" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> all_2024_250_start_finish_cat_3 <span class="sc">|&gt;</span> </span>
<span id="cb57-48"><a href="#cb57-48" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(place_cat <span class="sc">==</span> cats2[i] <span class="sc">&amp;</span> finish_cat <span class="sc">==</span> cats2[j]) <span class="sc">|&gt;</span> <span class="fu">pull</span>(prob)</span>
<span id="cb57-49"><a href="#cb57-49" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb57-50"><a href="#cb57-50" aria-hidden="true" tabindex="-1"></a>    matrix250_4[i, j] <span class="ot">&lt;-</span> matrix_value</span>
<span id="cb57-51"><a href="#cb57-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb57-52"><a href="#cb57-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-53"><a href="#cb57-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-54"><a href="#cb57-54" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(matrix250_4) <span class="ot">&lt;-</span> cats2</span>
<span id="cb57-55"><a href="#cb57-55" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(matrix250_4) <span class="ot">&lt;-</span> cats2</span>
<span id="cb57-56"><a href="#cb57-56" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(matrix250_4, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1-5  6-10 11-15 16-20 21-25 26-30 31-35 36-40
1-5   0.625 0.212 0.088 0.013 0.000 0.013 0.025 0.025
6-10  0.275 0.350 0.225 0.062 0.000 0.013 0.038 0.038
11-15 0.075 0.238 0.400 0.100 0.075 0.013 0.025 0.075
16-20 0.000 0.100 0.175 0.250 0.162 0.125 0.062 0.125
21-25 0.013 0.050 0.062 0.338 0.188 0.138 0.175 0.038
26-30 0.000 0.038 0.000 0.162 0.312 0.238 0.188 0.062
31-35 0.000 0.013 0.038 0.050 0.150 0.300 0.238 0.212
36-40 0.017 0.000 0.017 0.034 0.153 0.220 0.339 0.220</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>sf_250 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(matrix250_3))</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sf_250, <span class="fu">aes</span>(Var1, Var2, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#da3a32"</span>) <span class="sc">+</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_text(aes(label = round(Freq,2))) +</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"250 Heatmap"</span>, <span class="at">x =</span> <span class="st">"Start "</span>, <span class="at">y =</span> <span class="st">"Finish"</span>,</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Probability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>WMX class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>all_2024_wmx_start_finish <span class="ot">&lt;-</span> all_2024 <span class="sc">|&gt;</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"WMX"</span> <span class="sc">&amp;</span> lap <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place, finish)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>all_2024_wmx_start_finish_sum <span class="ot">&lt;-</span> all_2024_wmx_start_finish <span class="sc">|&gt;</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place, finish) <span class="sc">|&gt;</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>all_2024_wmx_start_finish_sum_2 <span class="ot">&lt;-</span> all_2024_wmx_start_finish_sum <span class="sc">|&gt;</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place) <span class="sc">|&gt;</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>all_2024_wmx_start_finish_sum_3 <span class="ot">&lt;-</span> all_2024_wmx_start_finish_sum <span class="sc">|&gt;</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(all_2024_wmx_start_finish_sum_2) <span class="sc">|&gt;</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span>total)</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">=</span> <span class="dv">30</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">=</span> <span class="dv">30</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>cats <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>matrixwmx_3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> rows, <span class="at">ncol =</span> cols)</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rows) {</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>cols) {</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>    matrix_row <span class="ot">&lt;-</span> all_2024_wmx_start_finish_sum_3 <span class="sc">|&gt;</span> </span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(place <span class="sc">==</span> i <span class="sc">&amp;</span> finish <span class="sc">==</span> j)</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(matrix_row) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> all_2024_wmx_start_finish_sum_3 <span class="sc">|&gt;</span> </span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(place <span class="sc">==</span> i <span class="sc">&amp;</span> finish <span class="sc">==</span> j) <span class="sc">|&gt;</span> <span class="fu">pull</span>(prob)</span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>    matrixwmx_3[i, j] <span class="ot">&lt;-</span> matrix_value</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(matrixwmx_3) <span class="ot">&lt;-</span> cats</span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(matrixwmx_3) <span class="ot">&lt;-</span> cats</span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(matrixwmx_3, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16
1  1 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
2  0 0.64 0.21 0.14 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
3  0 0.21 0.36 0.07 0.29 0.00 0.07 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
4  0 0.07 0.14 0.29 0.21 0.00 0.07 0.00 0.00 0.00 0.07 0.00 0.14 0.00 0.00 0.00
5  0 0.00 0.14 0.29 0.36 0.07 0.00 0.07 0.00 0.00 0.00 0.00 0.00 0.07 0.00 0.00
6  0 0.07 0.00 0.21 0.07 0.29 0.29 0.00 0.00 0.07 0.00 0.00 0.00 0.00 0.00 0.00
7  0 0.00 0.14 0.00 0.00 0.21 0.21 0.14 0.14 0.00 0.00 0.00 0.14 0.00 0.00 0.00
8  0 0.00 0.00 0.00 0.00 0.00 0.14 0.29 0.14 0.21 0.07 0.00 0.00 0.14 0.00 0.00
9  0 0.00 0.00 0.00 0.00 0.14 0.14 0.14 0.07 0.14 0.07 0.14 0.00 0.00 0.00 0.14
10 0 0.00 0.00 0.00 0.00 0.07 0.00 0.21 0.21 0.21 0.00 0.00 0.14 0.14 0.00 0.00
11 0 0.00 0.00 0.00 0.07 0.00 0.00 0.00 0.14 0.14 0.14 0.21 0.14 0.07 0.00 0.00
12 0 0.00 0.00 0.00 0.00 0.00 0.00 0.07 0.07 0.07 0.36 0.21 0.00 0.00 0.07 0.00
13 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.07 0.21 0.07 0.29 0.07 0.21 0.07
14 0 0.00 0.00 0.00 0.00 0.00 0.07 0.00 0.07 0.07 0.00 0.21 0.07 0.21 0.14 0.00
15 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.40 0.10 0.20
16 0 0.00 0.00 0.00 0.00 0.00 0.00 0.12 0.00 0.00 0.12 0.00 0.00 0.00 0.12 0.12
17 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
18 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.17
19 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.17
20 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.17 0.17 0.00 0.00 0.00
21 0 0.00 0.00 0.00 0.00 0.17 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.17 0.00
22 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
23 0 0.00 0.00 0.00 0.00 0.25 0.00 0.00 0.25 0.00 0.00 0.00 0.00 0.00 0.25 0.00
24 0 0.00 0.00 0.00 0.00 0.25 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
25 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
26 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
27 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
28 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.50 0.00 0.00 0.00 0.00 0.00 0.00 0.00
29 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.50 0.00 0.00 0.00 0.00
30 0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
     17   18   19   20   21   22   23   24   25   26   27   28   29 30
1  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
2  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
3  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
4  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
5  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
6  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
7  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
8  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
9  0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
10 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
11 0.00 0.00 0.07 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
12 0.07 0.07 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
13 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
14 0.07 0.00 0.00 0.00 0.07 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
15 0.00 0.00 0.00 0.20 0.00 0.10 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
16 0.12 0.00 0.00 0.12 0.00 0.00 0.12 0.12 0.00 0.00 0.00 0.00 0.00  0
17 0.14 0.43 0.14 0.00 0.14 0.00 0.14 0.00 0.00 0.00 0.00 0.00 0.00  0
18 0.17 0.00 0.17 0.17 0.17 0.17 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0
19 0.17 0.00 0.17 0.00 0.00 0.17 0.00 0.17 0.00 0.17 0.00 0.00 0.00  0
20 0.00 0.00 0.00 0.17 0.17 0.00 0.00 0.17 0.00 0.00 0.00 0.17 0.00  0
21 0.00 0.17 0.00 0.17 0.17 0.00 0.00 0.00 0.17 0.00 0.00 0.00 0.00  0
22 0.00 0.00 0.33 0.00 0.17 0.33 0.00 0.00 0.00 0.00 0.17 0.00 0.00  0
23 0.00 0.00 0.00 0.00 0.00 0.00 0.25 0.00 0.00 0.00 0.00 0.00 0.00  0
24 0.00 0.00 0.00 0.00 0.00 0.25 0.00 0.00 0.25 0.00 0.00 0.00 0.25  0
25 0.33 0.00 0.00 0.00 0.00 0.00 0.33 0.33 0.00 0.00 0.00 0.00 0.00  0
26 0.00 0.50 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.50 0.00 0.00  0
27 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.50 0.00 0.00 0.50 0.00  0
28 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.50 0.00 0.00 0.00  0
29 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.50  0
30 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>all_2024_wmx_start_finish_cat <span class="ot">&lt;-</span> all_2024 <span class="sc">|&gt;</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"WMX"</span> <span class="sc">&amp;</span> lap <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place, finish) <span class="sc">|&gt;</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">place_cat =</span> <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">"1-5"</span>,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">10</span>, <span class="st">"6-10"</span>,</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">15</span>, <span class="st">"11-15"</span>,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">20</span>, <span class="st">"16-20"</span>,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(place <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> place <span class="sc">&lt;=</span> <span class="dv">25</span>, </span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"21-25"</span>,<span class="st">"26-30"</span>))))),</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">finish_cat =</span> <span class="fu">ifelse</span>(finish <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> finish <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">"1-5"</span>,</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(finish <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> finish <span class="sc">&lt;=</span> <span class="dv">10</span>, <span class="st">"6-10"</span>,</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(finish <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> finish <span class="sc">&lt;=</span> <span class="dv">15</span>, <span class="st">"11-15"</span>,</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(finish <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> finish <span class="sc">&lt;=</span> <span class="dv">20</span>, <span class="st">"16-20"</span>,</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(finish <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> finish <span class="sc">&lt;=</span> <span class="dv">25</span>, <span class="st">"21-25"</span>, </span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"26-30"</span>)))))) <span class="sc">|&gt;</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(place_cat, finish_cat) <span class="sc">|&gt;</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place_cat, finish_cat) <span class="sc">|&gt;</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>all_2024_wmx_start_finish_cat_2 <span class="ot">&lt;-</span> all_2024_wmx_start_finish_cat <span class="sc">|&gt;</span></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(place_cat) <span class="sc">|&gt;</span></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>all_2024_wmx_start_finish_cat_3 <span class="ot">&lt;-</span> all_2024_wmx_start_finish_cat <span class="sc">|&gt;</span></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(all_2024_wmx_start_finish_cat_2) <span class="sc">|&gt;</span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n<span class="sc">/</span>total)</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>rows2 <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>cols2 <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>cats2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-5"</span>, <span class="st">"6-10"</span>, <span class="st">"11-15"</span>, <span class="st">"16-20"</span>, <span class="st">"21-25"</span>, <span class="st">"26-30"</span>)</span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>matrixwmx_4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> rows2, <span class="at">ncol =</span> cols2)</span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rows2) {</span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>cols2) {</span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>    matrix_row <span class="ot">&lt;-</span> all_2024_wmx_start_finish_cat_3 <span class="sc">|&gt;</span></span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(place_cat <span class="sc">==</span> cats2[i] <span class="sc">&amp;</span> finish_cat <span class="sc">==</span> cats2[j])</span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(matrix_row) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a>      matrix_value <span class="ot">&lt;-</span> all_2024_wmx_start_finish_cat_3 <span class="sc">|&gt;</span> </span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(place_cat <span class="sc">==</span> cats2[i] <span class="sc">&amp;</span> finish_cat <span class="sc">==</span> cats2[j]) <span class="sc">|&gt;</span> <span class="fu">pull</span>(prob)</span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a>    matrixwmx_4[i, j] <span class="ot">&lt;-</span> matrix_value</span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(matrixwmx_4) <span class="ot">&lt;-</span> cats2</span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(matrixwmx_4) <span class="ot">&lt;-</span> cats2</span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(matrixwmx_4, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1-5  6-10 11-15 16-20 21-25 26-30
1-5   0.886 0.057 0.057 0.000 0.000 0.000
6-10  0.100 0.700 0.171 0.029 0.000 0.000
11-15 0.015 0.167 0.652 0.136 0.030 0.000
16-20 0.000 0.030 0.121 0.485 0.303 0.061
21-25 0.000 0.174 0.087 0.217 0.435 0.087
26-30 0.000 0.111 0.111 0.111 0.111 0.556</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>sf_wmx <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(matrixwmx_3))</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sf_wmx, <span class="fu">aes</span>(Var1, Var2, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#da3a32"</span>) <span class="sc">+</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_text(aes(label = round(Freq,2))) +</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"WMX Heatmap"</span>, <span class="at">x =</span> <span class="st">"Start "</span>, <span class="at">y =</span> <span class="st">"Finish"</span>,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Probability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="rider-fatique" class="level2">
<h2 class="anchored" data-anchor-id="rider-fatique">4.3 Rider fatique</h2>
<p>Do riders get more tired as the moto goes on? Do lap times increase with lap number?</p>
<p>For the 450 class, we filter out the first lap since it is not a complete lap of the moto. We also filter out lap times over 200 seconds as these are outliers and might affect the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>all_2024 <span class="sc">|&gt;</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"450"</span> <span class="sc">&amp;</span> lap <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lap, <span class="at">y =</span> time, <span class="at">color =</span> race_id)) <span class="sc">+</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_smooth(method = "lm")</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Lap"</span>, <span class="at">y =</span> <span class="st">"Lap Time"</span>, <span class="at">color =</span> <span class="st">"Race ID"</span>,</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"450 - All Lap Times"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>all_2024 <span class="sc">|&gt;</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"450"</span> <span class="sc">&amp;</span> time <span class="sc">&lt;</span> <span class="dv">200</span> <span class="sc">&amp;</span> lap <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lap, <span class="at">y =</span> time)) <span class="sc">+</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>race_id) <span class="sc">+</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Lap"</span>, <span class="at">y =</span> <span class="st">"Lap Time"</span>,</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"450 - Lap Times by Moto"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-37-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Applying the linear model</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>all_2024 <span class="sc">|&gt;</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"450"</span> <span class="sc">&amp;</span> time <span class="sc">&lt;</span> <span class="dv">200</span> <span class="sc">&amp;</span> lap <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race_id) <span class="sc">|&gt;</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(<span class="at">model =</span> <span class="fu">lm</span>(time <span class="sc">~</span> lap, <span class="at">data =</span> .)) <span class="sc">|&gt;</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">slope =</span> <span class="fu">coef</span>(model)[<span class="st">"lap"</span>]) <span class="sc">|&gt;</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(race_id, slope) <span class="sc">|&gt;</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(slope, round, <span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">race_id =</span> <span class="st">"Race ID"</span>,</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">slope =</span> <span class="st">"Slope"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="uwnffbkcbu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#uwnffbkcbu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#uwnffbkcbu thead, #uwnffbkcbu tbody, #uwnffbkcbu tfoot, #uwnffbkcbu tr, #uwnffbkcbu td, #uwnffbkcbu th {
  border-style: none;
}

#uwnffbkcbu p {
  margin: 0;
  padding: 0;
}

#uwnffbkcbu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#uwnffbkcbu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#uwnffbkcbu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#uwnffbkcbu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#uwnffbkcbu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uwnffbkcbu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uwnffbkcbu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uwnffbkcbu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#uwnffbkcbu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#uwnffbkcbu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#uwnffbkcbu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#uwnffbkcbu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#uwnffbkcbu .gt_spanner_row {
  border-bottom-style: hidden;
}

#uwnffbkcbu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#uwnffbkcbu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#uwnffbkcbu .gt_from_md > :first-child {
  margin-top: 0;
}

#uwnffbkcbu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#uwnffbkcbu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#uwnffbkcbu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#uwnffbkcbu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#uwnffbkcbu .gt_row_group_first td {
  border-top-width: 2px;
}

#uwnffbkcbu .gt_row_group_first th {
  border-top-width: 2px;
}

#uwnffbkcbu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uwnffbkcbu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#uwnffbkcbu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#uwnffbkcbu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uwnffbkcbu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uwnffbkcbu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#uwnffbkcbu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#uwnffbkcbu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#uwnffbkcbu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uwnffbkcbu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uwnffbkcbu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uwnffbkcbu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uwnffbkcbu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uwnffbkcbu .gt_left {
  text-align: left;
}

#uwnffbkcbu .gt_center {
  text-align: center;
}

#uwnffbkcbu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#uwnffbkcbu .gt_font_normal {
  font-weight: normal;
}

#uwnffbkcbu .gt_font_bold {
  font-weight: bold;
}

#uwnffbkcbu .gt_font_italic {
  font-style: italic;
}

#uwnffbkcbu .gt_super {
  font-size: 65%;
}

#uwnffbkcbu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#uwnffbkcbu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#uwnffbkcbu .gt_indent_1 {
  text-indent: 5px;
}

#uwnffbkcbu .gt_indent_2 {
  text-indent: 10px;
}

#uwnffbkcbu .gt_indent_3 {
  text-indent: 15px;
}

#uwnffbkcbu .gt_indent_4 {
  text-indent: 20px;
}

#uwnffbkcbu .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Race ID">Race ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Slope">Slope</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="race_id" class="gt_row gt_left">450_2024_11</td>
<td headers="slope" class="gt_row gt_right">-0.03</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">450_2024_12</td>
<td headers="slope" class="gt_row gt_right">0.10</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">450_2024_21</td>
<td headers="slope" class="gt_row gt_right">0.17</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">450_2024_22</td>
<td headers="slope" class="gt_row gt_right">-0.75</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">450_2024_31</td>
<td headers="slope" class="gt_row gt_right">0.11</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">450_2024_32</td>
<td headers="slope" class="gt_row gt_right">0.31</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">450_2024_41</td>
<td headers="slope" class="gt_row gt_right">0.43</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">450_2024_42</td>
<td headers="slope" class="gt_row gt_right">0.46</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">450_2024_51</td>
<td headers="slope" class="gt_row gt_right">0.46</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">450_2024_52</td>
<td headers="slope" class="gt_row gt_right">0.39</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">450_2024_61</td>
<td headers="slope" class="gt_row gt_right">-0.06</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">450_2024_62</td>
<td headers="slope" class="gt_row gt_right">0.13</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">450_2024_71</td>
<td headers="slope" class="gt_row gt_right">0.44</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">450_2024_72</td>
<td headers="slope" class="gt_row gt_right">0.65</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">450_2024_81</td>
<td headers="slope" class="gt_row gt_right">0.14</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">450_2024_82</td>
<td headers="slope" class="gt_row gt_right">0.22</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>This shows that over the course of motos, lap times of riders are likely to increase in time. This is an indication of fatique as riders are slower.</p>
<p>The only motos where there was a decreasing trend in lap time was the first moto of the season (the freshest riders should be) and the fourth moto (race ended early after Dylan Wright’s fall).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Average lap time by lap, moto</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>all_2024 <span class="sc">|&gt;</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"450"</span> <span class="sc">&amp;</span> time <span class="sc">&lt;</span> <span class="dv">200</span> <span class="sc">&amp;</span> lap <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race_id, lap) <span class="sc">|&gt;</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_time =</span> <span class="fu">mean</span>(time)) <span class="sc">|&gt;</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lap, <span class="at">y =</span> avg_time, <span class="at">color =</span> race_id)) <span class="sc">+</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Lap"</span>, <span class="at">y =</span> <span class="st">"Average Lap Time"</span>, <span class="at">color =</span> <span class="st">"Race ID"</span>,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"450 - Average Lap Times"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This shows that average lap times are increasing up until the last couple of laps of the moto. I intuit that this is for a couple of reasons. First, we need to consider survivorship bias. Because lapping other riders exists, the last lap times are only going to include the top riders in that moto, making the average lap time much faster here. Second, at the end of a moto, riders are giving it everything they can as they know the race is ending soon.</p>
<p>For the 250 class, we keep the first lap filtered out and remove lap times over 250 seconds as these are outliers and might affect the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>all_2024 <span class="sc">|&gt;</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"250"</span> <span class="sc">&amp;</span> lap <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lap, <span class="at">y =</span> time, <span class="at">color =</span> race_id)) <span class="sc">+</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_smooth(method = "lm")</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Lap"</span>, <span class="at">y =</span> <span class="st">"Lap Time"</span>, <span class="at">color =</span> <span class="st">"Race ID"</span>,</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"250 - All Lap Times"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>all_2024 <span class="sc">|&gt;</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"250"</span> <span class="sc">&amp;</span> time <span class="sc">&lt;</span> <span class="dv">250</span> <span class="sc">&amp;</span> lap <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lap, <span class="at">y =</span> time)) <span class="sc">+</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>race_id) <span class="sc">+</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Lap"</span>, <span class="at">y =</span> <span class="st">"Lap Time"</span>,</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"250 - Lap Times by Moto"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-39-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Applying the linear model</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>all_2024 <span class="sc">|&gt;</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"250"</span> <span class="sc">&amp;</span> time <span class="sc">&lt;</span> <span class="dv">250</span> <span class="sc">&amp;</span> lap <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race_id) <span class="sc">|&gt;</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(<span class="at">model =</span> <span class="fu">lm</span>(time <span class="sc">~</span> lap, <span class="at">data =</span> .)) <span class="sc">|&gt;</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">slope =</span> <span class="fu">coef</span>(model)[<span class="st">"lap"</span>]) <span class="sc">|&gt;</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(race_id, slope) <span class="sc">|&gt;</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(slope, round, <span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">race_id =</span> <span class="st">"Race ID"</span>,</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">slope =</span> <span class="st">"Slope"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="yfozdjjahc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yfozdjjahc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yfozdjjahc thead, #yfozdjjahc tbody, #yfozdjjahc tfoot, #yfozdjjahc tr, #yfozdjjahc td, #yfozdjjahc th {
  border-style: none;
}

#yfozdjjahc p {
  margin: 0;
  padding: 0;
}

#yfozdjjahc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yfozdjjahc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yfozdjjahc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yfozdjjahc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yfozdjjahc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yfozdjjahc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yfozdjjahc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yfozdjjahc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yfozdjjahc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yfozdjjahc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yfozdjjahc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yfozdjjahc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yfozdjjahc .gt_spanner_row {
  border-bottom-style: hidden;
}

#yfozdjjahc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yfozdjjahc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yfozdjjahc .gt_from_md > :first-child {
  margin-top: 0;
}

#yfozdjjahc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yfozdjjahc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yfozdjjahc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yfozdjjahc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yfozdjjahc .gt_row_group_first td {
  border-top-width: 2px;
}

#yfozdjjahc .gt_row_group_first th {
  border-top-width: 2px;
}

#yfozdjjahc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yfozdjjahc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yfozdjjahc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yfozdjjahc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yfozdjjahc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yfozdjjahc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yfozdjjahc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yfozdjjahc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yfozdjjahc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yfozdjjahc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yfozdjjahc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yfozdjjahc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yfozdjjahc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yfozdjjahc .gt_left {
  text-align: left;
}

#yfozdjjahc .gt_center {
  text-align: center;
}

#yfozdjjahc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yfozdjjahc .gt_font_normal {
  font-weight: normal;
}

#yfozdjjahc .gt_font_bold {
  font-weight: bold;
}

#yfozdjjahc .gt_font_italic {
  font-style: italic;
}

#yfozdjjahc .gt_super {
  font-size: 65%;
}

#yfozdjjahc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yfozdjjahc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yfozdjjahc .gt_indent_1 {
  text-indent: 5px;
}

#yfozdjjahc .gt_indent_2 {
  text-indent: 10px;
}

#yfozdjjahc .gt_indent_3 {
  text-indent: 15px;
}

#yfozdjjahc .gt_indent_4 {
  text-indent: 20px;
}

#yfozdjjahc .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Race ID">Race ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Slope">Slope</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="race_id" class="gt_row gt_left">250_2024_11</td>
<td headers="slope" class="gt_row gt_right">-0.66</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">250_2024_12</td>
<td headers="slope" class="gt_row gt_right">-0.40</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">250_2024_21</td>
<td headers="slope" class="gt_row gt_right">0.28</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">250_2024_22</td>
<td headers="slope" class="gt_row gt_right">0.30</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">250_2024_31</td>
<td headers="slope" class="gt_row gt_right">-0.93</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">250_2024_32</td>
<td headers="slope" class="gt_row gt_right">-0.45</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">250_2024_41</td>
<td headers="slope" class="gt_row gt_right">0.34</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">250_2024_42</td>
<td headers="slope" class="gt_row gt_right">0.24</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">250_2024_51</td>
<td headers="slope" class="gt_row gt_right">0.24</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">250_2024_52</td>
<td headers="slope" class="gt_row gt_right">0.37</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">250_2024_61</td>
<td headers="slope" class="gt_row gt_right">0.11</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">250_2024_62</td>
<td headers="slope" class="gt_row gt_right">0.14</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">250_2024_71</td>
<td headers="slope" class="gt_row gt_right">0.13</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">250_2024_72</td>
<td headers="slope" class="gt_row gt_right">0.34</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">250_2024_81</td>
<td headers="slope" class="gt_row gt_right">0.30</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">250_2024_82</td>
<td headers="slope" class="gt_row gt_right">0.35</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>This shows that for most motos, lap times of riders are likely to increase in time. This is an indication of fatique as riders are getting slower.</p>
<p>The only motos where there was a decreasing trend in lap time was the first round of the season (the freshest riders should be) and the third round.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Average lap time by lap, moto</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>all_2024 <span class="sc">|&gt;</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"250"</span> <span class="sc">&amp;</span> time <span class="sc">&lt;</span> <span class="dv">250</span> <span class="sc">&amp;</span> lap <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race_id, lap) <span class="sc">|&gt;</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_time =</span> <span class="fu">mean</span>(time)) <span class="sc">|&gt;</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lap, <span class="at">y =</span> avg_time, <span class="at">color =</span> race_id)) <span class="sc">+</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Lap"</span>, <span class="at">y =</span> <span class="st">"Average Lap Time"</span>, <span class="at">color =</span> <span class="st">"Race ID"</span>,</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"250 - Average Lap Times"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This shows that average lap times are increasing up until the last couple of laps of the moto, as in the 450 class. Similar reasons as voiced for the 450 class apply.</p>
<p>For the WMX class, we keep the first lap filtered out and remove lap times over 250 seconds as these are outliers and might affect the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>all_2024 <span class="sc">|&gt;</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"WMX"</span> <span class="sc">&amp;</span> lap <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lap, <span class="at">y =</span> time, <span class="at">color =</span> race_id)) <span class="sc">+</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_smooth(method = "lm")</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Lap"</span>, <span class="at">y =</span> <span class="st">"Lap Time"</span>, <span class="at">color =</span> <span class="st">"Race ID"</span>,</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"WMX - All Lap Times"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>all_2024 <span class="sc">|&gt;</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"WMX"</span> <span class="sc">&amp;</span> time <span class="sc">&lt;</span> <span class="dv">250</span> <span class="sc">&amp;</span> lap <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lap, <span class="at">y =</span> time)) <span class="sc">+</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>race_id) <span class="sc">+</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Lap"</span>, <span class="at">y =</span> <span class="st">"Lap Time"</span>,</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"WMX - Lap Times by Moto"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-41-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Applying the linear model</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>all_2024 <span class="sc">|&gt;</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"WMX"</span> <span class="sc">&amp;</span> time <span class="sc">&lt;</span> <span class="dv">250</span> <span class="sc">&amp;</span> lap <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race_id) <span class="sc">|&gt;</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(<span class="at">model =</span> <span class="fu">lm</span>(time <span class="sc">~</span> lap, <span class="at">data =</span> .)) <span class="sc">|&gt;</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">slope =</span> <span class="fu">coef</span>(model)[<span class="st">"lap"</span>]) <span class="sc">|&gt;</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(race_id, slope) <span class="sc">|&gt;</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(slope, round, <span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">race_id =</span> <span class="st">"Race ID"</span>,</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">slope =</span> <span class="st">"Slope"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="hoskbyjlmn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hoskbyjlmn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hoskbyjlmn thead, #hoskbyjlmn tbody, #hoskbyjlmn tfoot, #hoskbyjlmn tr, #hoskbyjlmn td, #hoskbyjlmn th {
  border-style: none;
}

#hoskbyjlmn p {
  margin: 0;
  padding: 0;
}

#hoskbyjlmn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hoskbyjlmn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hoskbyjlmn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hoskbyjlmn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hoskbyjlmn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hoskbyjlmn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hoskbyjlmn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hoskbyjlmn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hoskbyjlmn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hoskbyjlmn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hoskbyjlmn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hoskbyjlmn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hoskbyjlmn .gt_spanner_row {
  border-bottom-style: hidden;
}

#hoskbyjlmn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hoskbyjlmn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hoskbyjlmn .gt_from_md > :first-child {
  margin-top: 0;
}

#hoskbyjlmn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hoskbyjlmn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hoskbyjlmn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hoskbyjlmn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hoskbyjlmn .gt_row_group_first td {
  border-top-width: 2px;
}

#hoskbyjlmn .gt_row_group_first th {
  border-top-width: 2px;
}

#hoskbyjlmn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hoskbyjlmn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hoskbyjlmn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hoskbyjlmn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hoskbyjlmn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hoskbyjlmn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hoskbyjlmn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hoskbyjlmn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hoskbyjlmn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hoskbyjlmn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hoskbyjlmn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hoskbyjlmn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hoskbyjlmn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hoskbyjlmn .gt_left {
  text-align: left;
}

#hoskbyjlmn .gt_center {
  text-align: center;
}

#hoskbyjlmn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hoskbyjlmn .gt_font_normal {
  font-weight: normal;
}

#hoskbyjlmn .gt_font_bold {
  font-weight: bold;
}

#hoskbyjlmn .gt_font_italic {
  font-style: italic;
}

#hoskbyjlmn .gt_super {
  font-size: 65%;
}

#hoskbyjlmn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hoskbyjlmn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hoskbyjlmn .gt_indent_1 {
  text-indent: 5px;
}

#hoskbyjlmn .gt_indent_2 {
  text-indent: 10px;
}

#hoskbyjlmn .gt_indent_3 {
  text-indent: 15px;
}

#hoskbyjlmn .gt_indent_4 {
  text-indent: 20px;
}

#hoskbyjlmn .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Race ID">Race ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Slope">Slope</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="race_id" class="gt_row gt_left">wmx_2024_11</td>
<td headers="slope" class="gt_row gt_right">-0.89</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">wmx_2024_12</td>
<td headers="slope" class="gt_row gt_right">-0.79</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">wmx_2024_21</td>
<td headers="slope" class="gt_row gt_right">-0.56</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">wmx_2024_22</td>
<td headers="slope" class="gt_row gt_right">1.33</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">wmx_2024_31</td>
<td headers="slope" class="gt_row gt_right">-0.14</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">wmx_2024_32</td>
<td headers="slope" class="gt_row gt_right">-0.86</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">wmx_2024_51</td>
<td headers="slope" class="gt_row gt_right">-1.81</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">wmx_2024_52</td>
<td headers="slope" class="gt_row gt_right">-1.05</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">wmx_2024_61</td>
<td headers="slope" class="gt_row gt_right">-1.35</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">wmx_2024_62</td>
<td headers="slope" class="gt_row gt_right">-1.21</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">wmx_2024_71</td>
<td headers="slope" class="gt_row gt_right">-1.51</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">wmx_2024_72</td>
<td headers="slope" class="gt_row gt_right">-0.98</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">wmx_2024_81</td>
<td headers="slope" class="gt_row gt_right">-0.87</td></tr>
    <tr><td headers="race_id" class="gt_row gt_left">wmx_2024_82</td>
<td headers="slope" class="gt_row gt_right">-1.19</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>This shows that for most motos, lap times of riders are likely to decrease in time. This is an indication that riders are not fatiguing as riders are getting faster.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Average lap time by lap, moto</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>all_2024 <span class="sc">|&gt;</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"WMX"</span> <span class="sc">&amp;</span> time <span class="sc">&lt;</span> <span class="dv">250</span> <span class="sc">&amp;</span> lap <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race_id, lap) <span class="sc">|&gt;</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_time =</span> <span class="fu">mean</span>(time)) <span class="sc">|&gt;</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lap, <span class="at">y =</span> avg_time, <span class="at">color =</span> race_id)) <span class="sc">+</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Lap"</span>, <span class="at">y =</span> <span class="st">"Average Lap Time"</span>, <span class="at">color =</span> <span class="st">"Race ID"</span>,</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"WMX - Average Lap Times"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="rider-rivalries" class="level2">
<h2 class="anchored" data-anchor-id="rider-rivalries">4.4 Rider rivalries</h2>
<p>Which two riders in each class battled the most throughout the season? In other words, add up the number of laps where the behind times between adjacent pairs of riders is less than 3 seconds. Which pair spend the most laps in this state?</p>
<p>450 class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>gaps_450_1 <span class="ot">&lt;-</span> all_2024 <span class="sc">|&gt;</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"450"</span>) <span class="sc">|&gt;</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(place) <span class="sc">|&gt;</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(lap, time, behind, place, race_id, name) <span class="sc">|&gt;</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race_id, name) <span class="sc">|&gt;</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_time =</span> <span class="fu">cumsum</span>(time)) <span class="sc">|&gt;</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">next_place =</span> place <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>gaps_450_2 <span class="ot">&lt;-</span> gaps_450_1 <span class="sc">|&gt;</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(gaps_450_1, <span class="at">by =</span> <span class="fu">join_by</span>(next_place <span class="sc">==</span> place, </span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>                                     race_id <span class="sc">==</span> race_id,</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>                                     lap <span class="sc">==</span> lap)) <span class="sc">|&gt;</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(lap, race_id, name.x, total_time.x, place, </span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>         name.y, total_time.y, next_place) <span class="sc">|&gt;</span></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> total_time.x <span class="sc">-</span> total_time.y) <span class="sc">|&gt;</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(name.y) <span class="sc">|&gt;</span></span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(diff <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">3</span>)</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>rival_pairs_450 <span class="ot">&lt;-</span> gaps_450_2 <span class="sc">|&gt;</span> </span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name.x, name.y) <span class="sc">|&gt;</span></span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pair =</span> <span class="fu">map2_chr</span>(name.x, name.y, </span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">~</span><span class="fu">paste</span>(<span class="fu">sort</span>(<span class="fu">c</span>(.x, .y)), <span class="at">collapse =</span> <span class="st">"-"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(pair, <span class="at">name =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(pair, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"rider1"</span>, <span class="st">"rider2"</span>), <span class="at">sep =</span> <span class="st">"-"</span>) <span class="sc">|&gt;</span></span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a>rival_pairs_450 <span class="sc">|&gt;</span></span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">rider1 =</span> <span class="st">"Rider A"</span>,</span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">rider2 =</span> <span class="st">"Rider B"</span>,</span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">count =</span> <span class="st">"# of Laps"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="ozhvhvofqu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ozhvhvofqu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ozhvhvofqu thead, #ozhvhvofqu tbody, #ozhvhvofqu tfoot, #ozhvhvofqu tr, #ozhvhvofqu td, #ozhvhvofqu th {
  border-style: none;
}

#ozhvhvofqu p {
  margin: 0;
  padding: 0;
}

#ozhvhvofqu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ozhvhvofqu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ozhvhvofqu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ozhvhvofqu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ozhvhvofqu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ozhvhvofqu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ozhvhvofqu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ozhvhvofqu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ozhvhvofqu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ozhvhvofqu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ozhvhvofqu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ozhvhvofqu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ozhvhvofqu .gt_spanner_row {
  border-bottom-style: hidden;
}

#ozhvhvofqu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ozhvhvofqu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ozhvhvofqu .gt_from_md > :first-child {
  margin-top: 0;
}

#ozhvhvofqu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ozhvhvofqu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ozhvhvofqu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ozhvhvofqu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ozhvhvofqu .gt_row_group_first td {
  border-top-width: 2px;
}

#ozhvhvofqu .gt_row_group_first th {
  border-top-width: 2px;
}

#ozhvhvofqu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ozhvhvofqu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ozhvhvofqu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ozhvhvofqu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ozhvhvofqu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ozhvhvofqu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ozhvhvofqu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ozhvhvofqu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ozhvhvofqu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ozhvhvofqu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ozhvhvofqu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ozhvhvofqu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ozhvhvofqu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ozhvhvofqu .gt_left {
  text-align: left;
}

#ozhvhvofqu .gt_center {
  text-align: center;
}

#ozhvhvofqu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ozhvhvofqu .gt_font_normal {
  font-weight: normal;
}

#ozhvhvofqu .gt_font_bold {
  font-weight: bold;
}

#ozhvhvofqu .gt_font_italic {
  font-style: italic;
}

#ozhvhvofqu .gt_super {
  font-size: 65%;
}

#ozhvhvofqu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ozhvhvofqu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ozhvhvofqu .gt_indent_1 {
  text-indent: 5px;
}

#ozhvhvofqu .gt_indent_2 {
  text-indent: 10px;
}

#ozhvhvofqu .gt_indent_3 {
  text-indent: 15px;
}

#ozhvhvofqu .gt_indent_4 {
  text-indent: 20px;
}

#ozhvhvofqu .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Rider A">Rider A</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Rider B">Rider B</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="# of Laps"># of Laps</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="rider1" class="gt_row gt_left">Mitchell Harrison</td>
<td headers="rider2" class="gt_row gt_left">Preston Kilroy</td>
<td headers="count" class="gt_row gt_right">41</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Aaron Tanti</td>
<td headers="rider2" class="gt_row gt_left">Preston Kilroy</td>
<td headers="count" class="gt_row gt_right">40</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Daniel Elmore</td>
<td headers="rider2" class="gt_row gt_left">Parker Eales</td>
<td headers="count" class="gt_row gt_right">40</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Jess Pettis</td>
<td headers="rider2" class="gt_row gt_left">Josiah Natzke</td>
<td headers="count" class="gt_row gt_right">34</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Julien Benek</td>
<td headers="rider2" class="gt_row gt_left">Tanner Ward</td>
<td headers="count" class="gt_row gt_right">28</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Jess Pettis</td>
<td headers="rider2" class="gt_row gt_left">Preston Kilroy</td>
<td headers="count" class="gt_row gt_right">26</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Aaron Tanti</td>
<td headers="rider2" class="gt_row gt_left">Josiah Natzke</td>
<td headers="count" class="gt_row gt_right">25</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Aaron Tanti</td>
<td headers="rider2" class="gt_row gt_left">Tanner Ward</td>
<td headers="count" class="gt_row gt_right">25</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Brendan Sipple</td>
<td headers="rider2" class="gt_row gt_left">Ryan Derry</td>
<td headers="count" class="gt_row gt_right">24</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Gavin Brough</td>
<td headers="rider2" class="gt_row gt_left">Parker Eales</td>
<td headers="count" class="gt_row gt_right">24</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>250 class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>gaps_250_1 <span class="ot">&lt;-</span> all_2024 <span class="sc">|&gt;</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"250"</span>) <span class="sc">|&gt;</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(place) <span class="sc">|&gt;</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(lap, time, behind, place, race_id, name) <span class="sc">|&gt;</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race_id, name) <span class="sc">|&gt;</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_time =</span> <span class="fu">cumsum</span>(time)) <span class="sc">|&gt;</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">next_place =</span> place <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>gaps_250_2 <span class="ot">&lt;-</span> gaps_250_1 <span class="sc">|&gt;</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(gaps_250_1, <span class="at">by =</span> <span class="fu">join_by</span>(next_place <span class="sc">==</span> place, </span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>                                     race_id <span class="sc">==</span> race_id,</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>                                     lap <span class="sc">==</span> lap)) <span class="sc">|&gt;</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(lap, race_id, name.x, total_time.x, place, </span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>         name.y, total_time.y, next_place) <span class="sc">|&gt;</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> total_time.x <span class="sc">-</span> total_time.y) <span class="sc">|&gt;</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(name.y) <span class="sc">|&gt;</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(diff <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">3</span>)</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>rival_pairs_250 <span class="ot">&lt;-</span> gaps_250_2 <span class="sc">|&gt;</span> </span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name.x, name.y) <span class="sc">|&gt;</span></span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pair =</span> <span class="fu">map2_chr</span>(name.x, name.y, </span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">~</span><span class="fu">paste</span>(<span class="fu">sort</span>(<span class="fu">c</span>(.x, .y)), <span class="at">collapse =</span> <span class="st">"-"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(pair, <span class="at">name =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(pair, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"rider1"</span>, <span class="st">"rider2"</span>), <span class="at">sep =</span> <span class="st">"-"</span>) <span class="sc">|&gt;</span></span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>rival_pairs_250 <span class="sc">|&gt;</span></span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">rider1 =</span> <span class="st">"Rider A"</span>,</span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">rider2 =</span> <span class="st">"Rider B"</span>,</span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">count =</span> <span class="st">"# of Laps"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="qnpcclinyv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qnpcclinyv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qnpcclinyv thead, #qnpcclinyv tbody, #qnpcclinyv tfoot, #qnpcclinyv tr, #qnpcclinyv td, #qnpcclinyv th {
  border-style: none;
}

#qnpcclinyv p {
  margin: 0;
  padding: 0;
}

#qnpcclinyv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qnpcclinyv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qnpcclinyv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qnpcclinyv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qnpcclinyv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qnpcclinyv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qnpcclinyv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qnpcclinyv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qnpcclinyv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qnpcclinyv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qnpcclinyv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qnpcclinyv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qnpcclinyv .gt_spanner_row {
  border-bottom-style: hidden;
}

#qnpcclinyv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qnpcclinyv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qnpcclinyv .gt_from_md > :first-child {
  margin-top: 0;
}

#qnpcclinyv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qnpcclinyv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qnpcclinyv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qnpcclinyv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qnpcclinyv .gt_row_group_first td {
  border-top-width: 2px;
}

#qnpcclinyv .gt_row_group_first th {
  border-top-width: 2px;
}

#qnpcclinyv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qnpcclinyv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qnpcclinyv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qnpcclinyv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qnpcclinyv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qnpcclinyv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qnpcclinyv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qnpcclinyv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qnpcclinyv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qnpcclinyv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qnpcclinyv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qnpcclinyv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qnpcclinyv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qnpcclinyv .gt_left {
  text-align: left;
}

#qnpcclinyv .gt_center {
  text-align: center;
}

#qnpcclinyv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qnpcclinyv .gt_font_normal {
  font-weight: normal;
}

#qnpcclinyv .gt_font_bold {
  font-weight: bold;
}

#qnpcclinyv .gt_font_italic {
  font-style: italic;
}

#qnpcclinyv .gt_super {
  font-size: 65%;
}

#qnpcclinyv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qnpcclinyv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qnpcclinyv .gt_indent_1 {
  text-indent: 5px;
}

#qnpcclinyv .gt_indent_2 {
  text-indent: 10px;
}

#qnpcclinyv .gt_indent_3 {
  text-indent: 15px;
}

#qnpcclinyv .gt_indent_4 {
  text-indent: 20px;
}

#qnpcclinyv .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Rider A">Rider A</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Rider B">Rider B</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="# of Laps"># of Laps</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="rider1" class="gt_row gt_left">Drew Adams</td>
<td headers="rider2" class="gt_row gt_left">Kaven Benoit</td>
<td headers="count" class="gt_row gt_right">31</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Gage Linville</td>
<td headers="rider2" class="gt_row gt_left">Quinn Amyotte</td>
<td headers="count" class="gt_row gt_right">31</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Kaven Benoit</td>
<td headers="rider2" class="gt_row gt_left">Krystian Janik</td>
<td headers="count" class="gt_row gt_right">26</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Gage Linville</td>
<td headers="rider2" class="gt_row gt_left">Kaven Benoit</td>
<td headers="count" class="gt_row gt_right">25</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Dylan Rempel</td>
<td headers="rider2" class="gt_row gt_left">Tiger Wood</td>
<td headers="count" class="gt_row gt_right">23</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Dylan Rempel</td>
<td headers="rider2" class="gt_row gt_left">Wyatt Kerr</td>
<td headers="count" class="gt_row gt_right">23</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Sebastien Racine</td>
<td headers="rider2" class="gt_row gt_left">Wyatt Kerr</td>
<td headers="count" class="gt_row gt_right">23</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Clayton Schmucki</td>
<td headers="rider2" class="gt_row gt_left">Hayden Jameson</td>
<td headers="count" class="gt_row gt_right">22</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Tiger Wood</td>
<td headers="rider2" class="gt_row gt_left">Wyatt Kerr</td>
<td headers="count" class="gt_row gt_right">22</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Dylan Rempel</td>
<td headers="rider2" class="gt_row gt_left">Tyler Medaglia</td>
<td headers="count" class="gt_row gt_right">20</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>WMX class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>gaps_wmx_1 <span class="ot">&lt;-</span> all_2024 <span class="sc">|&gt;</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"WMX"</span>) <span class="sc">|&gt;</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(place) <span class="sc">|&gt;</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(lap, time, behind, place, race_id, name) <span class="sc">|&gt;</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race_id, name) <span class="sc">|&gt;</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_time =</span> <span class="fu">cumsum</span>(time)) <span class="sc">|&gt;</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">next_place =</span> place <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>gaps_wmx_2 <span class="ot">&lt;-</span> gaps_wmx_1 <span class="sc">|&gt;</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(gaps_wmx_1, <span class="at">by =</span> <span class="fu">join_by</span>(next_place <span class="sc">==</span> place, </span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>                                     race_id <span class="sc">==</span> race_id,</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>                                     lap <span class="sc">==</span> lap)) <span class="sc">|&gt;</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(lap, race_id, name.x, total_time.x, place, </span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>         name.y, total_time.y, next_place) <span class="sc">|&gt;</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> total_time.x <span class="sc">-</span> total_time.y) <span class="sc">|&gt;</span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(name.y) <span class="sc">|&gt;</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(diff <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">3</span>)</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>rival_pairs_wmx <span class="ot">&lt;-</span> gaps_wmx_2 <span class="sc">|&gt;</span> </span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name.x, name.y) <span class="sc">|&gt;</span></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pair =</span> <span class="fu">map2_chr</span>(name.x, name.y, </span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">~</span><span class="fu">paste</span>(<span class="fu">sort</span>(<span class="fu">c</span>(.x, .y)), <span class="at">collapse =</span> <span class="st">"-"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(pair, <span class="at">name =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(pair, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"rider1"</span>, <span class="st">"rider2"</span>), <span class="at">sep =</span> <span class="st">"-"</span>) <span class="sc">|&gt;</span></span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>rival_pairs_wmx <span class="sc">|&gt;</span></span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">rider1 =</span> <span class="st">"Rider A"</span>,</span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">rider2 =</span> <span class="st">"Rider B"</span>,</span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">count =</span> <span class="st">"# of Laps"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="doqwfcuzlb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#doqwfcuzlb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#doqwfcuzlb thead, #doqwfcuzlb tbody, #doqwfcuzlb tfoot, #doqwfcuzlb tr, #doqwfcuzlb td, #doqwfcuzlb th {
  border-style: none;
}

#doqwfcuzlb p {
  margin: 0;
  padding: 0;
}

#doqwfcuzlb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#doqwfcuzlb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#doqwfcuzlb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#doqwfcuzlb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#doqwfcuzlb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#doqwfcuzlb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#doqwfcuzlb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#doqwfcuzlb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#doqwfcuzlb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#doqwfcuzlb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#doqwfcuzlb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#doqwfcuzlb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#doqwfcuzlb .gt_spanner_row {
  border-bottom-style: hidden;
}

#doqwfcuzlb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#doqwfcuzlb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#doqwfcuzlb .gt_from_md > :first-child {
  margin-top: 0;
}

#doqwfcuzlb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#doqwfcuzlb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#doqwfcuzlb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#doqwfcuzlb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#doqwfcuzlb .gt_row_group_first td {
  border-top-width: 2px;
}

#doqwfcuzlb .gt_row_group_first th {
  border-top-width: 2px;
}

#doqwfcuzlb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#doqwfcuzlb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#doqwfcuzlb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#doqwfcuzlb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#doqwfcuzlb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#doqwfcuzlb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#doqwfcuzlb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#doqwfcuzlb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#doqwfcuzlb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#doqwfcuzlb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#doqwfcuzlb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#doqwfcuzlb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#doqwfcuzlb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#doqwfcuzlb .gt_left {
  text-align: left;
}

#doqwfcuzlb .gt_center {
  text-align: center;
}

#doqwfcuzlb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#doqwfcuzlb .gt_font_normal {
  font-weight: normal;
}

#doqwfcuzlb .gt_font_bold {
  font-weight: bold;
}

#doqwfcuzlb .gt_font_italic {
  font-style: italic;
}

#doqwfcuzlb .gt_super {
  font-size: 65%;
}

#doqwfcuzlb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#doqwfcuzlb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#doqwfcuzlb .gt_indent_1 {
  text-indent: 5px;
}

#doqwfcuzlb .gt_indent_2 {
  text-indent: 10px;
}

#doqwfcuzlb .gt_indent_3 {
  text-indent: 15px;
}

#doqwfcuzlb .gt_indent_4 {
  text-indent: 20px;
}

#doqwfcuzlb .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Rider A">Rider A</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Rider B">Rider B</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="# of Laps"># of Laps</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="rider1" class="gt_row gt_left">Ani Ferguson</td>
<td headers="rider2" class="gt_row gt_left">Brook Greenlaw</td>
<td headers="count" class="gt_row gt_right">16</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Annalyse Lopushinsky</td>
<td headers="rider2" class="gt_row gt_left">Katrine Ferguson</td>
<td headers="count" class="gt_row gt_right">16</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Eve Brodeur</td>
<td headers="rider2" class="gt_row gt_left">Viviana Contreras</td>
<td headers="count" class="gt_row gt_right">15</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Hannah Cole</td>
<td headers="rider2" class="gt_row gt_left">Katrine Ferguson</td>
<td headers="count" class="gt_row gt_right">12</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Jamie Astudillo</td>
<td headers="rider2" class="gt_row gt_left">Viviana Contreras</td>
<td headers="count" class="gt_row gt_right">12</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Amelie Croteau</td>
<td headers="rider2" class="gt_row gt_left">Brittani Majcher</td>
<td headers="count" class="gt_row gt_right">11</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Amelie Croteau</td>
<td headers="rider2" class="gt_row gt_left">Hannah Cole</td>
<td headers="count" class="gt_row gt_right">10</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Eve Brodeur</td>
<td headers="rider2" class="gt_row gt_left">Jamie Astudillo</td>
<td headers="count" class="gt_row gt_right">10</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Eve Brodeur</td>
<td headers="rider2" class="gt_row gt_left">Kaylie Kayer</td>
<td headers="count" class="gt_row gt_right">10</td></tr>
    <tr><td headers="rider1" class="gt_row gt_left">Isabella Morgan</td>
<td headers="rider2" class="gt_row gt_left">Malia Garant</td>
<td headers="count" class="gt_row gt_right">9</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="points-race" class="level2">
<h2 class="anchored" data-anchor-id="points-race">4.5 Points race</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>standings_450 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">"Jess Pettis"</span>, <span class="st">"Josiah Natzke"</span>, </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Preston Kilroy"</span>,<span class="st">"Aaron Tanti"</span>, </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Tanner Ward"</span>, <span class="st">"Parker Eales"</span>,</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Dylan Wright"</span>, <span class="st">"Julien Benek"</span>, </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Daniel Elmore"</span>, <span class="st">"Mitchell Harrison"</span>),</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">total_points =</span> <span class="fu">c</span>(<span class="dv">355</span>, <span class="dv">344</span>, <span class="dv">300</span>, <span class="dv">252</span>, <span class="dv">234</span>, </span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">189</span>, <span class="dv">180</span>, <span class="dv">176</span>, <span class="dv">176</span>, <span class="dv">117</span>))</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>points_race_450 <span class="ot">&lt;-</span> all_2024 <span class="sc">|&gt;</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"450"</span>) <span class="sc">|&gt;</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(race_id, name, points) <span class="sc">|&gt;</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">%in%</span> standings_450<span class="sc">$</span>name)</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> standings_450<span class="sc">$</span>name) {</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> points_race_450<span class="sc">$</span>race_id) {</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>    check <span class="ot">&lt;-</span> points_race_450 <span class="sc">|&gt;</span> <span class="fu">filter</span>(race_id <span class="sc">==</span> j <span class="sc">&amp;</span> name <span class="sc">==</span> i)</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">nrow</span>(check) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>            points_race_450 <span class="ot">&lt;-</span> points_race_450 <span class="sc">|&gt;</span> <span class="fu">add_row</span>(<span class="at">race_id =</span> j,</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>                                                          <span class="at">name =</span> i,</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>                                                          <span class="at">points =</span> <span class="dv">0</span>)</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>points_race_450 <span class="sc">|&gt;</span></span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">season_moto =</span> <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"450_2024_11"</span>, <span class="dv">1</span>,</span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"450_2024_12"</span>, <span class="dv">2</span>,</span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"450_2024_21"</span>, <span class="dv">3</span>,</span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"450_2024_22"</span>, <span class="dv">4</span>,</span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"450_2024_31"</span>, <span class="dv">5</span>,</span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"450_2024_32"</span>, <span class="dv">6</span>,</span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"450_2024_41"</span>, <span class="dv">7</span>,</span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"450_2024_42"</span>, <span class="dv">8</span>,</span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"450_2024_51"</span>, <span class="dv">9</span>,</span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"450_2024_52"</span>, <span class="dv">10</span>,</span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"450_2024_61"</span>, <span class="dv">11</span>,</span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"450_2024_62"</span>, <span class="dv">12</span>,</span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"450_2024_71"</span>, <span class="dv">13</span>,</span>
<span id="cb80-39"><a href="#cb80-39" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"450_2024_72"</span>, <span class="dv">14</span>,</span>
<span id="cb80-40"><a href="#cb80-40" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"450_2024_81"</span>, </span>
<span id="cb80-41"><a href="#cb80-41" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">15</span>,<span class="dv">16</span>)))))))))))))))) <span class="sc">|&gt;</span></span>
<span id="cb80-42"><a href="#cb80-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(season_moto, name) <span class="sc">|&gt;</span></span>
<span id="cb80-43"><a href="#cb80-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb80-44"><a href="#cb80-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_points =</span> <span class="fu">cumsum</span>(points)) <span class="sc">|&gt;</span></span>
<span id="cb80-45"><a href="#cb80-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb80-46"><a href="#cb80-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season_moto, <span class="at">y =</span> total_points, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb80-47"><a href="#cb80-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb80-48"><a href="#cb80-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Moto #"</span>, <span class="at">y =</span> <span class="st">"Total Points"</span>, <span class="at">title =</span> <span class="st">"450 Points Race"</span>,</span>
<span id="cb80-49"><a href="#cb80-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Rider"</span>) <span class="co">#+</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#transition_reveal(season_moto)</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co">#animate(points_race_450, width = 600, height = 400, fps = 2,</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>        <span class="co">#renderer = gifski_renderer())</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>standings_250 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">"Kaven Benoit"</span>, <span class="st">"Drew Adams"</span>, </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Gage Linville"</span>, <span class="st">"Sebastien Racine"</span>,</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Wyatt Kerr"</span>, <span class="st">"Quinn Amyotte"</span>,</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Tyler Medaglia"</span>, <span class="st">"Tiger Wood"</span>, </span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Dylan Rempel"</span>, <span class="st">"Evan Stice"</span>),</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">total_points =</span> <span class="fu">c</span>(<span class="dv">351</span>, <span class="dv">349</span>, <span class="dv">254</span>, <span class="dv">225</span>, <span class="dv">223</span>, </span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">215</span>, <span class="dv">178</span>, <span class="dv">162</span>, <span class="dv">155</span>, <span class="dv">141</span>))</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>points_race_250 <span class="ot">&lt;-</span> all_2024 <span class="sc">|&gt;</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"250"</span>) <span class="sc">|&gt;</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(race_id, name, points) <span class="sc">|&gt;</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">%in%</span> standings_250<span class="sc">$</span>name)</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> standings_250<span class="sc">$</span>name) {</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> points_race_250<span class="sc">$</span>race_id) {</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>    check <span class="ot">&lt;-</span> points_race_250 <span class="sc">|&gt;</span> <span class="fu">filter</span>(race_id <span class="sc">==</span> j <span class="sc">&amp;</span> name <span class="sc">==</span> i)</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">nrow</span>(check) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>            points_race_250 <span class="ot">&lt;-</span> points_race_250 <span class="sc">|&gt;</span> <span class="fu">add_row</span>(<span class="at">race_id =</span> j,</span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>                                                          <span class="at">name =</span> i,</span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>                                                          <span class="at">points =</span> <span class="dv">0</span>)</span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a>points_race_250 <span class="sc">|&gt;</span></span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">season_moto =</span> <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"250_2024_11"</span>, <span class="dv">1</span>,</span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"250_2024_12"</span>, <span class="dv">2</span>,</span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"250_2024_21"</span>, <span class="dv">3</span>,</span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"250_2024_22"</span>, <span class="dv">4</span>,</span>
<span id="cb82-30"><a href="#cb82-30" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"250_2024_31"</span>, <span class="dv">5</span>,</span>
<span id="cb82-31"><a href="#cb82-31" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"250_2024_32"</span>, <span class="dv">6</span>,</span>
<span id="cb82-32"><a href="#cb82-32" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"250_2024_41"</span>, <span class="dv">7</span>,</span>
<span id="cb82-33"><a href="#cb82-33" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"250_2024_42"</span>, <span class="dv">8</span>,</span>
<span id="cb82-34"><a href="#cb82-34" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"250_2024_51"</span>, <span class="dv">9</span>,</span>
<span id="cb82-35"><a href="#cb82-35" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"250_2024_52"</span>, <span class="dv">10</span>,</span>
<span id="cb82-36"><a href="#cb82-36" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"250_2024_61"</span>, <span class="dv">11</span>,</span>
<span id="cb82-37"><a href="#cb82-37" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"250_2024_62"</span>, <span class="dv">12</span>,</span>
<span id="cb82-38"><a href="#cb82-38" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"250_2024_71"</span>, <span class="dv">13</span>,</span>
<span id="cb82-39"><a href="#cb82-39" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"250_2024_72"</span>, <span class="dv">14</span>,</span>
<span id="cb82-40"><a href="#cb82-40" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"250_2024_81"</span>, </span>
<span id="cb82-41"><a href="#cb82-41" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">15</span>,<span class="dv">16</span>)))))))))))))))) <span class="sc">|&gt;</span></span>
<span id="cb82-42"><a href="#cb82-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(season_moto, name) <span class="sc">|&gt;</span></span>
<span id="cb82-43"><a href="#cb82-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb82-44"><a href="#cb82-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_points =</span> <span class="fu">cumsum</span>(points)) <span class="sc">|&gt;</span></span>
<span id="cb82-45"><a href="#cb82-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb82-46"><a href="#cb82-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season_moto, <span class="at">y =</span> total_points, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb82-47"><a href="#cb82-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb82-48"><a href="#cb82-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Moto #"</span>, <span class="at">y =</span> <span class="st">"Total Points"</span>, <span class="at">title =</span> <span class="st">"250 Points Race"</span>,</span>
<span id="cb82-49"><a href="#cb82-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Rider"</span>) <span class="co">#+</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#transition_reveal(season_moto)</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co">#animate(points_race_250, width = 600, height = 400, fps = 2,</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>        <span class="co">#renderer = gifski_renderer())</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>standings_wmx <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">"Eve Brodeur"</span>, <span class="st">"Kaylie Kayer"</span>, </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Katrine Ferguson"</span>, <span class="st">"Jamie Astudillo"</span>, </span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Brook Greenlaw"</span>, <span class="st">"Viviana Contreras"</span>, </span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Amelie Croteau"</span>, <span class="st">"Brittani Majcher"</span>, </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Tea Ferguson"</span>, <span class="st">"Ani Ferguson"</span>),</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">total_points =</span> <span class="fu">c</span>(<span class="dv">325</span>, <span class="dv">287</span>, <span class="dv">267</span>, <span class="dv">227</span>, <span class="dv">179</span>, </span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">174</span>, <span class="dv">154</span>, <span class="dv">128</span>, <span class="dv">123</span>, <span class="dv">112</span>))</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>points_race_wmx <span class="ot">&lt;-</span> all_2024 <span class="sc">|&gt;</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"WMX"</span>) <span class="sc">|&gt;</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(race_id, name, points) <span class="sc">|&gt;</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">%in%</span> standings_wmx<span class="sc">$</span>name)</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> standings_wmx<span class="sc">$</span>name) {</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> points_race_wmx<span class="sc">$</span>race_id) {</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>    check <span class="ot">&lt;-</span> points_race_wmx <span class="sc">|&gt;</span> <span class="fu">filter</span>(race_id <span class="sc">==</span> j <span class="sc">&amp;</span> name <span class="sc">==</span> i)</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">nrow</span>(check) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>            points_race_wmx <span class="ot">&lt;-</span> points_race_wmx <span class="sc">|&gt;</span> <span class="fu">add_row</span>(<span class="at">race_id =</span> j,</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>                                                          <span class="at">name =</span> i,</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>                                                          <span class="at">points =</span> <span class="dv">0</span>)</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>points_race_wmx <span class="sc">|&gt;</span></span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">season_moto =</span> <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"wmx_2024_11"</span>, <span class="dv">1</span>,</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"wmx_2024_12"</span>, <span class="dv">2</span>,</span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"wmx_2024_21"</span>, <span class="dv">3</span>,</span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"wmx_2024_22"</span>, <span class="dv">4</span>,</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"wmx_2024_31"</span>, <span class="dv">5</span>,</span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"wmx_2024_32"</span>, <span class="dv">6</span>,</span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"wmx_2024_41"</span>, <span class="dv">7</span>,</span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"wmx_2024_42"</span>, <span class="dv">8</span>,</span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"wmx_2024_51"</span>, <span class="dv">9</span>,</span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"wmx_2024_52"</span>, <span class="dv">10</span>,</span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"wmx_2024_61"</span>, <span class="dv">11</span>,</span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"wmx_2024_62"</span>, <span class="dv">12</span>,</span>
<span id="cb84-38"><a href="#cb84-38" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"wmx_2024_71"</span>, <span class="dv">13</span>,</span>
<span id="cb84-39"><a href="#cb84-39" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"wmx_2024_72"</span>, <span class="dv">14</span>,</span>
<span id="cb84-40"><a href="#cb84-40" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(race_id <span class="sc">==</span> <span class="st">"wmx_2024_81"</span>, </span>
<span id="cb84-41"><a href="#cb84-41" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">15</span>,<span class="dv">16</span>)))))))))))))))) <span class="sc">|&gt;</span></span>
<span id="cb84-42"><a href="#cb84-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(season_moto, name) <span class="sc">|&gt;</span></span>
<span id="cb84-43"><a href="#cb84-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb84-44"><a href="#cb84-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_points =</span> <span class="fu">cumsum</span>(points)) <span class="sc">|&gt;</span></span>
<span id="cb84-45"><a href="#cb84-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb84-46"><a href="#cb84-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season_moto, <span class="at">y =</span> total_points, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb84-47"><a href="#cb84-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb84-48"><a href="#cb84-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Moto #"</span>, <span class="at">y =</span> <span class="st">"Total Points"</span>, <span class="at">title =</span> <span class="st">"WMX Points Race"</span>,</span>
<span id="cb84-49"><a href="#cb84-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Rider"</span>) <span class="co">#+</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#transition_reveal(season_moto)</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co">#animate(points_race_wmx, width = 600, height = 400, fps = 2,</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>        <span class="co">#renderer = gifski_renderer())</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rider-profiles" class="level2">
<h2 class="anchored" data-anchor-id="rider-profiles">4.6 Rider profiles</h2>
<p>Top 10 of the 450 class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>moto_id_450 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">race_id =</span> <span class="fu">c</span>(<span class="st">"450_2024_11"</span>, <span class="st">"450_2024_12"</span>,</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"450_2024_21"</span>, <span class="st">"450_2024_22"</span>,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"450_2024_31"</span>, <span class="st">"450_2024_32"</span>,</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"450_2024_41"</span>, <span class="st">"450_2024_42"</span>,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"450_2024_51"</span>, <span class="st">"450_2024_52"</span>,</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"450_2024_61"</span>, <span class="st">"450_2024_62"</span>,</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"450_2024_71"</span>, <span class="st">"450_2024_72"</span>,</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"450_2024_81"</span>, <span class="st">"450_2024_82"</span>),</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">moto_id =</span> <span class="fu">c</span>(<span class="st">"11"</span>,<span class="st">"12"</span>,<span class="st">"21"</span>,<span class="st">"22"</span>,<span class="st">"31"</span>,<span class="st">"32"</span>,<span class="st">"41"</span>,<span class="st">"42"</span>,</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"51"</span>,<span class="st">"52"</span>,<span class="st">"61"</span>,<span class="st">"62"</span>,<span class="st">"71"</span>,<span class="st">"72"</span>,<span class="st">"81"</span>,<span class="st">"82"</span>))</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>profile <span class="ot">&lt;-</span> <span class="cf">function</span>(rider_name, num, mx_class, joiner) {</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>  profile_1 <span class="ot">&lt;-</span> all_2024 <span class="sc">|&gt;</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> mx_class <span class="sc">&amp;</span> lap <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(race_id, name, place, finish) <span class="sc">|&gt;</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">==</span> rider_name) <span class="sc">|&gt;</span></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(joiner) <span class="sc">|&gt;</span></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">place =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(place), <span class="dv">0</span>, place),</span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">finish =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(finish), <span class="dv">0</span>, finish)) <span class="sc">|&gt;</span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(moto_id) <span class="sc">|&gt;</span></span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, moto_id, place, finish) <span class="sc">|&gt;</span></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"place"</span>, <span class="st">"finish"</span>), </span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>                          <span class="at">names_to =</span> <span class="st">"category"</span>, </span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>                          <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">|&gt;</span></span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">category =</span> <span class="fu">ifelse</span>(category <span class="sc">==</span> <span class="st">"place"</span>, <span class="st">"Start"</span>, <span class="st">"Finish"</span>)) </span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>profile_1<span class="sc">$</span>category <span class="ot">&lt;-</span> <span class="fu">factor</span>(profile_1<span class="sc">$</span>category, </span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Start"</span>, <span class="st">"Finish"</span>))</span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a>profile_1 <span class="sc">|&gt;</span></span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(moto_id), <span class="at">y =</span> value, <span class="at">fill =</span> category)) <span class="sc">+</span></span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> value, <span class="at">color =</span> category), </span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), </span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Moto ID"</span>, <span class="at">y =</span> <span class="st">"Position"</span>, <span class="at">fill =</span> <span class="st">" "</span>, </span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"#"</span>, num, <span class="st">" "</span>, rider_name)) <span class="sc">+</span></span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Start"</span> <span class="ot">=</span> <span class="st">"#32D2DA"</span>, </span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Finish"</span> <span class="ot">=</span> <span class="st">"#da3a32"</span>)) <span class="sc">+</span></span>
<span id="cb86-40"><a href="#cb86-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb86-41"><a href="#cb86-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-42"><a href="#cb86-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-43"><a href="#cb86-43" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(<span class="st">"Jess Pettis"</span>, <span class="st">"15"</span>, <span class="st">"450"</span>, moto_id_450)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(<span class="st">"Josiah Natzke"</span>, <span class="st">"23"</span>, <span class="st">"450"</span>, moto_id_450)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-49-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(<span class="st">"Preston Kilroy"</span>, <span class="st">"808"</span>, <span class="st">"450"</span>, moto_id_450)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-49-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(<span class="st">"Aaron Tanti"</span>, <span class="st">"109"</span>, <span class="st">"450"</span>, moto_id_450)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-49-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(<span class="st">"Tanner Ward"</span>, <span class="st">"84"</span>, <span class="st">"450"</span>, moto_id_450)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-49-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(<span class="st">"Parker Eales"</span>, <span class="st">"18"</span>, <span class="st">"450"</span>, moto_id_450)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-49-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(<span class="st">"Dylan Wright"</span>, <span class="st">"1"</span>, <span class="st">"450"</span>, moto_id_450)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-49-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(<span class="st">"Julien Benek"</span>, <span class="st">"17"</span>, <span class="st">"450"</span>, moto_id_450)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-49-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(<span class="st">"Daniel Elmore"</span>, <span class="st">"377"</span>, <span class="st">"450"</span>, moto_id_450)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-49-9.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(<span class="st">"Mitchell Harrison"</span>, <span class="st">"8"</span>, <span class="st">"450"</span>, moto_id_450)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-49-10.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Top 10 of the 250 class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>moto_id_250 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">race_id =</span> <span class="fu">c</span>(<span class="st">"250_2024_11"</span>, <span class="st">"250_2024_12"</span>,</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"250_2024_21"</span>, <span class="st">"250_2024_22"</span>,</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"250_2024_31"</span>, <span class="st">"250_2024_32"</span>,</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"250_2024_41"</span>, <span class="st">"250_2024_42"</span>,</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"250_2024_51"</span>, <span class="st">"250_2024_52"</span>,</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"250_2024_61"</span>, <span class="st">"250_2024_62"</span>,</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"250_2024_71"</span>, <span class="st">"250_2024_72"</span>,</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"250_2024_81"</span>, <span class="st">"250_2024_82"</span>),</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">moto_id =</span> <span class="fu">c</span>(<span class="st">"11"</span>,<span class="st">"12"</span>,<span class="st">"21"</span>,<span class="st">"22"</span>,<span class="st">"31"</span>,<span class="st">"32"</span>,<span class="st">"41"</span>,<span class="st">"42"</span>,</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"51"</span>,<span class="st">"52"</span>,<span class="st">"61"</span>,<span class="st">"62"</span>,<span class="st">"71"</span>,<span class="st">"72"</span>,<span class="st">"81"</span>,<span class="st">"82"</span>))</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(<span class="st">"Kaven Benoit"</span>, <span class="st">"26"</span>, <span class="st">"250"</span>, moto_id_250)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(<span class="st">"Drew Adams"</span>, <span class="st">"300"</span>, <span class="st">"250"</span>, moto_id_250)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-50-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(<span class="st">"Gage Linville"</span>, <span class="st">"402"</span>, <span class="st">"250"</span>, moto_id_250)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-50-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(<span class="st">"Sebastien Racine"</span>, <span class="st">"12"</span>, <span class="st">"250"</span>, moto_id_250)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-50-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(<span class="st">"Wyatt Kerr"</span>, <span class="st">"59"</span>, <span class="st">"250"</span>, moto_id_250)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-50-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(<span class="st">"Quinn Amyotte"</span>, <span class="st">"14"</span>, <span class="st">"250"</span>, moto_id_250)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-50-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(<span class="st">"Tyler Medaglia"</span>, <span class="st">"5"</span>, <span class="st">"250"</span>, moto_id_250)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-50-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(<span class="st">"Tiger Wood"</span>, <span class="st">"143"</span>, <span class="st">"250"</span>, moto_id_250)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-50-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(<span class="st">"Dylan Rempel"</span>, <span class="st">"19"</span>, <span class="st">"250"</span>, moto_id_250)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-50-9.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile</span>(<span class="st">"Evan Stice"</span>, <span class="st">"316"</span>, <span class="st">"250"</span>, moto_id_250)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-50-10.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Top 10 of the WMX class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>moto_id_wmx <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">race_id =</span> <span class="fu">c</span>(<span class="st">"wmx_2024_11"</span>, <span class="st">"wmx_2024_12"</span>,</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"wmx_2024_21"</span>, <span class="st">"wmx_2024_22"</span>,</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"wmx_2024_31"</span>, <span class="st">"wmx_2024_32"</span>,</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"wmx_2024_41"</span>, <span class="st">"wmx_2024_42"</span>,</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"wmx_2024_51"</span>, <span class="st">"wmx_2024_52"</span>,</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"wmx_2024_61"</span>, <span class="st">"wmx_2024_62"</span>,</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"wmx_2024_71"</span>, <span class="st">"wmx_2024_72"</span>,</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"wmx_2024_81"</span>, <span class="st">"wmx_2024_82"</span>),</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">moto_id =</span> <span class="fu">c</span>(<span class="st">"11"</span>,<span class="st">"12"</span>,<span class="st">"21"</span>,<span class="st">"22"</span>,<span class="st">"31"</span>,<span class="st">"32"</span>,<span class="st">"41"</span>,<span class="st">"42"</span>,</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"51"</span>,<span class="st">"52"</span>,<span class="st">"61"</span>,<span class="st">"62"</span>,<span class="st">"71"</span>,<span class="st">"72"</span>,<span class="st">"81"</span>,<span class="st">"82"</span>))</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>profile_wmx <span class="ot">&lt;-</span> <span class="cf">function</span>(rider_name, num) {</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>  profile_1 <span class="ot">&lt;-</span> all_2024 <span class="sc">|&gt;</span></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">lap =</span> <span class="fu">ifelse</span>(round <span class="sc">==</span> <span class="dv">4</span>, <span class="dv">1</span>, lap),</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">place =</span> <span class="fu">ifelse</span>(round <span class="sc">==</span> <span class="dv">4</span>, <span class="dv">0</span>, place)) <span class="sc">|&gt;</span></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"WMX"</span> <span class="sc">&amp;</span> lap <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(race_id, name, place, finish) <span class="sc">|&gt;</span></span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(name <span class="sc">==</span> rider_name) <span class="sc">|&gt;</span></span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(moto_id_wmx) <span class="sc">|&gt;</span></span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">place =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(place), <span class="dv">0</span>, place),</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">finish =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(finish), <span class="dv">0</span>, finish)) <span class="sc">|&gt;</span></span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(moto_id) <span class="sc">|&gt;</span></span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(name, moto_id, place, finish) <span class="sc">|&gt;</span></span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"place"</span>, <span class="st">"finish"</span>), </span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a>                          <span class="at">names_to =</span> <span class="st">"category"</span>, </span>
<span id="cb106-26"><a href="#cb106-26" aria-hidden="true" tabindex="-1"></a>                          <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">|&gt;</span></span>
<span id="cb106-27"><a href="#cb106-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">category =</span> <span class="fu">ifelse</span>(category <span class="sc">==</span> <span class="st">"place"</span>, <span class="st">"Start"</span>, <span class="st">"Finish"</span>)) </span>
<span id="cb106-28"><a href="#cb106-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-29"><a href="#cb106-29" aria-hidden="true" tabindex="-1"></a>  profile_1<span class="sc">$</span>category <span class="ot">&lt;-</span> <span class="fu">factor</span>(profile_1<span class="sc">$</span>category, </span>
<span id="cb106-30"><a href="#cb106-30" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Start"</span>, <span class="st">"Finish"</span>))</span>
<span id="cb106-31"><a href="#cb106-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-32"><a href="#cb106-32" aria-hidden="true" tabindex="-1"></a>  profile_1 <span class="sc">|&gt;</span></span>
<span id="cb106-33"><a href="#cb106-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(moto_id), <span class="at">y =</span> value, <span class="at">fill =</span> category)) <span class="sc">+</span></span>
<span id="cb106-34"><a href="#cb106-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb106-35"><a href="#cb106-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> value, <span class="at">color =</span> category), </span>
<span id="cb106-36"><a href="#cb106-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), </span>
<span id="cb106-37"><a href="#cb106-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb106-38"><a href="#cb106-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Moto ID"</span>, <span class="at">y =</span> <span class="st">"Position"</span>, <span class="at">fill =</span> <span class="st">" "</span>, </span>
<span id="cb106-39"><a href="#cb106-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"#"</span>, num, <span class="st">" "</span>, rider_name)) <span class="sc">+</span></span>
<span id="cb106-40"><a href="#cb106-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Start"</span> <span class="ot">=</span> <span class="st">"#32D2DA"</span>, </span>
<span id="cb106-41"><a href="#cb106-41" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Finish"</span> <span class="ot">=</span> <span class="st">"#da3a32"</span>)) <span class="sc">+</span></span>
<span id="cb106-42"><a href="#cb106-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb106-43"><a href="#cb106-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb106-44"><a href="#cb106-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-45"><a href="#cb106-45" aria-hidden="true" tabindex="-1"></a><span class="fu">profile_wmx</span>(<span class="st">"Eve Brodeur"</span>, <span class="st">"1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile_wmx</span>(<span class="st">"Kaylie Kayer"</span>, <span class="st">"3w"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-51-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile_wmx</span>(<span class="st">"Katrine Ferguson"</span>, <span class="st">"7W"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-51-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile_wmx</span>(<span class="st">"Jamie Astudillo"</span>, <span class="st">"469"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-51-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile_wmx</span>(<span class="st">"Brook Greenlaw"</span>, <span class="st">"6E"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-51-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile_wmx</span>(<span class="st">"Viviana Contreras"</span>, <span class="st">"50"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-51-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile_wmx</span>(<span class="st">"Amelie Croteau"</span>, <span class="st">"8"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-51-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile_wmx</span>(<span class="st">"Brittani Majcher"</span>, <span class="st">"14"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-51-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile_wmx</span>(<span class="st">"Tea Ferguson"</span>, <span class="st">"9W"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-51-9.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">profile_wmx</span>(<span class="st">"Ani Ferguson"</span>, <span class="st">"11"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mx_report_files/figure-html/unnamed-chunk-51-10.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="extensions" class="level1">
<h1>5 Extensions</h1>
<p>There are so many opportunities for further analysis. Here are some ideas I have to expand this project in the future:</p>
<ul>
<li>Add previous years data to the analysis. According to the <a href="https://triplecrownseries.ca/results/">results</a> tab of the Triple Crown Series website, there is data going back to 2018.</li>
</ul>
</section>
<section id="notes" class="level1">
<h1>6 Notes</h1>
<ul>
<li>There were some issues where two riders of the same class in the same year had the same number. In 2024, the following adjustments were made:
<ul>
<li><p>Luke Penney of the 450 class given 815 instead of 715 to avoid overlap with Trey Griffin.</p></li>
<li><p>Devin Salo of the 250 class given 287 instead of 87 to avoid overlap with Liam Dodds.</p></li>
<li><p>Alex Tremblay of the 250 class given 220 instead of 120 to avoid overlap with Jacob Frederickson.</p></li>
<li><p>Ashton Vermette of the 250 class given 153 instead of 53 to avoid overlap with Dylan Walsh.</p></li>
<li><p>Melanie Harvey of the WMX class given 9 for all motos instead of 98 to avoid overlap with Evelyne Falle.</p></li>
<li><p>Jamie Astudillo of the WMX class raced with 1e for the Walton motos. Changed to 469, the number she used previously, for convenience.</p></li>
<li><p>Alivia Werezak of the WMX class given 114 instad of 14 to avoid overlap with Brittani Majcher.</p></li>
</ul></li>
<li>In the WMX class, lap times and places for the Gopher Dunes - Round 4 motos were not available. Only finish positions were included.</li>
</ul>
</section>
<section id="acknowledgements" class="level1">
<h1>7 Acknowledgements</h1>
<p>Thank you to Dr.&nbsp;Jack Davis for suggesting the idea of transition matrices. He recommended me to his own analysis on the game, <a href="https://www.stats-et-al.com/2017/11/snakes-and-ladders-and-transition.html">Snakes and Ladders</a>.</p>
<p>Thank you <a href="statsf1.com">Stats F1</a> for rider profile ideas, such as the grid and finish position graph.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>